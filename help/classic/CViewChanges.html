<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta name="generator" content="HTML Tidy, see www.w3.org" />

    <title>Sage 300 SDK Changes to the Templates</title>
    <link rel="stylesheet" href="SDK.css" type="text/css" />
  </head>

  <body>
    <!-- style="font-size: 95%"-->

    <h1>Sage 300 SDK<br />
     Changes to the Templates<br />
    <br />
     Version&nbsp;6.3A<br />
    <br />
     August&nbsp;15,&nbsp;2014</h1>
    <!-- ================================================================ -->
    <hr />

    <p style="text-align: center; font-size: larger;">Copyright &copy;
    1994-2014 Sage Software, Inc. All rights reserved.</p>
    <hr />
    <!-- ================================================================ -->

    <ul>
      <li class="tight"><a href="#94-FEB-25">Since 94-FEB-25</a></li>

      <li class="tight"><a href="#94-MAR-25">Since 94-MAR-25</a></li>

      <li class="tight"><a href="#94-APR-15">Since 94-APR-15</a></li>

      <li class="tight"><a href="#94-MAY-09">Since 94-MAY-09</a></li>

      <li class="tight"><a href="#94-JUN-02">Since 94-JUN-02, released in SDK
      1.0A</a></li>

      <li class="tight"><a href="#94-AUG-12">Since 94-AUG-12</a></li>

      <li class="tight"><a href="#95-JAN-24">Since 95-JAN-24</a></li>

      <li class="tight"><a href="#96-JAN-26">Since 96-JAN-26, released in SDK
      2.0A</a></li>

      <li class="tight"><a href="#96-JUL-19">Since 96-JUL-19, released in SDK
      2.5A</a></li>

      <li class="tight"><a href="#97-MAY-30">Since 97-MAY-30, released in SDK
      3.0A</a></li>

      <li class="tight"><a href="#97-OCT-20">Since 97-OCT-20</a></li>

      <li class="tight"><a href="#98-MAR-11">Since 98-MAR-11, released in SDK
      4.0A</a></li>

      <li class="tight"><a href="#98-SEP-17">Since 98-SEP-17, released in SDK
      4.1A</a></li>

      <li class="tight"><a href="#00-APR-05">Since 00-APR-05, released in SDK
      4.2A</a></li>

      <li class="tight"><a href="#01-JUL-17">Since 01-JUL-17, released in SDK
      5.0A</a></li>

      <li class="tight"><a href="#01-DEC-18">Since 01-DEC-18, released in SDK
      5.1A</a></li>

      <li class="tight"><a href="#02-DEC-09">Since 02-DEC-09, released in SDK
      5.2A</a></li>

      <li class="tight"><a href="#03-AUG-28">Since 03-AUG-28, released in SDK
      5.3A</a></li>

      <li class="tight"><a href="#04-JUL-23">Since 04-JUL-23, released in SDK
      5.4A</a></li>

      <li class="tight"><a href="#06-JUN-08">Since 06-JUN-08, released in SDK
      5.5A</a></li>

      <li class="tight"><a href="#15-AUG-14">Since 15-AUG-14, released in SDK
      6.3A</a></li>
    </ul>
    <!-- ================================================================== -->

    <h2 class="overhead"><a id="A1" name="15-AUG-14">Since 15-AUG-14,
    released in SDK 6.3A</a></h2>

    <ol>
      <li>
        The CVIEW template has been modified to support companies whose org type is combined.
      </li>
    </ol>

    <!-- ================================================================== -->

    <h2 class="overhead"><a id="06-JUN-08" name="06-JUN-08">Since 06-JUN-08,
    released in SDK 5.5A</a></h2>

    <ol>
      <li>
        Bug fixes

        <ol type="A">
          <li>The FL_ERRNUM_IS_FAULTLESS() and FL_ERRNUM_IS_FAILURE() macros
          have been corrected to no longer reference DBS error codes. By
          fortunate coincidence this bug wasn&rsquo;t actually causing invalid
          results.</li>

          <li>
            Subclassing fixes:

            <ul>
              <li class="tight">Record verification, when implicitly triggered
              via <i>xxxx</i>Update() and <i>xxxx</i>Insert(), was being
              cascaded explicitly to the base view&rsquo;s viewVerify(). This
              has proven problematic when the base view overrides those
              entrypoints to finish setting record values that are subsequently
              validated. This explicit invocation is no longer performed by the
              subclass.</li>

              <li class="tight"><i>xxxx</i>FilterFetch() caused a GPF
              sometimes, due to ComparePrimary() accessing the primary key when
              in fact there is none published. This has been fixed.</li>

              <li class="tight">Fixed cases of join-style subclassing locking
              on the wrong key. They were using V.wActualKey, whereas 0 must
              always be used for the joined table. Functions affected were
              fileDelete(), fileOptLock(), filePrePost(), and
              fileUpdate().</li>

              <li class="tight">Fixed a bug in <i>xxxx</i>Put() where putting
              to the primary key was, in the case of the key value not
              changing, causing fetch loops to not terminate since the same
              record to be fetched.</li>
            </ul>
          </li>

          <li>When HDR_HAS_REVISIONS is &ge;2, duplicate tree entries were
          being created, causing intermediate-level revisions to become hidden,
          or even permanently lost. This was fixed by changing
          RevisionInnerFind() to check against to correct level, taking
          V.bAttachRequested into account. RevisionInnerSwitch() was also
          changed to maintain V.bAttachRequested and V.levelSwitched.</li>

          <li>More casts for C++ compatibility.</li>

          <li>Fixed a few more sample entrypoint override function bodies:
          <i>xxxx</i>CmpNames(), <i>xxxx</i>Create(), <i>xxxx</i>Drop().</li>

          <li>Corrected declaration of V.eRevision to be of type
          DB_ERRNUM.</li>

          <li>Fixed definition of InlineFindTableWidth() when STUB_VIEW is
          defined. It had been using FindTableInfo(), which is never valid with
          STUB_VIEW.</li>

          <li>Fixed fileUpdate() to use to proper key when locking a record of
          secondary table. This is similar to a fix described above for
          join-style subclassing.</li>

          <li>Fixed a bug in RevisionGenerate() when unwinding during error
          recovery. When there are multiple physical tables, the possibility
          existed that one of the handles wouldn&#39;t be closed.</li>
        </ol>
      </li>

      <li>
        Numerous optimizations have been made, aimed at both performance and
        resource consumption improvements.

        <ol type="A">
          <li>The rebrowse in RevisionRekey() has been removed, meaning the
          operation will only perform a single dbGetGE(), instead of once
          before every dbGetNext(). This is a major speed benefit both to
          Pervasive and to SQL, but for different reasons.</li>

          <li>
            <p>Expanded greatly the access to, and use of, suppression of
            duplicate key checks in revisioned views. A new view handle member
            (V.bCheckDuplicates) was added, as well as a new function
            RevisionCheckDuplicates() to properly abstract the API with respect
            to the template. When SYSACCESS_IMPORT is set, the suppression is
            enabled automatically.</p>

            <p>A new phantom field, called DUPKEYCHECK_IDX, has been added
            enabling the caller to explicitly set and get the suppression
            state. Its data type is DBSBOOL, and it defaults to TRUE. For
            example, from a superview you may want to set DUPKEYCHECK_IDX to
            FALSE in all the revisioned views you are accessing. Additionally,
            a .CheckDuplicateKeys property has been added to each of the COM
            and .NET layers having view-managing object (AccpacDataSource,
            AccpacCOMAPI, etc.) This allows you to explicitly suppress
            duplicate key checks within your UIs and macros.&nbsp;</p>
          </li>

          <li>The <i>xxxx</i>Update() and <i>xxxx</i>Delete() entrypoints were
          changed to <em>not</em> lock the record when it had been retrieved
          with <i>xxxx</i>Read(). This permits the template to apply passive
          concurrency, where the database engine is left to manage record
          locking implicitly, saving a round-trip to the server. Properly
          speaking, this is a bug fix, but appears in this item here because
          performance was affected.</li>

          <li>
            <p>The really big change is the &ldquo;sparsification&rdquo; of the
            revision forest. Specifically, delaying the building out the
            revision trees until a database operation is needed, instead of
            building out just in case it will ever be used. This dramatically
            improves the memory consumption profile with views managing D3s,
            and even just D2s. There is also a small speed improvement when
            dealing with dense D2s having very sparse D3s.</p>

            <p>Two members were added to the view handle to track state of the
            revision forest: V.levelSwitched, and V.bAttachRequested. Two
            template functions have been added to manage the build-out process:
            RevisionRealize() builds out a revision tree when needed, and
            RevisionWasRealized() enforces that the revision tree was indeed
            built out. Note that many of the template&rsquo;s Revision*()
            functions also maintain or use V.levelSwitched and
            V.bAttachRequested.</p>

            <p>The RevisionCreate(), RevisionInnerCreate(), and
            RevisionAttach() functions have been gutted, but are still present
            as shells to minimize changes to the rest of the code. The
            &rsquo;rev&rsquo; argument on RevisionInnerSwitch() was removed, as
            it was never used. RevisionSwitch() and RevisionFind() have been
            commented out, as they are no longer used, and it is extremely
            unlike that they ever got used outside the <i>zzzz</i>.c. A new
            template function RevisionAllocateAfter() was added to properly
            abstract access to revAllocateAfter().</p>

            <p>RevisionRekey() was changed to postpone grafting until the rekey
            has actually inserted/deleted records. This required changing the
            semantics, and arguments, of RevisionInnerGraft() to use a new
            REVGRAFTPOINT structure indicating where to graft in the branch
            that gets built. A new function RevisionRecursiveFind() returns a
            REVGRAFTPOINT structure.</p>
          </li>

          <li>Implemented view instance pooling, aimed primarily at improving
          resource consumption and latency for foreign key validation. A new
          bitfield has been added to CMPNAMESTRUCT.option:
          CMPNAME_OPTION_VIEWPOOL. You must set CMPNAME_OPTION_VIEWPOOL for any
          demand or implicit composites in the cmpNameList[] for which this
          pooling is desired. There are two new template functions:
          AcquireOneView() and ReleaseOne(), which make use of the new rotoview
          support functions: viewAcquire(), viewSpecify(), and
          viewRelease().</li>
        </ol>
      </li>

      <li>
        <p>The templates have been modified to facilitate compilation under
        Linux environments. Additionally, there are changes you will need to
        make to extant modifiable files to compile under Linux. There are
        several issues at play:</p>

        <ul>
          <li class="tight">Linux&rsquo;s file systems are case-sensitive,
          whereas Windows&rsquo; are not.</li>

          <li class="tight">C identifiers are case-sensitive.</li>

          <li class="tight">The templates use some patterns both for C
          identifiers and for file names.</li>
        </ul>

        <p>New patterns have been introduced to disambiguate these different
        issues and their permutations. Note that in each case the original
        pattern still exists, but its use has been narrowed to just files.
        Recommended practice is that you convert the replacement strings to all
        lower case. Similarly, there is a new complementary pattern for use in
        symbols and identifiers, and recommended practice is that the
        replacement strings be all upper case.</p>

        <table border="0" cellpadding="2" cellspacing="0">
          <thead>
            <tr class="grey" align="left" valign="bottom">
              <td class="head">File&nbsp;<br />
               Pattern&nbsp;</td>

              <td class="head">Symbol&nbsp;<br />
               Pattern&nbsp;</td>

              <td class="head">Applies To</td>
            </tr>
          </thead>

          <tbody>
            <tr>
              <td><i>aaaa</i>&nbsp;</td>

              <td><i>AAAA</i>&nbsp;</td>

              <td>CVIEW, CPPVIEW, ODSETUP, OFCMD, OHSETUP, OPOST, CLANG, and
              CPROJECT</td>
            </tr>

            <tr class="grey">
              <td><i>zzzz</i>&nbsp;</td>

              <td><i>ZZZZ</i>&nbsp;</td>

              <td>CVIEW, CPPVIEW, ODSETUP, OFCMD, OHSETUP, and OPOST</td>
            </tr>

            <tr>
              <td><i>yyyy</i>&nbsp;</td>

              <td><i>YYYY</i>&nbsp;</td>

              <td>CLANG</td>
            </tr>
          </tbody>
        </table>

        <p>For each view <i>zzzz</i> make the following changes:</p>

        <ul>
          <li class="tight">In your source control, change the file name to
          lower case. Note that the *.TBL files must remain as upper case.</li>

          <li class="tight">Checkout and edit your <i>zzzz</i>.ptn pattern
          response file, add the new symbol pattern(s), and change the file
          pattern replacement(s) to lower case.</li>

          <li class="tight">Checkout the non-modifiable files, and
          reinstantiate them using MKINST.</li>

          <li class="tight">Checkout and edit any modifiable files containing
          #include preprocessor directives, converting the file name to lower
          case. Note that the file names for DBS tables must remain as upper
          case.</li>

          <li class="tight">Fill in <i>zzzz</i>.gnumake and
          <i>zzzz</i>.i.gnumake based on your existing <i>zzzz</i>.mak file,
          and also add the dependency to makefile.gnumake.</li>
        </ul>
      </li>

      <li>
        <p>Added several new view entrypoints. This includes the actual
        implementation body, overrides, and rotoview support. However, they
        still lack support in View Tester, macro recording, COM and .net
        components.</p>

        <ol type="A">
          <li><i>xxxx</i>FieldName() is similar to <i>xxxx</i>Name(), except
          that the caller specifies the buffer size of the description
          parameter, thus removing the 32-character limit on the field
          description. Has full subclassing support.</li>

          <li><i>xxxx</i>FieldExists() indicates whether the field index passed
          is valid. This status is returned via an out flags parameter to the
          entrypoint. Has full subclassing support</li>

          <li>
            <p><i>xxxx</i>InstanceFieldList() lets the caller select which
            fields will actually be retrieved (or updated) by the database API.
            Using this can improve performance, since less data will travel
            between the client and the server. This is especially the case if
            the view manages multiple tables, and no fields are to be selected
            from any of the secondary tables. Note that the template will
            always select implicitly the primary key of the primary table,
            regardless of the list of fields you specify.</p>

            <p>Fields that have not been selected are marked with a new
            attribute, ATTR_NULL, meaning data missing. Attempts to access NULL
            fields via viewGet(), viewPresents(), or viewPut() will return an
            error. As well, the template will usually skip over such fields
            inside the view itself. Calling <i>xxxx</i>InstanceFieldList()
            invalidates the record state. That is, you can&rsquo;t rely on the
            values of any of the fields, nor update the record, until it has
            been read of fetched again.</p>

            <p>The parameters are basically a set of flags, and a list of field
            indexes. The flags indicate what to do, and is the inclusive-or of
            an operation code, and an access mode.</p>

            <table border="0" cellpadding="2" cellspacing="0">
              <thead>
                <tr class="grey" align="left" valign="bottom">
                  <td class="head">Operation Code</td>

                  <td class="head">Description</td>
                </tr>
              </thead>

              <tbody>
                <tr>
                  <td>INSTANCE_FIELDLIST_SELECT&nbsp;</td>

                  <td>Selects the fields per the list. This clears any prior
                  selection.</td>
                </tr>

                <tr class="grey">
                  <td>INSTANCE_FIELDLIST_SELECT_ALL&nbsp;</td>

                  <td>Clears the current selection. Reads and fetches will now
                  retrieve all fields.</td>
                </tr>

                <tr>
                  <td>INSTANCE_FIELDLIST_SELECT_INCREASE&nbsp;</td>

                  <td>Expands the currently selected set of fields with the
                  list passed in. Useful when validating an explicit
                  composition.</td>
                </tr>
              </tbody>
            </table>

            <p>The access mode has the following values, applicable only with
            the INSTANCE_FIELDLIST_SELECT operation:</p>

            <table border="0" cellpadding="2" cellspacing="0">
              <thead>
                <tr class="grey" align="left" valign="bottom">
                  <td class="head">Access Mode&nbsp;</td>

                  <td class="head">Description</td>
                </tr>
              </thead>

              <tbody>
                <tr>
                  <td>INSTANCE_FIELDLIST_READWRITE&nbsp;</td>

                  <td>Retrieved records are updateable.</td>
                </tr>

                <tr class="grey">
                  <td>INSTANCE_FIELDLIST_READONLY&nbsp;</td>

                  <td>Records retrieved cannot be updated.</td>
                </tr>
              </tbody>
            </table>

            <p>There are a variety of stability and implementation issues that
            arise when you want a view to support this entrypoint. Simply
            reinstantiating is not usually sufficient. In aid of that, there is
            a new conditional feature, DO_INSTANCE_FIELDLIST, that you must
            define to enable this functionality.</p>

            <p>Performance and maintenance became issues due to AttribGet()
            being called more often when checking for ATTR_NULL, particularly
            when initializing a record. Consequently, those places needing to
            check only ATTR_NULL have been changed to reference
            V.alAttributes[] directly.</p>

            <p>There are 2 new data structures defined: VIEWSELECTION records
            the field indexes selected and other operational info, and
            TABLESELECTION records the names of the fields selected, per
            physical table. VIEWSELECTION contains an array of TABLESELECTION
            data. A new member V.pViewSelection points to a VIEWSELECTION, but
            is only allocated and maintained as needed. A helper function
            FindTableSelection() returns a reference to a TABLESELECTION, and
            may be overridden the usual way.</p>

            <p>There are several new template functions implementing and
            managing all this: SelectionCancel(), SelectionIncrease(),
            SelectionInsertName(), SelectionValid(), BinarySearch(),
            ClearAttribs(), and SetAttribs(). There is also a new database API
            interfacing function: fileSelectFields(). It may be overridden, and
            must be overridden when STUB_VIEW is defined.</p>
          </li>
        </ol>
      </li>

      <li>
        New Callouts, Overrides and Conditional Features

        <ol type="A">
          <li>The handling of views that redefine TABLEHANDLE, which is
          commonly done in stub views, has been updated. There is a new helper
          macro MapStubToTableHandle(), which by default returns its handle
          parameter unchanged. But if you have a stub view and redefine
          TABLEHANDLE, you will now need to define DoMapStubToTableHandle() to
          return a suitable alternate value of type WORD. If there is no
          sensible value (that is, there is no database table handle underlying
          the stub), then return -1. If your TABLEHANDLE structure does
          actually contain a database table handle, you should return
          that.</li>

          <li>Changed the template&rsquo;s fileTrans*() family of
          transactioning calls to use the new lnk*Trans() family of routines in
          SM 5.5, in order to track, match, and enforce transactions much more
          safely. Two new view handle members have been added:
          V.transIDstack[DO_TRANSACTIONSTACK] where DO_TRANSACTIONSTACK
          defaults to 10, and V.transIDs denotes the current top of
          V.transIDstack[]. A4W_API_VERSION now defaults to 0x55A and
          constitutes a new &ldquo;low water mark&rdquo; for this release of
          the template. Consequently, definitions made dead or otherwise
          irrelevant by the requirement of 5.5 have been removed.</li>
        </ol>
      </li>

      <li>
        Miscellaneous Changes

        <ol type="A">
          <li>Added rvspyNotify(), wrapped by RVSPYNOTIFY() macro, which
          commonizes notification spying code, plus names reasons instead of
          just their numbers.</li>

          <li>
            <p>Removed many #if preprocessor directives whose expressions
            involved symbols that are <em>always</em> defined. These #if
            directives were rewritten as if/else statements or switch
            statements. This benefits maintenance, since such sections will now
            be always statically seen by the compiler. The optimizer takes care
            of removing dead code in such sections. This required the addition
            of a #defined placeholder for hierarchyKepMap[] in those cases
            where there are no foreign keys.</p>

            <p>Additionally, a new symbol SUBCLASS_LEVEL is defined
            synonymously to SUBCLASS_VIEW, unless the latter isn&#39;t defined,
            in which case SUBCLASS_LEVEL is defined to be NOT_SUBCLASS. As
            well, functions, data and members specific to subclassing are now
            always defined, though not necessarily used, simply to satisfy the
            compiler.</p>
          </li>

          <li>Made minor adjustments to boolean expressions to use comparison
          operators, instead of letting the compiler implicitly insert a
          comparison with 0. This facilitates application of lint.</li>

          <li>Removed all processing related to SEC_POST. It appears that most
          cases where it would have been used (namely revisioned views) are in
          fact covered by add/modify/delete security checks. The other area
          SEC_POST was checked, <i>xxxx</i>Process(), is rather ambiguous as
          some views use it for many different purpose with potentially
          conflicting security requirements. These will need to be addressed
          case-by-case.</li>

          <li>Added OpenOneViewInstance() helper function. This allows you to
          pass extra parameters in an unstructured block. Note that you must
          understand what the called view is able to accept. You may also pass
          additional INSTANCE_OPEN_* flags.</li>

          <li>Put back in DO_OLDINITBODYCASCADE, and the default bahaviour of
          cascading cancellation to detail composites.</li>

          <li>
            <p>The error mapping functions have been moved to rotoview, and
            renamed as listed in the table below. The template defines wrapper
            macros with the old name, so as to ease transition to using
            them.</p>

            <table border="0" cellpadding="2" cellspacing="0">
              <thead>
                <tr class="grey" align="left" valign="bottom">
                  <td class="head">Old Function&nbsp;</td>

                  <td class="head">New Function</td>
                </tr>
              </thead>

              <tbody>
                <tr>
                  <td>ErrorMapDatabaseToExtended&nbsp;</td>

                  <td>rvMapDatabaseErrorToExtended</td>
                </tr>

                <tr class="grey">
                  <td>ErrorMapExtendedToOld&nbsp;</td>

                  <td>rvMapExtendedErrorToOld</td>
                </tr>

                <tr>
                  <td>ErrorMapFilterToDatabase&nbsp;</td>

                  <td>rvMapFilterErrorToDatabase</td>
                </tr>

                <tr class="grey">
                  <td>ErrorMapFilterToExtended&nbsp;</td>

                  <td>rvMapFilterErrorToExtended</td>
                </tr>

                <tr>
                  <td>ErrorMapViewToDatabase&nbsp;</td>

                  <td>rvMapViewErrorToDatabase</td>
                </tr>

                <tr class="grey">
                  <td>ErrorMapViewToExtended&nbsp;</td>

                  <td>rvMapViewErrorToExtended</td>
                </tr>

                <tr>
                  <td>ErrorMapViewToFilter&nbsp;</td>

                  <td>rvMapViewErrorToFilter</td>
                </tr>
              </tbody>
            </table>
          </li>

          <li>Moved &ldquo;#ifndef __zzzz_h&rdquo; directives to the outside of
          &ldquo;#ifdef __cplusplus&rdquo; directives. This will permit some
          compilers (especially GCC) to more quickly process multiple
          inclusions of the same file.</li>

          <li>
            <p>A variety of contructs that were previously deprecated have been
            removed:</p>

            <ul>
              <li class="tight">The PATCH_WORD and PATCH_CHAR type definitions
              have been removed. They were intended to assist the transition to
              32-bit, which has long since been accomplished.</li>

              <li class="tight">Removed hDllModule, xxxxViewModule(),
              identifyViewModule() (in a4wrv.dll), and all related support. It
              was never used, and was ill-advised.</li>

              <li class="tight">The DO_OLDPOST conditional feature has been
              removed. <i>xxxx</i>Post() may no longer be treated as a synonymn
              for <i>xxxx</i>Insert() or <i>xxxx</i>Update().</li>

              <li class="tight">The DO_SCRATCHHEAP conditional feature has been
              removed. You must now use memAlloc() instead of ScratchAlloc(),
              and memFree() instead of ScratchFree().</li>
            </ul>
          </li>

          <li>
            <p>Reordered and unified #include directives across all C templates
            (except DATAPIPE). This permits precompiled headers to be used if
            desired. However, doing so will require that you reinstantiate your
            views, plus you must edit your views&rsquo; <i>zzzz</i>1.c files to
            have the following stock sequence:</p>
<pre>
#include &lt;plusapi.h&gt;

#include &lt;stdarg.h&gt;
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;malloc.h&gt;

#include &lt;rotoview.h&gt;
#include &lt;roto.h&gt;

#if defined(__cplusplus)
namespace A4WAPI {
#endif

#include &quot;<i>aaaa</i>.h&quot;
#include &quot;<i>aaaa</i>.i&quot;
</pre>
          </li>
        </ol>
      </li>
    </ol>
    <!-- ================================================================== -->

    <h2 class="overhead"><a id="04-JUL-23" name="04-JUL-23">Since 04-JUL-23,
    released in SDK 5.4A</a></h2>

    <ol>
      <li>
        Bug fixes

        <ol type="A">
          <li>Corrected the prototype of FindCmpNotify() and
          MaxDatabaseError(). Added MaxDatabaseError() function definition in
          <i>zzzz</i>.C. These were only problems if DO_HELPERSOUTOFLINE was
          defined, since by default they are defined as macros instead of
          functions.</li>

          <li>Fixed a problem with a for loop in ValidateKeys() not fully
          bracketing its code block. This led to multi-segment keys not always
          being validated when they should have been.</li>

          <li>Detect attempt to apply a NULL mask, and treat it as though no
          mask. This keeps the view from crashing. It should probably throw up
          an error message so translators (and programmers) will be
          notified.</li>

          <li>Fixed bug in NormalizeFieldBuffer() where a masked string caused
          a buffer overwrite by 1 byte. Under some circumstances it could crash
          the view. Note also that ApplyMask() was added, commonizing code for
          formatting and validating masked fields.</li>

          <li>Added deletion permission check to <i>xxxx</i>TableEmpty().</li>

          <li>Fixed a LoadRsc() bug, which under certain conditions could
          overrun a buffer by 1 byte. However, the conditions that cause the
          problem to manifest could not coincide until version 5.3A of the
          template.</li>

          <li>Fixed the ConcurrencyEtc() record conflict resolution in
          fileUpdate() to call dbGetLock(), instead of dbGet(). This was
          problematic only when DO_PASSIVECONCURRENCY was defined, and resulted
          in the attempted record merging being spuriously rejected. In other
          words, the bug did not compromise the integrity of the data, it
          simply frustrated users.</li>

          <li>
            Fixes made in <i>zzzz</i>1.C. Since this is a modifiable file,
            these changes won&rsquo;t impact existing views.

            <ul>
              <li class="tight">Fixed sample calls in ApplyHeaderFields(),
              ReverseHeaderFields(), SaveHeaderFields(), and
              EntryStatePush().</li>

              <li class="tight">Fixed preprocessor conditionals around
              EntryStatePush() and EntryStatePop()</li>

              <li class="tight">Fixed function header declarations of
              SaveHeaderFields() and GetPermissions().</li>
            </ul>
          </li>

          <li>
            Subclass fixes:

            <ul>
              <li class="tight">Removed many of the NotifyFire() invocations,
              because the base view also fires those notifications and was
              causing double-firing of many of the notifications. For clients
              registering notification callbacks this caused problems. This was
              addressed by creating a new macro, BaseNotifyFire(), which
              expands to an empty statement under subclassing, and to
              NotifyFire() otherwise. Additionally, the BaseNotify() callback
              no longer propagates INSTANCE_NOTIFY_INSTANCE_CLOSING. Note that
              the subclass template still fires its own notifications for field
              value and attribute changes, as well as closing the view.</li>

              <li class="tight">Fixed refreshing of current key upon caller
              putting it so that BaseBrowse() is also invoked. Its absence was
              causing problems with fetching records with a filter under some
              circumstances with join-style subclassing.</li>

              <li class="tight">Removed an extraneous BaseGetData();
              don&rsquo;t think it was harmful.</li>

              <li class="tight">Added use of GhostRoto to most of the
              identify... entrypoints. Since this requires SM 5.3A SP2, you
              should insert the appropriate entry into the [Compatibility]
              section of your add-in&rsquo;s ??.INI file.</li>

              <li class="tight">Fixed subclass semantics regarding base
              views&rsquo; table counts in <i>xxxx</i>TableHandles() and
              <i>xxxx</i>ViewTables().</li>

              <li class="tight">Fixed the handling of SYSACCESS_IDX and
              REFINT_IDX in <i>xxxx</i>Get(). It now always chains this call to
              the base view, instead of returning its cached copy of those
              control fields. This addresses cases where a base view might
              change its system access <i>itself</i>, as opposed to some
              external calling doing it.</li>

              <li class="tight">Added casts in the identify... entrypoints so
              that a subclass view can be compiled with C++.</li>
            </ul>
          </li>

          <li>Placement of header file inclusions were adjusted to permit
          compilation of sources by C++. An inclusion of &lt;malloc.h&gt; was
          also added in aid of this.</li>

          <li>Fields of type string or binary with a size greater than 1 byte,
          and having a presentation list, were not being correctly initialized
          in InitFieldList(). This has been corrected, to match the handling of
          such fields elsewhere in the template.</li>

          <li>OpenOneView() and PutCmpKey() were changed to not provoke
          VIEWASSERTions about invalid composite indexes.</li>

          <li>Fixed a bug in InitFieldList() for fields of type string or
          binary, and longer than 1 byte, and having a presentation list. Such
          fields were only having their first byte set to the default list
          entry</li>
        </ol>
      </li>

      <li>
        Numerous optimizations have been made, aimed at both performance and
        resource consumption improvements. Note that some require new System
        Manager APIs. Since A4W_API_VERSION defaults to the latest version or
        service pack level of SM, if you need to support an earlier version or
        service pack level then you will need to define A4W_API_VERSION
        appropriately. A4W_API_VERSION defaults to 0x53D, which correpsonds to
        trans-SP2 of SM 5.3A (SP3, should there be one, SM 5.3B, and SM 5.4A).
        A4W_API_VERSION may be defined down to 0x53A, which corresponds to the
        original SM 5.3A release. You should also insert the appropriate entry
        into the [Compatibility] section of your add-in&rsquo;s ??.INI file.

        <ol type="A">
          <li>Added use of the new SM API revCreateFromHandle(), optimizing
          revision creation by cutting out all database accesses by creating a
          new empty revision handle from an existing revision handle using the
          latter&rsquo;s data structures. Added V.revCache[], which is a cache
          of empty revision list handles used as a &ldquo;template&rdquo; fed
          into revCreateFromHandle(), as well as a referencer of FindRevCache()
          which may be overridden. RevisionGenerate() was changed to have an
          extra parameter, which is the &ldquo;template&rdquo; to use. Note
          that this feature requires SM 5.3A SP2, so A4W_API_VERSION must be
          0x53C or later for this to be enabled.</li>

          <li>NotifyFieldValues() now uses memcmp() for equality testing, since
          type-dependent collation is not needed. In spite of this, you should
          still code your notification handlers carefully so as to not execute
          any unnecessary statements, because it could get called
          frequently.</li>

          <li>Changed the allocation and use of the arrays of record buffers
          (V.record[], V.recordTemp[], V.recordRead[], V.recordNotify[]) to use
          the exact record size, instead of MAX_RECORD_LENGTH. This will
          probably save on the order of 10-30 KB per open view instance. This
          required logic to determine the record sizes dynamically, since they
          may be altered by subclass views. To that end, V.aTableInfo[] was
          added (an array of DBTABLE structures), as well as referencers of
          FindTableInfo() and FindTableWidth(), both of which may be
          overridden. Finally, CopyRecords() was changed to take an LPV
          parameter, so the dynamically-determined table widths can be
          used.</li>

          <li>Added use of the new SM API revCheckDuplicates(), which further
          optimizes revisions by suppressing duplicate key checks during
          <i>xxxx</i>RevisionRekey(). Note that revPost() will still always
          recheck keys for duplicates. A4W_API_VERSION must be 0x53D or later
          for this feature to be used.</li>

          <li>
            The semantics and protocol for generation of a unique key value
            have been expanded. Specifically, when you call
            viewRecordGenerate() you may specify that the actual generation of
            the new value for the primary key is to be delayed until such time
            as the record is inserted. Using this new capability will improve
            multi-user performance, particularly for headers in
            batch/header/detail settings. You specify this delayed generation
            with a new flag choice of RECORD_GENERATE_DELAYKEY, which is
            mutually exclusive of both RECORD_GENERATE_NOINSERT and
            RECORD_GENERATE_INSERT.

            <p>To enable its use, define DO_GENERATEKEYDELAYED. This activates
            the familiar GenerateKey() callout, but it is repurposed with an
            additional parameter (a set of flags) that tells you which part, or
            parts, of the record to generate or initialize. The flags may be
            the bitwise-or of the following values:</p>

            <table border="0" cellpadding="2" cellspacing="0">
              <thead>
                <tr class="grey" align="left">
                  <td class="head">Value&nbsp;</td>

                  <td class="head">Meaning</td>
                </tr>
              </thead>

              <tbody>
                <tr>
                  <td>GENERATEKEY_KEY&nbsp;</td>

                  <td>Generate a unique value for the key field(s).</td>
                </tr>

                <tr class="grey">
                  <td>GENERATEKEY_RECORD&nbsp;</td>

                  <td>Initialize data fields with default values appropriate as
                  valid values suitable, as far as possible, for
                  insertion.</td>
                </tr>

                <tr>
                  <td>GENERATEKEY_NONE&nbsp;</td>

                  <td>This value will never be passed to GenerateKey(), but is
                  nonetheless notable because it will be stored in
                  V.bKeyGenerated at times.</td>
                </tr>
              </tbody>
            </table>

            <p>GenerateKey() may be called multiple times, because generation
            of the key may now be done at a different time as the remainder of
            the record. Consequently, you must consult the flags to know which
            operation(s) are to be performed. The role of the V.bKeyGenerated
            member has also expanded to track what state the key is at, so that
            the view will follow the correct protocol to complete the
            generation as originally requested. It will have, at various times,
            various combinations of the above values.</p>

            <p>To account for the possible difference in the number of
            parameters, a new wrapper function GenerateKeyDelayed() is defined,
            which always takes 2 parameters, and calls GenerateKey() with the
            appropriate number of parameters. Also, the template provides a new
            function GenerateKeyReally() that calls GenerateKeyDelayed() only
            if the key has not yet been generated. Finally, the flags parameter
            of InitBodyGen() has a new value that is used to initiate all of
            this new behaviour: INITBODYGEN_DELAYGENERATE.</p>

            <p>This new GenerateKey() callout is meant to supersede the
            original one activated by DO_GENERATEKEY. But because the protocol
            in which it is called is different from the original, if you are
            applying this new functionality to an existing view you must
            explicitly define DO_GENERATEKEYDELAYED and change your original
            GenerateKey() function. Note that for new views you may define just
            DO_GENERATEKEYDELAYED, you do not need to also define
            DO_GENERATEKEYDELAYED.</p>

            <p>Finally, the resetting of V.bKeyGenerated in xxxReadBase() was
            changed to match xxxFetchFilterBase(). Namely, it is reset only if
            the operation completes successfully. This difference was causing a
            problem with the new delayed key generation protocol.</p>
          </li>
        </ol>
      </li>

      <li>
        New Callouts, Overrides and Conditional Features

        <ol type="A">
          <li>Added DO_NOTIFYFIRE, allowing you to override the
          template&rsquo;s NotifyFire() function.</li>

          <li>Added RekeyedRevision() callout, called once per logical record
          rekeyed during <i>xxxx</i>RevisionRekey().</li>

          <li>Added DO_REVISIONINNERPOST, allowing you to override
          RevisionInnerPost(). This allows you to maintain common
          <i>xxxx</i>Post() and <i>xxxx</i>RevisionPost() override logic.</li>

          <li>Added DO_OLDSUBCLASSFIELDBLK, which suppresses the block get/put
          optimization of retaining blocks as much as possible, and instead
          reverts to a loop breaking down the buffers into individual get/put
          calls. This was added to allow existing subclass views to maximize
          compatibility and minimize effort when you migrate to the latest
          template.</li>

          <li>Slightly modified the default behaviour of xxxVerify() so that
          when V.bVerified is TRUE, it also checks checks whether the current
          record is dirty, and if it is carries on to verify the record instead
          of returning early. This catches a situation where details&rsquo;
          revision lists are uncommitted, but the header record was otherwise
          unchanged. If you want to retain the old behaviour by omitting this
          new dirty check, define DO_OLDVERIFYDIRTY.</li>
        </ol>
      </li>

      <li>
        Miscellaneous Changes

        <ol type="A">
          <li>Removed REVLEVEL.protocol, which was not in use anywhere.</li>

          <li>Added CHECK_FETCH_GOTO() and CHECK_DBFETCH_GOTO() macros. They
          are complementary to CHECK_CALL_GOTO, in that on error they go to the
          specified label instead of returning.</li>

          <li>Removed the last 16-bit vestiges from ACCPAC.MAK. These were only
          in the form of comments, but it does cut out confusion if someone is
          reading through ACCPAC.MAK.</li>

          <li>Improved comments of some (unfortunately not all) callouts and
          overrides in <i>zzzz</i>1.C</li>

          <li>Checks were added to fileOpenBase() to ensure that the
          view&rsquo;s DBTABLE structure is compatible with the
          database&rsquo;s dictionary for the view&rsquo;s physical table(s).
          This will catch situations, for example, where you add fields or keys
          to a view, but then forget to recreate or convert the affected
          table(s). Subclassing is fully supported. Note that the checks made
          are weak, because only the DBTABLE structures are compared, but they
          will catch the majority of these problems.</li>

          <li>The requirement that the view be in the primary key to call
          GenerateKey() has been partially relaxed. InitBodyGenBase() now
          permits to be in an alternate order provided that your view was
          invoked via <i>xxxx</i>RecordGenerate(), and does not used sequence
          revision lists.</li>

          <li>
            More RVSpy logging is now done to better inform debug sessions:

            <ul>
              <li class="tight">Which field is about to be processed by
              HeaderEtc().</li>

              <li class="tight">Field names, key numbers, and rotoIDs when
              these are found to be invalid.</li>
            </ul>
          </li>

          <li>Added GhostRVH static variable, and its use in conjunction with
          the 5.4A RotoView change that sends a view&rsquo;s own RVH
          surrepticiously. This permits a view to have V.myself even if
          xxxxInstanceOpen() was not called. Note that A4W_API_VERSION must be
          0x54A (now the default) for this to function.</li>

          <li>All uses of memAlloc() that are subsequently freed within the
          same function have been replaced with uses of _alloca(). This
          simplifies and improves memory management.</li>

          <li>Changed { } scoping when mixed with #ifdef #endif so that those
          respective delimiters are balanced, and not crossed up.</li>

          <li>The reverification done in MergeConflictedRecords() has been
          weakened slightly. It now marks conflicting fields as changed, and
          calls xxxVerify() such that only changed fields are reverified.</li>
        </ol>
      </li>
    </ol>
    <!-- ================================================================== -->

    <h2 class="overhead"><a id="03-AUG-28" name="03-AUG-28">Since 03-AUG-28,
    released in SDK 5.3A</a></h2>

    <ol>
      <li>
        Fixes

        <ol type="A">
          <li>Fixed ComposeHeader() and ComposeHierarchical() bugs where
          registering a notification failed to occur in some
          circumstances.</li>

          <li>Fixed join-subclassing bug in <i>xxxx</i>BlkPut()</li>

          <li>Fixed CompositeNotify() to attach nested details only if it was
          notified by the header composite</li>

          <li>Fixed a few more C++ casting problems</li>

          <li>Fixed STUB_VIEW problem with RevisionCreate(), which had been
          assuming revisions always exist</li>

          <li>Fixed INSTANCE_NOTIFY_REVISION_CANCEL notification to pass the
          correct level in the case of AutoCancelBody().</li>
        </ol>
      </li>

      <li>
        Nested detail support has been enhanced so that nested details may now
        themselves have nested details. In other words, you can define
        HDR_HAS_REVISIONS to be greater than 1. The nesting support is fully
        generalized to any depth desired, however to date it has only been
        tested with HDR_HAS_REVISIONS up to 2. Because there is now no limit to
        the number of revision levels, the information maintained for each
        revision level is more complex. Specifically, instead of a &ldquo;list
        of revision lists&rdquo;, each level maintains a &ldquo;tree of
        revision lists&rdquo;, thus the collective of all the levels amounts to
        a &ldquo;forest of revision list trees&rdquo;. There have been some
        adjustments to the protocol, particularly the requirement that
        viewRecordGenerate() now be used on sequenced details in order to
        properly anchor their nested details. This and other changes are
        described below:

        <ul>
          <li>
            Added key generation with sequenced details. That is, if your view
            uses sequenced revisions, invoking <i>xxxx</i>RecordGenerate() will
            generate a new sequence number. It uses the new revAllocateAfter()
            function in the revision API. This permits the nested detail
            protocols to be fully generalized (the last attempt still had a
            couple of problems), and also more efficient since your view will
            cascade viewRevisionRekey() to the nested details once instead of
            twice. If the current sequence number does not exist, the sequence
            is reset to 0 and the revAllocateAfter() is retried (in other
            words, the new sequence will be at the beginning of the list). A
            number of other changes were required for this enhancement:

            <ul>
              <li>The <i>flags</i> parameter of viewRevisionRekey() was changed
              to add a bitfield indicating the level to be rekeyed; the former
              bit fields of <i>level</i> are no longer used.</li>

              <li class="tight">V.abKeyBefore was added for use by
              PutCmpDetailSequence() when calling viewRevisionRekey().</li>

              <li class="tight">V.bKeyGenerated flag was added to track when
              the key has been generated, in order to permit protocol violation
              detection. Specifically, to execute <i>xxxx</i>Insert()
              successfully when the view is composed with its nested details,
              the key must have been generated via <i>xxxx</i>RecordGenerate().
              If the view is not composed with any of its nested details, the
              old detail protocol will work because there are no keys to
              cascade down.</li>
            </ul>

            <p>Note also that the AccpacViewList UI COM component makes use of
            this facility if it detects the template version of your view to be
            5.3A or later.</p>
          </li>

          <li>
            <p>Added DO_CASCADEPOST conditional feature to control when your
            view cascades viewRevisionPost calls to its details.</p>

            <table border="0" cellpadding="2" cellspacing="0">
              <thead>
                <tr class="grey" align="left">
                  <td class="head">Value&nbsp;</td>

                  <td class="head">Meaning</td>
                </tr>
              </thead>

              <tbody>
                <tr>
                  <td>CASCADEPOST_DEFAULT&nbsp;</td>

                  <td>Cascades viewRevisionPost to the nested details before
                  your view&rsquo;s record is written or deleted, and after it
                  is posted.</td>
                </tr>

                <tr class="grey">
                  <td>CASCADEPOST_FIRST&nbsp;</td>

                  <td>Cascades viewRevisionPost to the nested details before
                  your view&rsquo;s record is written, deleted or posted. This
                  is only permitted if your view uses ordered revision
                  lists.</td>
                </tr>

                <tr>
                  <td>CASCADEPOST_AFTERHEADER&nbsp;</td>

                  <td>Cascades viewRevisionPost to the nested details after
                  your view&rsquo;s record is written, deleted or posted. After
                  cascading, the template checks whether your record has
                  changed, and if so calls RewriteRecord().</td>
                </tr>
              </tbody>
            </table>
          </li>

          <li>Added GenerateSequence() function, which commonizes already
          existing code for non-API generation of a revision sequence. This is
          called by <i>xxxx</i>Insert() or <i>xxxx</i>RecordGenerate() when the
          view has been opened with revisions suppressed.</li>

          <li>Implemented cascading viewRevisionUnposted() to nested details
          when <i>xxxx</i>Dirty entrypoint is called. Added UnpostedDetails()
          and UnpostedDetail() functions in support. Also added
          V.bUnpostedRevisions to track this state accurately when
          HDR_HAS_REVISIONS&gt;0.</li>

          <li>Moved RevisionCreate() in RevisionOuterPost() ahead of cascading
          viewRevisionPost(), so that if nested details alter this view the
          changes stick.</li>
        </ul>
      </li>

      <li>
        Added a set of macros to facilitate development and maintenance,
        particularly in your code. Their use allows you to structure your code
        in a linear manner, such that you know if you reached a particular
        statement there were no errors. As well, if you compile for debugging
        then statement and location information will be inserted into the RVSPY
        log, particularly of failures, that help to isolate problems. See the
        comments in the <i>zzzz</i>2.H file for specific information. They fall
        into two categories:

        <ol type="A">
          <li>
            Detection and handling of errors. There are two main macros:
            CHECK_CALL() and CHECK_FETCH(). Both will return from the current
            function if an error is encountered. Additionally, CHECK_FETCH()
            will break from the current loop if the &ldquo;no more
            records&rdquo; condition was reached. There are additional
            variations for both these macros to have different exit actions
            (e.g. return a boolean, or goto a label, etc.). As well there are a
            parallel set of macros of the for CHECK_DBCALL() and
            CHECK_DBFETCH() for handle database API return codes. Below is a
            live snippet of code:
<pre>
ERRNUM WriteReceipts (LPV lpv, RECEIPTLIST **receiptlist)
{
   ERRNUM e = ERRNUM_SUCCESS;
   LPVIEWDEF porcpl = FindCmp(lpv, PORCPL_CMP);
   RECEIPTLIST **receiptroot = receiptlist;

   CHECK_CALL (e, viewInit (porcpl-&gt;rvh, porcpl-&gt;view));
   CHECK_CALL (e, viewBrowse (porcpl-&gt;rvh, porcpl-&gt;view, &quot;&quot;, TRUE));

   while (TRUE) {
      CHECK_FETCH (e, viewFetch (porcpl-&gt;rvh, porcpl-&gt;view));
      CHECK_CALL (e, WriteReceipt (lpv, receiptlist, &amp;receiptroot));
   } // while

   return e;
} // end of the function
</pre>
          </li>

          <li>
            Getting and putting composite views&rsquo; field values. The main
            macros are VIEW_GET(), VIEW_PUT() and PARAM_GET(). They each also
            have variations for the different types: boolean, integer, long,
            real and string. These allow the compiler to check that types
            match. Finally VIEW_GET() and VIEW_PUT() return an ERRNUM, which
            allows them to be combined with the CHECK_CALL() family of macros.
            Below is a live snippet of code:
<pre>
ERRNUM LoadLots (
   LPV lpv,
   RECEIPTLIST *receiptnode,
   LTSHIPSETUP *setup,
   LTSHIPKEY *key)
{
   ERRNUM e = ERRNUM_SUCCESS;
   LPVIEWDEF porcpl = FindCmp (lpv, PORCPL_CMP);
   LPVIEWDEF ltset = FindCmp (lpv, LTSET_CMP);

   ShipSetupInit (setup);
   ShipKeyInit (key);

   CHECK_CALL (e, VIEW_GET_LONG (PORCPL, LTSETID, porcpl, setup-&gt;CHEADUNIQ));
   if ( !receiptnode-&gt;LTpopup || setup-&gt;CHEADUNIQ==0 ) {
      BOOL found;

      CHECK_CALL (e, viewInit (ltset-&gt;rvh, ltset-&gt;view));
      CHECK_FETCH_UNROLL (e, found, viewRead (ltset-&gt;rvh, ltset-&gt;view));
      if ( !found )
         return e;
      CHECK_CALL (e, VIEW_GET_LONG (LTSET, HEADUNIQ, ltset, setup-&gt;CHEADUNIQ));
      setup-&gt;CHEADUNIQ += 1;
      CHECK_CALL (e, VIEW_PUT_LONG (LTSET, HEADUNIQ, ltset, setup-&gt;CHEADUNIQ, FALSE));
      CHECK_CALL (e, viewUpdate (ltset-&gt;rvh, ltset-&gt;view));
      CHECK_CALL (e, VIEW_PUT_LONG (LTSET, ZERO, ltset, setup-&gt;CHEADUNIQ, FALSE));
      CHECK_CALL (e, viewInsert (ltset-&gt;rvh, ltset-&gt;view));
   }

   // Put initial key values
   CHECK_CALL (e, VIEW_PUT (LTSHIP, MODULE, ltship, setup-&gt;CMODULE, TRUE));
   CHECK_CALL (e, VIEW_PUT (LTSHIP, DOCBCD, ltship, setup-&gt;CDOCBCD, TRUE));
   CHECK_CALL (e, VIEW_PUT (LTSHIP, LINEBCD, ltship, setup-&gt;CLINEBCD, TRUE));

   // . . . code continues . . . .
</pre>
          </li>
        </ol>
      </li>

      <li>
        New Callouts, Overrides and Conditional Features

        <ol type="A">
          <li>Added ReportGenericErrorViaPIB() template function, to complement
          ReportGenericError(). It can be overridden with
          DO_REPORTGENERICERRORVIAPIB. As well, ReportError() can be overridden
          with DO_REPORTERROR, and ReportErrorViaPIB() can be overridden with
          DO_REPORTERRORVIAPIB.</li>

          <li>Added DO_LOADCOMPANYINFO feature to let the programmer explicitly
          decide if they want to use the V.CompanyInfo member.</li>
        </ol>
      </li>

      <li>
        Miscellaneous Changes

        <ol type="A">
          <li>Sources have been tweaked to facilitate porting to Linux.</li>

          <li>Use of the scratch stack, along with its support functions, is
          deprecated. All uses in the template have been replaced by auto
          buffers, or uses of _alloca(). The parameters to EntryStatePush()
          have been changed. LoadStr() has been removed; replace any uses of it
          with LoadRsc() combined with auto buffer declarations. If your code
          still needs the scratch stack, you can explicitly define
          DO_SCRATCHSTACK to 2048 (or whatever is suitable) in your
          <i>zzzz</i>1.H. Be aware, however, that this may be removed
          altogether in the future.</li>

          <li>Added the ability for the template to process errors raised in
          the AttribClear(), AttribSet(), AttribGet(), AttribPut(),
          AttribTest() and FindPresentsInfo() callouts. Inside these functions
          you may set V.eValidation to indicate a warning or error condition.
          The following functions were changed to return ERRNUM in support of
          this capability: ClearChange(), FlagKey(), FlagKeyAux(),
          LoadFieldMask(), InitField(), InitFieldList() and InitFields().</li>

          <li>Added an experimental entrypoint <i>xxxx</i>TableHandles(), which
          returns an array of the handles of the currently open database tables
          the view manages. It does not have the complete machinery that
          standard entrypoints have.</li>

          <li>Added DETAILS_ARE_REVISIONED macro, which simplifies some
          #if&rsquo;s. It indicates whether your detail composites are declared
          as being revisioned.</li>

          <li>Added field change notification for <i>xxxx</i>Insert() and
          <i>xxxx</i>Update().</li>

          <li>Added compile-time error check for superviews, barring them from
          having header and detail composites.</li>

          <li>Put in explicit cancellation of details into InitBodyGen(), but
          can retain old behaviour by defining DO_OLDINITBODYCASCADE.</li>

          <li>Removed check for the database supporting descend-browsing. All
          modern databases, including our target databases, support it.</li>

          <li>Obsolesced ReportBaseError(), as it functionality is available in
          ReportErrorViaPIB(). The template defines a macro maps
          ReportBaseError() to ReportErrorViaPIB(), but this will be removed in
          the future.</li>

          <li>A new capability has been added to MKINST in the processing of
          the content of FILES. Each line defining a file name can optionally
          have a second file name, delimited from the first by blanks. The
          second file name is the used to form the name of the file to which
          processed output is written.</li>

          <li>Added INSTANCE_NOTIFY_RECORD_DELETED notification code
          (complementing INSTANCE_NOTIFY_RECORD_DELETING) to all entrypoints
          that remove records one way or another (except <i>xxxx</i>Drop).</li>
        </ol>
      </li>
    </ol>
    <!-- ================================================================== -->

    <h2 class="overhead"><a id="02-DEC-09" name="02-DEC-09">Since 02-DEC-09,
    released in SDK 5.2A</a></h2>

    <ol>
      <li>Normalized the nested detail protocol when the detail is sequenced,
      meaning that the detail record no longer needs to be inserted prior to
      its nested details being inserted. This required adding the use of the
      flags parameter to the RevisionRekey helper, and the concept of
      &ldquo;attaching&rdquo; to the current revisions when the detail does
      <i>xxxx</i>Insert, <i>xxxx</i>Update, <i>xxxx</i>Read or
      <i>xxxx</i>Fetch. The timing of post inside insert was changed to after
      the fileInsert, but only when the view is revisioned. Flags are now
      defined in ROTOVIEW.H for viewRevisionRekey. The attaching was
      implemented using notifications (see next item).</li>

      <li>
        Added the ability for the programmer to have a template-managed
        notification be registered with any composites. CMPNAME.options was
        added to let you specify a bitset of options to modify the
        template&rsquo;s interactions with that composite. Thus far only
        CMPNAME_OPTION_NOTIFY is available. Note that you must have
        DO_CMPNAMESTRUCT defined to use CMPNAME.options. CMPNAME_OPTION_NOTIFY
        is automatically implied when a view&rsquo;s header has revisions.

        <p>CompositeNotify() is the template-supplied notification handler. You
        can override it with DO_COMPOSITENOTIFY. The context parameter that
        CompositeNotify() receives is a CMPNOTIFYCONTEXT structure, and holds
        an LPV and the composite number. The template initializes an array of
        them in V.cmpNotifyContext[]. FindCmpNotify() returns a reference to a
        specified CMPNOTIFYCONTEXT, and can be overridden with
        DoFindCmpNotify().</p>
      </li>

      <li>Added RVSPYINDENT, a macro that expands conditionally (depending on
      whether the ACCPAC_DEBUG symbol is defined) to rvspyIndentation(). This
      allows you to structure your RVSPY output by indenting and outdenting
      related sections.</li>

      <li>Made handling of fields in <i>xxxx</i>BlkPut() and
      <i>xxxx</i>BlkGet() more intelligent with respect to subclasses.
      Specifically, any subsequences of fields that are for the base view are
      passed down directly via viewBlkPut() and viewBlkGet(), instead of
      letting <i>xxxx</i>Put() and <i>xxxx</i>Get() make the diversion.</li>

      <li>Made the following conditional features obsolescent:
      DO_NOREADOPTIMIZING, DO_NOREVISIONOPTIMIZING, DO_OLDMAPTODETAILS,
      DO_OLDPERMISSION, DO_SELECTFETCH. If you had been using these, you may
      need to reexamine why you were using them. In particular,
      DO_OLDMAPTODETAILS and DO_OLDPERMISSION had been in place to keep
      compatibility with older template behaviours that are no longer being
      maintained.</li>

      <li>Made the following conditional features redundant: DO_CALLOUTERRORS,
      DO_INITBYFIELD, DO_PASSIVECONCURRENCY, DO_REALSUPPORT, DO_STANDARDERRORS.
      The described behaviours for each of these are now always in effect.</li>
    </ol>
    <!-- ================================================================== -->

    <h2 class="overhead"><a id="01-DEC-18" name="01-DEC-18">Since 01-DEC-18,
    released in SDK 5.1A</a></h2>

    <ol>
      <li>
        Fixes

        <ol type="A">
          <li>Forced reporting of attributes on key fields to also be ENABLED +
          EDITABLE. In some obscure circumstances those attributes
          weren&rsquo;t maintained properly.</li>

          <li>Fixed various prototypes of call-outs that hadn&rsquo;t
          previously been instantiated.</li>

          <li>Fixed recovery from errors upon posting of multi-table
          revisions.</li>

          <li>Added subclass chaining in <i>xxxx</i>RecordClear() and
          <i>xxxx</i>RecordGenerate()</li>
        </ol>
      </li>

      <li>
        Added support for nested details. That is, a detail view may now itself
        have detail composites. The lifetime and control of the nested detail
        records are a logical extension of the existing header-detail protocol.
        Basically, a detail record owns a set of nested details, and browsing
        on those nested details is restricted to the subset indicated by the
        current detail.

        <p>Nested details have multiple levels of revisions. Any record-level
        operation (such as viewFetch() or viewDelete()) on the detail view will
        cause the subset of nested details owned by that detail record to be
        committed or cancelled. Further, those nested details will committed or
        cancelled not to disk, but instead to an intermediate state or
        &ldquo;list of revision lists&rdquo;. The record-level operations
        affect the so-called &ldquo;innermost&rdquo; level. Posting the
        innermost level commits the revision list to an &ldquo;outermost&rdquo;
        level, which is the list of revision lists. When you cancel the nested
        details, including when you fetch a new detail record, the template
        cancels the innermost revision list and duplicates from the list of
        revision lists that revision list corresponding to the detail
        record.</p>

        <p>In support this, the view API has been generalized from the existing
        revision-related entrypoints to include a parameter of the revision
        level, plus other relevant information as necessary. A level of 1 is
        the outermost, equivalent to the historical revision support. The level
        can range up to 2 for the innermost at present, meaning nested detail
        cannot themselves have nested details. (This limit may be lifted in the
        future, as needed.) Passing a level of 1 to the new entrypoints is the
        equivalent of calling the old revision entrypoints. The following new
        entrypoints have all related template framework that entrypoints
        entail. They can be overridden, support extended errors, and can be
        subclassed.</p>

        <ol type="A">
          <li><i>xxxx</i>RevisionCancel() cancels the given level and all inner
          levels. It also cascades this call (including the level) to any
          nested detail composites.</li>

          <li class="tight"><i>xxxx</i>RevisionPost() commits the revisions at
          the given level to the next level out (level - 1). It does <i>not</i>
          post inner levels if those have not been posted. It <i>does</i>,
          however, cascade this call (including the level) to any nested detail
          composites.</li>

          <li class="tight"><i>xxxx</i>RevisionUnposted() returns whether the
          given level has unposted revisions. Does not take inner levels into
          account. It is a generalization of the DIRTY_IDX pseudo-field.</li>

          <li class="tight"><i>xxxx</i>RevisionRekey() reassigns the primary
          key values in a nested detail. It is called by a sequenced detail
          whenever the sequence number changes, as when posting.</li>
        </ol>

        <p>In practice it is unnecessary to call these new entrypoints directly
        (with the possible exception of <i>xxxx</i>RevisionUnposted()). They
        get called in the course of in the course of <i>xxxx</i>Insert(),
        <i>xxxx</i>Update(), <i>xxxx</i>Delete(), <i>xxxx</i>Put(),
        <i>xxxx</i>Fetch() et al, <i>xxxx</i>Read() et al, <i>xxxx</i>Post() et
        al, <i>xxxx</i>Cancel() et al, and <i>xxxx</i>Init() et al, .</p>

        <p>There is a quirk in the logical extension to the protocol when the
        detail is sequenced. Before you can insert any records to the nested
        detail, the detail record must exist. The only way you can enforce this
        is to declare that the nested detail fulfills batch behaviour. You do
        this by defining BATCH_VIEW in the nested detail (in addition to
        DETAIL_VIEW).</p>

        <p>In order to enable nested details, there are 2 sides to consider:
        the detail view, and the nested detail view. For the detail view you
        simply define in <i>zzzz</i>1.H the number of DTL_CMP_COUNT composites.
        For the nested detail, define every thing you need for a detail view in
        <i>zzzz</i>1.H (DETAIL_VIEW, HAS_REVISIONS, HDR_CMP_COUNT and
        DTL_SEG_COUNT), plus define HDR_HAS_REVISIONS to <i>n</i>. This
        instructs the template that this view&rsquo;s ancestors to the
        <i>n</i><sup>th</sup> degree have revisions. At present
        HDR_HAS_REVISIONS is constrained to not be greater than 1.
        (Incidentally, the innermost level of any particular revisioned view is
        (<i>n</i> + 1).)</p>

        <p>A REVNODE structure has been added, which records a revision list
        and necessary context. A list of REVNODE structures is held in
        V.revList. Added a host of support functions prefixed with
        &ldquo;Revision&rdquo;; these mostly overlie, and in a few cases
        underlie, the file... family of functions. Also added
        MapToNestedDetails() and PutCmpDetailSequence() in support of this.</p>
      </li>

      <li>
        Added 2 other new entrypoints, along with all related template
        framework that entrypoints entail. Both can be overridden, support
        extended errors, and be subclassed. Note that they have not been added
        to the component layers above ROTOVIEW. For instance, they cannot be
        invoked from an AccpacDataSource object as yet, but they can be invoked
        from &ldquo;View Tester&rdquo;

        <ol type="A">
          <li><i>xxxx</i>FilterCount() counts the number of records matching
          the supplied filter. If the filter selects fields that aren&rsquo;t
          part of the primary physical record, they will be omitted from the
          dbGetRecordCount() call made, with the result being an over-estimate
          of the number of records.</li>

          <li>
            <i>xxxx</i>InstanceProtocol() returns a flag set of information on
            how the view has been defined to operate. It will optionally also
            call return this information for its ancestor composites.

            <ul>
              <li>The basic protocol the view fulfills.</li>

              <li class="tight">Revisioning options, including what type and
              the number of segments a detail&rsquo;s key adds to its header
              composite&rsquo;s key.</li>

              <li class="tight">Whether generation of a new primary key value
              is supported.</li>

              <li class="tight">Whether the view is a subclass, and what
              type.</li>

              <li class="tight">Whether the record in the view&rsquo;s header
              composite must exist before insertion is permitted.</li>
            </ul>
          </li>
        </ol>
      </li>

      <li>
        Added direct support for C++, and not just casting any longer. When
        compiled as C++ sources, the view handle type V is declared and handled
        by the template as a class. Note that the CVIEW template has <i>not</i>
        been refactored into a collection of classes. Rather, the view handle
        has been wrapped in a class, permitting you the partial ability to
        leverage object-oriented facilities.

        <p>When compiled as C++, V is a typedef of VEXTRA, which in turn is
        derived from VBASE, which in turn is derived from the original C tagV
        structure.</p>

        <ul>
          <li>tagV defines the member data and has <i>no</i> member functions,
          although it does have a default constructor that zeroes the content
          of the structure.</li>

          <li class="tight">VBASE is the root of V&rsquo;s object-oriented
          behaviour, having a virtual destructor. The only use of this
          structure is as the base for VEXTRA.</li>

          <li class="tight">Use VEXTRA to extend the view handle with your own
          data and function members. Under C++ you no longer define
          DO_VIEWHANDLE in order to declare VEXTRA (in fact the template will
          not permit you define DO_VIEWHANDLE). Instead, a new editable file
          <i>zzzz</i>3.H has been added to the CVIEW template in which you
          declare VEXTRA. This change was needed because for C++ it must be
          after the tagV declaration.</li>
        </ul>

        <p>A final change in support of C++ is the addition of V.OpenExtra. It
        is a dynamically allocated copy of the extra data passed in by
        reference to <i>xxxx</i>InstanceOpen(). Formerly this data had been
        stored at (lpv + 1), which was not maintainable, portable, nor
        compatible with C++.</p>
      </li>

      <li>
        New Callouts, Overrides and Conditional Features

        <ol type="A">
          <li>Made error reporting from low-level file I/O routines more
          alterable. Added variants of fileError(), dbError(), revError() and
          filterError() that take an LPV. These functions have a suffix of
          &ldquo;V&rdquo;. The alterable aspect is the addition of
          ReportGenericError(), which calls errPutGeneric() in the API, and
          which can be overridden with DO_REPORTGENERICERROR. If you have
          already overridden fileError() under the old regime, you may retain
          this behaviour with DO_OLDFILEERROR</li>

          <li>
            <p>Added better checking for the sizes of buffers passed to
            <i>xxxx</i>Put() and <i>xxxx</i>Get() entrypoint. ValidateBuffer()
            makes the check and reports errors. The reporting of errors is done
            by ReportBufferError(), for which there are corresponding CLANG and
            CPROJECT changes for a new standard error message. It can be
            configured to following levels of strictness, using the
            VALIDATE_BUFFER preprocessor symbol:</p>

            <table border="0" cellpadding="2" cellspacing="0">
              <thead>
                <tr class="grey" align="left">
                  <td class="head">Value&nbsp;</td>

                  <td class="head">Meaning</td>
                </tr>
              </thead>

              <tbody>
                <tr>
                  <td>VALIDATE_NO_BUFFER&nbsp;</td>

                  <td>No additional buffer size checks (old behaviour). The
                  template instead scales the data into, or out of, the buffer
                  in order to maintain its value.</td>
                </tr>

                <tr class="grey">
                  <td>VALIDATE_FIXED_BUFFER&nbsp;</td>

                  <td>Buffers for data types that are always fixed in size are
                  not permitted to deviate from the declared field size. These
                  include integer (short and long), boolean, real, date and
                  time.</td>
                </tr>

                <tr>
                  <td>VALIDATE_BCD_BUFFER&nbsp;</td>

                  <td>In addition to the above types, BCD-coded numerics
                  (number and money) are not permitted to deviate from the
                  declared field size.</td>
                </tr>

                <tr class="grey">
                  <td>VALIDATE_ANY_BUFFER&nbsp;</td>

                  <td>No buffers permitted to deviate from the declared field
                  size. This generalizes the above to string and binary.</td>
                </tr>
              </tbody>
            </table>
          </li>

          <li>Added ability to override the following functions: xxxRead(),
          DeleteBody(), DeleteDetailsBody(), InitBodyGen() and
          xxxFetchFilter().</li>

          <li>Created CancelBody(), generalizing cancellation. It can be
          overridden. If you have previously overridden <i>xxxx</i>Cancel(),
          you should move that code to CancelBody(), so that
          <i>xxxx</i>RevisionCancel() will also call your custom code.</li>
        </ol>
      </li>

      <li>
        Miscellaneous Changes

        <ol type="A">
          <li>Added new data members to V: OrgID, wOrgType, CompanyInfo and
          SeriesInfo. These are all initialized in OpenBody, although
          CompanyInfo will not if wOrgType is ORG_TYPE_SYSTEM.</li>

          <li>Simplified MapToNestedDetails(); it was guarding against spurious
          conditions</li>

          <li>Fulfilled notification on posting of multi-table revisions.</li>

          <li>Changed import field validation behaviour of the <i>xxxx</i>Put()
          entrypoint. It no longer forcibly suppresses field validation, but
          you can retain the old behaviour with DO_OLDIMPORTVALIDATION</li>

          <li>Changed the LPV parameters of the view<i>YYY</i> family of view
          API shadow functions to take LPVOID. This matches an equivalent
          change in the view API. The LPV name should <i>never</i> have been
          exposed, because it suggests every view has the same LPV layout,
          which is untrue.</li>

          <li>Lowered the default verbosity of TEMPLATE_WARNING_LEVEL by having
          it as 1</li>

          <li>Loosened the checking in <i>xxxx</i>FilterDelete() of the current
          key to permit operation using non-primary keys most times. Return a
          warning when there is a possibility of causing orphans. Inserted
          fileCreate() / filePost() around the simulation code.</li>

          <li>Added dropping of keys and fields in <i>xxxx</i>Drop().
          Applications, including add-ins, can now have a complete and proper
          deactivate procedure!</li>
        </ol>
      </li>
    </ol>
    <!-- ================================================================== -->

    <h2 class="overhead"><a id="01-JUL-17" name="01-JUL-17">Since 01-JUL-17,
    released in SDK 5.0A</a></h2>

    <ol>
      <li>
        Fixes

        <ol type="A">
          <li>Minor syntactic fixes for subclasses</li>

          <li>Fixed auto-generate bug</li>

          <li>Fixed a variety of small bugs and warnings, to do with new 4.2
          entrypoints.</li>

          <li>Calls to MapToNewFieldIndex() were missing from the
          <i>xxxx</i>BlkGet() and <i>xxxx</i>BlkPut() entrypoints. This has
          been fixed.</li>

          <li>Restored the use of the APPL macro when calling viewLoadEx. In a
          development release of the template this had been replaced with a
          call to ibGetPgmID(), which caused havoc in the presence of stub
          views. Thankfully this was a short-term change.</li>

          <li>Changed the opening of a read-only instance to no longer forcibly
          suppress validations. This was causing strange
          &ldquo;drop-outs&rdquo; in behaviour. In particular, precisely in
          situations where you want to use read-only instances: validating
          foreign keys. I&rsquo;m not sure what the implications of this are,
          as this was the case with the 4.2A template. One mitigating factor
          may be that for most applications it isn&rsquo;t until recently that
          promulgation of read-only instances has started.</li>

          <li>Fixed loading of description resource strings so to not truncate
          the last character when the string&rsquo;s length is greater than or
          equal to the buffer&rsquo;s length.</li>

          <li>Fixed ComposeHierarchical() to lookup composite&rsquo;s foreign
          key from the tagCMPNAME, a la OpenOneView().</li>

          <li>Fixed the error-recovery logic of fileAdd(); it was off by 1 in
          while loop.</li>
        </ol>
      </li>

      <li>
        A new entrypoint, <i>xxxx</i>InstanceNotify(), has been added. It
        permits a caller to register a callback function, which the template
        will invoke upon certain conditions arising:

        <ul>
          <li>Field values and attributes changing</li>

          <li class="tight">Revision cancellation and progression through
          posting</li>

          <li class="tight">Record operations</li>

          <li class="tight">Miscellaneous view handle state changes</li>
        </ul>

        <p>If you don&rsquo;t use <i>xxxx</i>InstanceNotify() there is
        essentially no impact, but there are unavoidably some additional
        function calls to fire notifications in existing branches of code. If
        no notifications are registered these notification firing functions
        immediately return. The flow of prior logic did not need to be changed
        for this, and all the related logic is new.</p>

        <p>With a subclass view, the information received by
        <i>xxxx</i>InstanceNotify() is not passed down the chain. Instead, a
        callback of the subclass&rsquo;s is registered with the base view, with
        enough context to retrieve the original registration the outside caller
        made. In this way, the subclass can filter every notification the base
        view fires. Normally, the callback is simply passed back up the chain.
        However, it may be useful if the subclass wants to do something special
        at a very specific condition (such as during posting), or perhaps
        suppress the notification altogether. The subclass&rsquo;s callback
        function, BaseNotify(), can be overridden for this purpose.</p>

        <p>Field value and attribute change notifications are handled in
        rotoEntry(). These are done on the basis of before/after field-by-field
        comparisons of the record and attribute images. Field value changes are
        only examined for <i>xxxx</i>Put(), <i>xxxx</i>BlkPut() and
        <i>xxxx</i>Process() entrypoints. The rationale is that for things like
        <i>xxxx</i>Init() or <i>xxxx</i>Fetch() the entire record is likely
        changed, and there is usually some major UI navigation occurring that
        will cause the entire record to be gotten. For field attribute changes
        there are more calls under which they can change, primarily
        record-oriented calls. There are other calls where these conditions are
        either irrelevant or undefined.</p>

        <p>Other notifications, primarily of record and revision operations,
        are fired from within the view logic. These typically tell you when
        something has happened, and occasionally before something happens. Look
        in ROTOVIEW.H for a list of notifications available; they begin with
        &ldquo;INSTANCE_NOTIFY_&rdquo;. Many of the notification codes pass
        additional information when the handler is invoked, which are noted in
        comments in ROTOVIEW.H.</p>

        <p>The template has the following changes in support of
        <i>xxxx</i>InstanceNotify():</p>

        <ul>
          <li>Added V.recordNotify[], parallel to V.record[]. When call is made
          that may change fields in unpredictable ways is made, rotoEntry()
          backs up the current record to recordNotify. For consistency
          FindRecordNotify() was added, which can be overridden with
          DoFindRecordNotify.</li>

          <li class="tight">Added V.attributesNotify[], parallel to
          V.alAttributes[]. When call is made that might change attributes,
          rotoEntry() backs up the current attributes to
          attributesNotify[].</li>

          <li class="tight">Added NOTIFYCONTEXT typedef, and V.NotifyList of
          that type, to keep a linked-list of registered notifications.
          V.NextNotifyList tracks where the next notification registered should
          be inserted.</li>

          <li class="tight">Added functions to manage V.NotifyList:
          BaseNotify(), FindRecordNotify(), NotifyAdd(), NotifyClose(),
          NotifyFieldAttributes(), NotifyFieldValues(), NotifyFire(),
          NotifyRemove().</li>
        </ul>
      </li>

      <li>
        Other new view entrypoints. These all have the related template
        framework that entrypoints entail. They can both be overridden, support
        extended errors, and can be subclassed.

        <ol type="A">
          <li>
            <i>xxxx</i>FilterSelect() and <i>xxxx</i>FilterFetch() are intended
            as &ldquo;upgraded&rdquo; versions of <i>xxxx</i>Browse() and
            <i>xxxx</i>Fetch(), respectively. They add convenience, as well as
            wrapping what would be several calls to the old entrypoints into a
            single new entrypoint call. The new entrypoints are fully
            compatible with the old, in that calls to the old and new can be
            intermixed.

            <ul>
              <li><i>xxxx</i>FilterSelect() combines the semantics of
              <i>xxxx</i>Order(), <i>xxxx</i>Browse() and optionally
              <i>xxxx</i>Init(). The main intent is that the function behave
              similarly to a SQL SELECT statement. The <i>ascending</i> flag of
              <i>xxxx</i>Browse() has been replace with a <i>flags</i> bitset
              parameter. An additional bit in <i>flags</i> indicates</li>

              <li class="tight"><i>xxxx</i>FilterFetch() retrieves the next
              record without regard to conditions that destroy the database API
              browse state. It differs from <i>xxxx</i>Fetch() in that under a
              variety of conditions <i>xxxx</i>Fetch() will end up retrieving
              the current record. In other words, it does for the template what
              .GoNext does for AccpacCOMAPI. It also combines
              <i>xxxx</i>Fetch() and <i>xxxx</i>FetchLock(). It adds a
              <i>flags</i> bitset parameter, and so far the only bit in use
              (FILTER_FETCH_LOCK) indicates whether the record fetched should
              be locked.</li>
            </ul>

            <p>There have been numerous changes to the template in support of
            the above:</p>

            <ul>
              <li>The fileFirst() function has been extended to use the
              database API&rsquo;s dbGetFirst() and dbGetLast() functions in
              support of the FILTER_SELECT_FROMSTART flag.</li>

              <li class="tight">The <i>lock</i> flag of the xxxFetch() and
              xxxFetchFilter() has been transformed into a bitset, supporting
              the new modes of fetching records. FETCHFILTER_* constants added
              to <i>zzzz</i>2.H for this. These functions also ensure the
              various flavours of browse/fetch view APIs can all
              interoperate.</li>

              <li class="tight">New view handle data members V.bSelectFromStart
              and V.bBrowseInSync support interoperation of the various
              flavours of browse/fetch view APIs.</li>

              <li class="tight">New template function ComparePrimary() in
              support of <i>xxxx</i>FilterFetch()..</li>

              <li class="tight">Subclassing is fully supported. Common code put
              in BaseFetch() and BaseBrowse(), called by fileFirst() and
              fileNext(). Also added view handle data members in aid of
              subclassing: V.subVersionTemplate, V.subDateTemplate.</li>
            </ul>
          </li>

          <li><i>xxxx</i>InstanceSecurity() is similar to
          <i>xxxx</i>Security(), differing in the fact that it takes a view
          handle parameter. In other words, it operates with the view&rsquo;s
          current state, allowing you to implement context-dependent security
          permissions.</li>

          <li>
            <i>xxxx</i>RecordGenerate() and <i>xxxx</i>RecordClear() are
            intended to supercede <i>xxxx</i>Init(), in that they separate the
            overloaded purposes that had been placed upon <i>xxxx</i>Init().

            <ul>
              <li><i>xxxx</i>RecordClear() simply clears the record content,
              with no side-effects other than the propagation to composites of
              changed foreign key values.</li>

              <li class="tight"><i>xxxx</i>RecordGenerate() does the preceding,
              plus it generates a unique new primary key value (via the
              GenerateKey() callout). It also has a <i>flags</i> bitset
              parameter, one of the bits of which (RECORD_GENERATE_INSERT)
              indicates whether to insert the record immediately. The default
              is to <i>not</i> insert.</li>
            </ul>

            <p>The implementation of InitBodyGen() was altered in aid of these
            entrypoints. It remains completely call-compatible with the old
            semantics, but there is expanded interpretation of the
            <i>generate</i> parameter in order to support the specific options
            of <i>xxxx</i>RecordGenerate(). The new flags are in
            <i>zzzz</i>2.H, prefixed by &ldquo;INITBODYGEN_&rdquo;.</p>
          </li>
        </ol>
      </li>

      <li>
        The new view APIs introduced in 4.2 and 5.0 have been promulgated
        throughout all the layers that provide access to views. In support of
        this, the versioning entrypoints have been made accessible from
        ROTOVIEW:

        <ol type="A">
          <li>identifyVersionTemplate()</li>

          <li class="tight">identifyViewTableCount()</li>

          <li class="tight">identifyViewTables()</li>

          <li class="tight">identifyViewName()</li>

          <li class="tight">identifyVersionAPI()</li>

          <li class="tight">identifyViewModule()</li>
        </ol>

        <p>The support in the AccpacCOMAPI and AccpacDataSource COM type
        libraries is not quite complete. The <i>xxxx</i>InstanceNotify()
        entrypoint is not yet supported, and neither are B-F above. Support for
        these will be implemented as need arises, though neither E nor F will
        be exposed. The mapping of APIs to the AccpacCOMAPI objects, methods
        and properties is straightforward.</p>

        <p>The mapping of the APIs to the AccpacDataSource objects, methods and
        properties is <i>mostly</i> straightforward. What is different is how
        the view is opened, since you don&rsquo;t open a view as such, but
        instead activate the data source. There are new design-time properties
        that you can configure, both programmatically and in the form designer,
        which are then used when the data source is activated. Except where
        noted otherwise, the following properties are read/write at design
        time, read/write when inactive at runtime, and read-only when active at
        runtime:</p>

        <ul>
          <li>InstanceNonheritable - Boolean, defaults to False</li>

          <li class="tight">InstancePrefetch - Integer, defaults to 0</li>

          <li class="tight">InstanceReadonly - Boolean, defaults to False</li>

          <li class="tight">InstanceUnrevisioned - Boolean, defaults to
          False</li>

          <li class="tight">InstanceUnvalidated - Boolean, defaults to
          False</li>

          <li class="tight">UseOpenViewInstance - Boolean, defaults to
          False</li>

          <li class="tight">InstanceExtra - this is not a design-time property;
          you must fill it in programmatically. This property is relevant only
          if the view can take extra parameters beyond the standard set
          required by <i>xxxx</i>InstanceOpen(). If used, you must pass an
          array of bytes. Also, because the views for child data sources get
          opened on the server prior to the UI having activated the associated
          data sources, you must turn off the .AutoCompose behaviour of the
          data sources and explicitly compose them yourself.</li>
        </ul>
      </li>

      <li>
        Miscellaneous Changes

        <ol type="A">
          <li>Changed MapToDetail() to take a va_arg-type parameter, rather
          than a variable number of arguments; this makes it more general and
          requires less maintenance. Also Changed MapToDetail...(...) et al to
          reparse the va_arg parameter on each iteration.</li>

          <li>Added macro inline stand-ins for call-outs that
          <i>aren&rsquo;t</i> defined. This greatly simplifies things because
          no conditional compilation is needed for them in <i>zzzz</i>.C.</li>

          <li>Changed behaviour of OpenBody(), to call InitBody() after
          OpenEtc(). It does the old behaviour if DO_OLDOPENETC is defined or
          there is no OpenEtc().</li>

          <li>Suppressed clearing of changed flags on xxxRead() when the record
          is not found</li>

          <li>Made use of API version 5.0 mandatory. There are too many
          dependencies on it to successfully spoof it.</li>

          <li>Added table-driven field comparator system, instead of using
          [_f]memcmp(), which has bitten us many times. New type:
          FIELDCOMPARATOR. New static data: aTypeComparators[].</li>

          <li>Made the DO_INITBYFIELD behaviour the default. There is no longer
          any such conditional feature.</li>

          <li>Added GetTemplateVersion(), generalizing
          SupportsAPIversion()</li>

          <li>Changed rotoEntry() to always call EntryStatePush() /
          EntryStatePop() when the view op is <i>not</i> one having no view
          handle. The double negative is intentional, because both ROTOVIEW and
          the CVIEW template implicitly assume all extension call have both
          .rvh and .vh. This will have an impact if you have previously
          overridden rotoEntry() or rotoEntryEtc() specifically to add calls to
          EntryStatePush() / EntryStatePop() for extension calls: these
          EntryStatePush() / EntryStatePop() calls are now redundant. This
          change also had the side-effect of simplifying the switch statements
          in that function.</li>
        </ol>
      </li>
    </ol>
    <!-- ================================================================== -->

    <h2 class="overhead"><a id="00-APR-05" name="00-APR-05">Since 00-APR-05,
    released in SDK 4.2A</a></h2>

    <ol>
      <li>
        Fixes

        <ol type="A">
          <li>Corrected LoadOneView() to load the application code via
          ibGetPgmID, instead of APPL, which didn&rsquo;t take stub views into
          account.</li>

          <li>Fixed a bug where BaseRotoEntry was reporting an error via
          ReportRotoError, but the v-&gt;view view handle was not yet set (as
          with viewInstanceOpen). In such situations a NULL pointer was
          dereferenced.</li>

          <li>Corrected a boundary bug in the file stub routines, where upon an
          error the recovery was usually going too far. This affected
          fileDelete(), fileInsert(), fileOpen() and fileOptLock().</li>

          <li>
            Subclassing fixes:

            <ul>
              <li class="tight">Opening the base view when it has no keys.</li>

              <li class="tight">Processing of DIRTY_IDX pseudo-field in
              presence of subclassing.</li>

              <li class="tight">Propagation of view extension calls to the base
              view were done with the wrong length for the ROTOVIEW structure
              passed through.</li>

              <li class="tight">Other fixes in fileInfoBase(), PutCmpKeyBase()
              and xxxKey().</li>
            </ul>
          </li>

          <li>Fixed a bug where calling rotoEntry() with a VIEW_OP_... code not
          supported by the view, and the view handle hadn&rsquo;t yet been
          allocated, caused a GPF instead of returning ERRNUM_ROTOENTRY_FAILED.
          This bug was introduced in version 3.0 of the template.</li>
        </ol>
      </li>

      <li>
        New view API entrypoints. These are the first additions to the view API
        since 1.0A! This is the first in a series of enhancements. This first
        enhancement focuses on performance issues, by giving the caller some
        ability to push some of the processing from the client to the database
        server. These all have the related template framework that entrypoints
        entail. They can both be overridden, support extended errors, and can
        be subclassed.

        <ol type="A">
          <li>
            <p><i>xxxx</i>InstanceOpen() opens a new instance of view from an
            RVH. Unlike <i>xxxx</i>Open(), you can pass in additional
            parameters to control certain characteristics of the view instance
            that gets opened. In particular, there is a bitset of flags you can
            specify:</p>

            <table border="0" cellpadding="2" cellspacing="0">
              <thead>
                <tr class="grey" align="left">
                  <td class="head">Value&nbsp;</td>

                  <td class="head">Effect</td>
                </tr>
              </thead>

              <tbody>
                <tr>
                  <td>INSTANCE_OPEN_READONLY&nbsp;</td>

                  <td>The database table(s) will be opened read-only. Enables
                  use of dbSelect() and dbFetch(). These DBS functions push
                  filter evaluation to the database server, and retrieve
                  multiple records in one round-trip, respectively. The
                  template automatically enables this flag&rsquo;s behaviour if
                  it detects that the link is read-only. This optimization can
                  be suppressed by defining DO_NOREADOPTIMIZING in your
                  <i>zzzz</i>1.H. V.</td>
                </tr>

                <tr class="grey">
                  <td>INSTANCE_OPEN_UNREVISIONED&nbsp;</td>

                  <td>Suppresses the use of revision lists (if this is a
                  revisioned view); table(s) will be accessed directly. The
                  template automatically enables this flag&rsquo;s behaviour if
                  INSTANCE_OPEN_READONLY has been specified. This optimization
                  can be suppressed by defining DO_NOREVISIONOPTIMIZING in your
                  <i>zzzz</i>1.H.</td>
                </tr>

                <tr>
                  <td>INSTANCE_OPEN_UNVALIDATED&nbsp;</td>

                  <td>Suppresses all validations. The template automatically
                  enables this flag&rsquo;s behaviour if INSTANCE_OPEN_READONLY
                  has been specified.</td>
                </tr>

                <tr class="grey">
                  <td>INSTANCE_OPEN_IMMEDIATE&nbsp;</td>

                  <td>Forces view to be opened immediately, rather than on the
                  first operation needing a legitimate view handle. This is
                  actually a directive to ROTOVIEW, not the view itself.</td>
                </tr>

                <tr>
                  <td>MASK_INSTANCE_OPEN_PREFETCH&nbsp;</td>

                  <td>The least significant 6 bits of the flags indicate the
                  number of records to buffer when dbFetch() is being used, as
                  in INSTANCE_OPEN_READONLY or DO_SELECTFETCH. If it is 0 the
                  template defaults this value to DO_FETCHCOUNT. If you have
                  not defined DO_FETCHCOUNT in your <i>zzzz</i>1.H it defaults
                  to 8.</td>
                </tr>

                <tr class="grey">
                  <td>INSTANCE_OPEN_NOINHERIT&nbsp;</td>

                  <td>Suppresses the inheritance of these INSTANCE_OPEN_...
                  flags when this view implicitly opens composite views. Note
                  that MASK_INSTANCE_OPEN_PREFETCH, INSTANCE_OPEN_NOINHERIT and
                  the generic extra parameter (see below) are never
                  inherited.</td>
                </tr>

                <tr>
                  <td>INSTANCE_OPEN_RAW&nbsp;</td>

                  <td>Suppresses PutEtc() on field puts. It is parsed but not
                  implemented.</td>
                </tr>

                <tr class="grey">
                  <td>INSTANCE_OPEN_NOCASCADE&nbsp;</td>

                  <td>Suppresses propagation of foreign key values to composite
                  views. It is parsed but not implemented.</td>
                </tr>
              </tbody>
            </table>

            <p>There is also a generic extra parameter, which is a pointer to
            an application-defined block. The template stores this additional
            data in the view handle, above the VEXTRA area (that is, at (lpv +
            1)). The template does nothing further with it. It is up to you to
            inform anyone using your view what the structure of this block
            is.</p>

            <p>In order to make use of the new flags with composite views, the
            KEYMAP and CMPNAME types have been extended. KEYMAP has an extra
            member, flags. No additional work is necessary to use it, aside
            from specifying a value in the hierarchyKeyMap[] as needed. If
            nothing is specified it defaults to old behaviour.</p>

            <p>Since KEYMAP is used only for foreign keys, header/detail and
            manual composites are not handled. For this reason CMPNAME has been
            changed into a structure, adding the flags and composite view order
            to the rotoID. Due to the nature of this change you must define
            DO_CMPNAMESTRUCT in order to utilitize it, and you must surround
            the existing rotoID initializers with { } delimiters.</p>

            <p>In order to detect what version of the template was implemented
            with, and thus whether any of these new entrypoints are available
            in any particular composite view, a new function
            SupportsAPIversion() has been added. It uses the new versioning API
            (see below). OpenOneView() uses it to detect whether it can call
            viewInstanceOpen() or not.</p>

            <p>Since there are now 2 entrypoints to open a view, a new template
            function OpenBody() implements the common logic. If you had
            previously overridden <i>xxxx</i>Open() it is <i><b>vital</b></i>
            that you move this code to the OpenEtc() callout (activated with
            DO_OPENETC) which is called by OpenBody(). In fact, if you fail to
            do so the template will inform you, and will turn
            <i>xxxx</i>InstanceOpen() into <i>xxxx</i>Open().</p>

            <p>An interesting characteristic of <i>xxxx</i>InstanceOpen(), in
            contrast to <i>xxxx</i>Open() and all other template entrypoints,
            is that it takes an LPRVH parameter. This is the ROTOVIEW handle,
            which is normally used by callers to invoke a view through
            ROTOVIEW. The template stores this value in the view handle in the
            data member V.myself. This allows you, at last, to pass your own
            view handle around when composing things.</p>

            <p>If a view using sequenced revisions is opened with revisioning
            suppressed, there is some change in the behaviour of
            <i>xxxx</i>Insert(). Specifically, since revInsertAfter() is not
            being called, <i>xxxx</i>Insert() simulates its effect by
            incrementing the current key by REV_SKIP. Naturally this opens an
            opportunity for insertion to fail when it probably wouldn&rsquo;t
            have with revisioning. However, it is expected that most uses of
            revision-suppression will be done by posting-type programs, where
            lots of new records are being pumped out.</p>

            <p>The following data members were added to the view handle V in
            support of the above changes: dbFilter, rangeFilter,
            fetchedRecords, fetchedRecordCount, currentFetchedRecord,
            bUnvalidated, bRevisioned, bReadOnly, bRawData, bCascades,
            bInherits, wFetchCount, wDriverID, wPrimaryRecordLength,
            wDetailFilterSegments, filterExpressionCast, OpenExtraSize,
            OpenFlags, rotoID. Refer to the &ldquo;Template Quick
            Reference&rdquo; for information on these.</p>
          </li>

          <li>
            <i>xxxx</i>FilterDelete() deletes the records matching the given
            filter. This employs the dbRemove() database API function, thereby
            deleting multiple records with a single database call.
            <i>xxxx</i>FilterDelete() is capable of handling secondary physical
            tables, as well as detail composites. It is completely compatible
            with subclassing: the subclassor treats its added fields as
            belonging to a secondary table.

            <p>There are, however, some restrictions stemming from the fact
            that dbRemove() operates on only one table:</p>

            <ul>
              <li>To dbRemove() records from secondary tables and detail
              composites, the filter must contain only fields of the primary
              key, and the view must be in the primary key order.</li>

              <li class="tight">To dbRemove() records the filter must contain
              only fields of the primary table.</li>
            </ul>

            <p>The template attempts to remove what it can, but is conservative
            in that it won&rsquo;t remove records it is unsure of, and it
            won&rsquo;t remove anything if there is any potential of
            compromising the database integrity. There is a flags parameter
            that indicates how to handle questionable situations:</p>

            <table border="0" cellpadding="2" cellspacing="0">
              <thead>
                <tr class="grey" align="left">
                  <td class="head">Value&nbsp;</td>

                  <td class="head">Meaning</td>
                </tr>
              </thead>

              <tbody>
                <tr>
                  <td>FILTER_DELETE_STRICT&nbsp;</td>

                  <td>Uses dbRemove if possible, bit if not possible it reports
                  an error.</td>
                </tr>

                <tr class="grey">
                  <td>FILTER_DELETE_TRY&nbsp;</td>

                  <td>Uses dbRemove if possible, perhaps leaving orphan
                  secondary table and detail records. If not possible it
                  reports an error.</td>
                </tr>

                <tr>
                  <td>FILTER_DELETE_SIMULATE&nbsp;</td>

                  <td>Uses dbRemove if possible as above, but if not possible
                  degenerates to a Fetch/Delete loop.</td>
                </tr>
              </tbody>
            </table>

            <p>A number of new conditional features were added to control the
            behaviour of <i>xxxx</i>FilterDelete():</p>

            <ul>
              <li class="tight">Changed MapToDetails() to call MapToDetail(),
              which is now also implemented as a helper function which can be
              overridden.</li>

              <li class="tight">Added DO_OLDMAPTODETAILS to suppress the use of
              viewFilterDelete() when cascading deletion to details, though its
              primary intent is to reactivate the prior semantics of
              MapToDetails(). The new semantics of MapToDetails() make it more
              general and (literally) applicable to the new entrypoints, by
              permitting the use of variable argument lists.</li>

              <li class="tight">Added DO_DELETEFILTERDELETE to activate use of
              viewFilterDelete() when <i>xxxx</i>Delete() cascades to delete
              details. You should usually activate this feature, unless there
              is a compatibility issue, or the changes required to change
              aren&rsquo;t economic in that particular case.</li>
            </ul>

            <p>Other template changes in support of
            <i>xxxx</i>FilterDelete():</p>

            <ul>
              <li>Changed MapToDetail...() et al to take variable arguments, so
              that instead of an <i>xxxxYYY</i> entrypoint, they take a
              VIEW_OP_<i>YYY</i> and the parameters that operation
              requires.</li>

              <li class="tight">Added DeleteBody() and DeleteDetailsBody(),
              both called by <i>xxxx</i>Delete() and
              <i>xxxx</i>FilterDelete().</li>

              <li class="tight">Added fileFilterDelete(), which can also be
              overridden, and is also subject to STUB_VIEW.</li>

              <li class="tight">Extensive use is now made of the
              filterExpr...() family of filter parsing / reconstituting
              functions, not to mention filterReduce(). These are applied to
              the filter string passed into <i>xxxx</i>FilterDelete(), as well
              as to generate filters to cascade to secondary tables and detail
              composites.</li>
            </ul>
          </li>

          <li>
            <i>xxxx</i>TableEmpty() removes all records from the table(s) in
            the most efficient manner possible. It also cascades
            viewTableEmpty() calls to its detail composites. Template changes
            include:

            <ul>
              <li>Added fileEmpty(), which can also be overridden, and is also
              subject to STUB_VIEW.</li>
            </ul>
          </li>

          <li>
            Versioning API. This enables callers to discover what capabilities
            a particular view has. For example, whether
            <i>xxxx</i>InstanceOpen() is available for use. Using this you can
            tailor your behaviour, depending on what the view supports.

            <ul>
              <li>identifyEntry() is analogous to rotoEntry(). In rotoCall()
              terms, identifyEntry() is the action processor. It receives a
              package of operation code and parameters for that operation,
              which it unpacks, invoking the appropriate versioning
              entrypoint.</li>

              <li class="tight"><i>xxxx</i>VersionTemplate() returns the
              version of the template used to implement this view.</li>

              <li class="tight"><i>xxxx</i>VersionAPI() returns the version of
              the system manager API required by this view.</li>

              <li class="tight"><i>xxxx</i>ViewName() returns the
              (language-specific) name of this view. It differs from
              <i>xxxx</i>Name(TITLE_IDX) in that it can return as long a string
              as the caller permits.</li>

              <li class="tight"><i>xxxx</i>ViewTableCount() returns the number
              of physical tables managed.</li>

              <li class="tight"><i>xxxx</i>ViewTables() returns the names of
              the physical tables managed.</li>

              <li class="tight"><i>xxxx</i>ViewModule() returns the HMODULE of
              the implementation DLL.</li>
            </ul>

            <p>In order to permit ROTOVIEW to find identifyEntry(), you must
            export it from your view with an ordinal of 999.</p>
          </li>

          <li>
            To implement the new features perform the following steps for each
            view:

            <ol type="I">
              <li>
                Reinstantiate the view. The MKINST utility will want to
                overwrite the <i>zzzz</i>.C, <i>zzzz</i>2.H, <i>zzzz</i>.DEF,
                <i>zzzz</i>.BAT, <i>zzzz</i>D.BAT and MAKED.BAT files. The
                first 3 are vital, the last 3 are not (and they likely
                won&rsquo;t even have changed). All other template files are
                considered user-modifiable, and will not be overwritten if they
                are found, so don&rsquo;t worry about losing anything. The very
                first time you do this you must also:

                <ul>
                  <li class="tight">Reinstantiate from the CLANG and CPROJECT
                  templates in their respective directories. Actually, the
                  relevant CLANG template changes are in a file considered
                  user-modifiable (e.g. PRERR.RC). For this you might consider
                  doing a visual merge using your own &ldquo;wetware&rdquo;, as
                  there are only a small number of changes.</li>

                  <li class="tight">
                    Change the LOPTS macro definition in your MAKEFILE to the
                    following:
<pre class="tight">
LOPTS = -export:rotoEntry,@1000 -export:identifyEntry,@999
</pre>

                    <p class="tight">This ensures the view API can detect that
                    the views support trans-4.2A APIs. Note that this will
                    apply to all views subsequently compiled, so you should
                    probably just rebuild individual views forcibly (using
                    &ldquo;MAKE -a FOO&rdquo;) until they are all
                    reinstantiated.</p>
                  </li>
                </ul>
              </li>

              <li>If you have overridden the <i>xxxx</i>Open() entrypoint, you
              must move that code to the OpenEtc() function, and define the
              DO_OPENETC symbol. This is vital, as failure to do so can cause
              serious bugs when an <i>xxxx</i>Open() override has significant
              initialization logic. The OpenEtc() callout is called by both
              <i>xxxx</i>Open() and <i>xxxx</i>InstanceOpen(). Make sure to
              remove <i>xxxx</i>Close() calls from the moved code.</li>

              <li>
                Make use of <i>xxxx</i>InstanceOpen():

                <ul>
                  <li class="tight">
                    Define the DO_CMPNAMESTRUCT conditional feature. Doing so
                    requires you to change the content of the cmpNameList[]
                    array, as the CMPNAME typedef changes to a structure.
                    Surround existing composites with {} braces. For any
                    composites that you never update, place
                    INSTANCE_OPEN_READONLY as the second element of the
                    initializer. Note that only demand, implicit and manual
                    composites (those that the view can open implicitly) can be
                    made read-only.

                    <p class="tight">Determining which composites can be made
                    read-only requires that you examine the uses of the
                    composite. Sometimes you must follow the chain down, to
                    that composite&rsquo;s composites. This is because by
                    default when you open a view read-only, it in turn opens
                    its composites are opened read-only. Normally this is good,
                    but occasionally it can interfere. You only need to worry
                    about this if you get runtime errors about not being able
                    to insert/update/delete stuff.</p>
                  </li>

                  <li class="tight">In UIs, for each data source that only
                  needs to be read, activate the data source, go to the
                  &ldquo;Open&rdquo; properties tab, and enable the &ldquo;Use
                  OpenViewInstance&rdquo; check box, and click the
                  &ldquo;Read-only&rdquo; radio button. For lookup cookies,
                  replace the .RegisterLookup calls with
                  .RegisterLookupInstance calls, which lets you specify
                  additional parameters passed to OpenViewInstance.</li>
                </ul>
              </li>

              <li>
                Make use of <i>xxxx</i>FilterDelete() and
                <i>xxxx</i>TableEmpty():

                <ul>
                  <li class="tight">In header views define the
                  DO_DELETEFILTERDELETE conditional feature. This permits
                  <i>xxxx</i>Delete() of a header record to cascade to its
                  details as viewFilterDelete() calls. You need to be careful
                  about detail side-effects. A technique occasionally used is
                  to have deletion of the details effect some operation on
                  views other than the header, commonly implemented in a
                  revPostEtc() or PrePostEtc() callout. If this is the case,
                  either recode the operation (unknown complexity), or
                  <b><i>don&rsquo;t</i></b> define the DO_DELETEFILTERDELETE
                  conditional feature.</li>

                  <li class="tight">Examine any purging-style operations,
                  commonly located in superviews. If it consists of a simple
                  browse/fetch/delete loop, it is a good candidate for
                  viewFilterDelete(). If there is more complex logic involved,
                  you&rsquo;ll have to analyze it, because you can often still
                  make use of viewFilterDelete().</li>

                  <li class="tight">Don&rsquo;t forget about
                  <i>xxxx</i>TableEmpty(), which empties the entire contents of
                  the view (and cascades to details too). This method can be
                  faster than <i>xxxx</i>FilterDelete() on some databases, and
                  will always be faster than dropping and recreating the
                  tables.</li>
                </ul>
              </li>

              <li>Undefine A4W_API_VERSION, as it is needed only to retain
              compatibility with older SM versions, which we don&rsquo;t need.
              If it appears in a reinstantiated view the compile will, in fact,
              kick out with an error, so it&rsquo;s hard to miss.</li>

              <li>An area that sometimes presents problems is superviews that
              mimic data views, instead of being pure business logic. The main
              issue is that of extending the data view mimicry to the new
              entrypoints. A superview generally has no logic for most of the
              standard entrypoints, where as data views do have basic logic for
              all standard entrypoints.</li>
            </ol>
          </li>
        </ol>
      </li>

      <li>
        New Callouts, Overrides and Conditional Features

        <ol type="A">
          <li>Implemented EntryStatePush() and EntryStatePop(), which the
          template uses to save and restore members of V (the view handle) that
          aren&rsquo;t naturally reentrant. If you want to make anything else
          reentrant (especially anything you add to VEXTRA), you can define
          DO_ENTRYSTATEEXTRA, and fill in the ENTRYSTATEEXTRA structure. You
          will likely also want to override EntryStatePush() with
          DO_ENTRYSTATEPUSH (original function being EntryStatePushBase()), and
          EntryStatePop() with DO_ENTRYSTATEPOP (original function being
          EntryStatePopBase()).</li>

          <li>
            Implemented new file stub routines. Some are in aid of the new view
            entrypoints, others in aid of security, other in aid of explicit
            transaction control. All can be overridden by the usual mechanism,
            and are also subject to STUB_VIEW.

            <ul>
              <li>fileDriverInfo()</li>

              <li class="tight">fileLinkFlags()</li>

              <li class="tight">fileTransBegin()</li>

              <li class="tight">fileTransCommit()</li>

              <li class="tight">fileTransRollback()</li>
            </ul>
          </li>
        </ol>
      </li>

      <li>
        Miscellaneous Changes

        <ol type="A">
          <li>Changed uses of _fmem* and _fstr* functions to their API
          equivalents.</li>

          <li>Backed off of the automatic activating of DO_PUTETC upon
          DO_SAFEPUTETC.</li>

          <li>Put back in the automatic activating of DO_PROCESSETC upon
          SUPER_VIEW, but put in a warning message.</li>

          <li>Made the TypeOperations[] array and constituent structures
          public; they are now used more widely, not just in
          ApplyHeaderDelta().</li>

          <li>Added ReportString() function to send debug output to RVSPY and
          debug monitor.</li>

          <li>Added a V.rotoID member, to facilitate access some APIs requiring
          that value as a long. It constructs it from <i>zzzz</i>_ROTOID, which
          may be problematic if a view programmer removed or altered that
          definition. In the past <i>zzzz</i>_ROTOID wasn&rsquo;t used by the
          template. In its absence the template sets V.rotoID to 0 and issues a
          compile-time message.</li>
        </ol>
      </li>
    </ol>
    <!-- ================================================================== -->

    <h2 class="overhead"><a id="98-SEP-17" name="98-SEP-17">Since 98-SEP-17,
    released in SDK 4.1A</a></h2>

    <ol>
      <li>
        Fixes

        <ol type="A">
          <li>Fixed a number of function return sequences to cleanup properly
          when the return is initiated by an error.</li>

          <li>Fixed <i>xxxx</i>Create() entrypoint to report DBS_TABLE_EXISTS
          instead of DBS_TABLE_NOT_EXISTS.</li>

          <li>Corrected <i>xxxx</i>Put() to blank-pad string fields
          consistently.</li>

          <li>Fixed V.recordTemp[] subscripting in a number of places. In some
          cases 0 was specified, and has been replaced by BASE_TBL_COUNT, which
          is compatible with subclassing. In another case multi-table
          revisioned views were copying the primary key from the wrong
          buffer.</li>

          <li>Corrected uses of MapToInternalComposite().</li>

          <li>Fixed InitFields() to not initialize header fields with presents
          lists.</li>

          <li>Corrected table[] array subscript usage, especially regarding
          loop terminate and error conditions.</li>
        </ol>
      </li>

      <li>
        HeaderEtc() Changes

        <ol type="A">
          <li>Added ReverseHeaderFields(), which is called to rollback
          ApplyHeaderFields(). This is needed when <i>xxxx</i>Insert(),
          <i>xxxx</i>Update() and <i>xxxx</i>Delete() entrypoints fail after
          the ApplyHeaderFields() was called successfully.</li>

          <li>Added overrides on ApplyHeaderFields(), ReverseHeaderFields() and
          SaveHeaderFields(). The symbols to define in <i>zzzz</i>1.H are
          DO_APPLYHEADERFIELDS, DO_REVERSEHEADERFIELDS and DO_SAVEHEADERFIELDS,
          respectively.</li>

          <li>Moved ApplyHeaderFields() usage to immediately prior to
          fileCommit() invocations in the <i>xxxx</i>Insert(),
          <i>xxxx</i>Update() and <i>xxxx</i>Delete() entrypoints.</li>

          <li>Implemented ApplyHeaderDelta() as a universal HeaderEtc() helper
          function. That is, if you have setup all your headerFields[] mappings
          as straight summations, you may be able to replace your code inside
          HeaderEtc() with a call to ApplyHeaderDelta(). There is a new
          supporting data type, TYPEOPERATIONS, which is a tuple of pointers to
          functions that perform certain operations for a particular data type.
          The operations are: compare to zero, add, and subtract. There is also
          a new initialized structure, TypeOperations[], which is an array of
          TYPEOPERATIONS instances.</li>
        </ol>
      </li>

      <li>
        New Callouts, Overrides and Conditional Features

        <ol type="A">
          <li>Implemented DO_SAFEPUTETC conditional feature. It implicitly
          activates DO_PUTETC. It shares the functionality of DO_PUTSAVECURRENT
          in order to save a copy of the original record, so that if PutEtc()
          fails the original record contents will be restored. This feature
          also reorders the sequence of PutEtc() / PutCmpField() to
          PutCmpField() / PutEtc().</li>

          <li>Implemented DO_SUPPRESSDUPLICATE, which suppresses reporting an
          error to the user when inserting a duplicate key. This applies to any
          key that does not permit duplicates, not just the primary key. It
          also applies when updating a record.</li>

          <li>Implemented DO_TRANSLEVELCHECK conditional feature. When defined
          the template checks whether a transaction is presently active. If not
          active, processing (including calling the transaction API) continues
          as before. If a transaction is active,&nbsp; transaction calls are
          skipped and the template assumes the you are managing the transaction
          completely. DO_SUPPRESSDUPLICATE shares part of
          DO_TRANSLEVELCHECK&rsquo;s functionality.</li>
        </ol>
      </li>

      <li>
        Miscellaneous Changes

        <ol type="A">
          <li>Removed the automatic activation of DO_PROCESSETC upon SUPER_VIEW
          being defined.</li>

          <li>Removed the automatic activation of DO_RECORDREAD upon
          DO_CONCURRENCYETC being defined. The prior two items were done
          because the initiating conditional merely implies the presence of the
          subsequent conditional&rsquo;s functionality. It decouples the
          implementation so there aren&rsquo;t nasty maintenance issues.</li>

          <li>Added type casts to eliminate 16-bit compiler warnings</li>

          <li>Changed LPSTR to LPVOID in ValidateField() and
          ValidateKeyField()</li>

          <li>Changed OrderBody() to return an ERRNUM and to re-optimize the
          filter</li>

          <li>Added bBrowseEnded to V. It deals with record position when Fetch
          has hit EOF</li>

          <li>Changed <i>xxxx</i>Fetch() and <i>xxxx</i>Read() entrypoints to
          issue viewCancel on details only when they are revisioned. I.e. Batch
          no longer cancels its headers</li>

          <li>Changed SecurityPermissions() to be fully permissive if security
          is disabled, or if global access is in effect. Also changed so that
          if your view is revisioned, and if ADD, MODIFY or DELETE access has
          been granted, then POST access is granted automatically.</li>

          <li>In ACCPAC.MAK, added BMPPATH and its use in RESSRCH. Changed
          .RC.RES command block to NOT filter out pragmas in 32-bit</li>

          <li>Widened the basis of what is a potential conflict when
          DO_CONCURRENCYETC is defined. Instead of (You &amp;&amp; I) it is now
          just You. This plugs a hole that allowed some some conflicting
          situations to be ignored. It is conservative with regard to
          protecting database integrity, meaning that if your view is not
          changed to take it into account it may come up with DBS_CONFLICT
          where before it didn&rsquo;t.</li>

          <li>Changed MergeConflictedRecords() to report errors without
          artificially forcing an error condition on dbLock().</li>
        </ol>
      </li>
    </ol>
    <!-- ================================================================== -->

    <h2 class="overhead"><a id="98-MAR-11" name="98-MAR-11">Since 98-MAR-11,
    released in SDK 4.0A</a></h2>

    <ol>
      <li>
        Fixes

        <ol type="A">
          <li>
            <i>xxxx</i>Fetch() fixes

            <ul>
              <li class="tight">Fixed a nasty: multiple ranges weren&rsquo;t
              handled properly. Only the first range was processed, the
              remainder were ignored.</li>

              <li class="tight">Removed the processing of filter segments for
              non-detail views that use revision lists</li>
            </ul>
          </li>

          <li>
            <i>xxxx</i>Put() changes and fixes

            <ul>
              <li class="tight">Reinstated NULL-termination handling for
              strings in <i>xxxx</i>Put()</li>

              <li class="tight">Fixed the buffer handling of <i>xxxx</i>Get()
              and <i>xxxx</i>Put(), to not exceed the field size
              specified.</li>

              <li class="tight">Added BCD checking for all BCD-based types via
              ValidateData()</li>
            </ul>
          </li>

          <li>
            Several fixes have been made in support of subclassing views:

            <ul>
              <li class="tight">reduction of browse filter</li>

              <li class="tight"><i>xxxx</i>Key() implementation</li>

              <li class="tight">fileInfo() implementation</li>
            </ul>
          </li>

          <li>Fixed deletion in the presence of passive concurrency when an
          &ldquo;invalid position&rdquo; error is returned.</li>

          <li>Fixed optimistic concurrency; errors were being sent back when
          not intended</li>

          <li>Fixed the handling of 0 physical tables, especially in connection
          with superviews.</li>
        </ol>
      </li>

      <li>
        Error Handling

        <ol type="A">
          <li>Changed the terminology of pedantic errors to extended errors.
          The #define has also changed to DO_EXTENDEDERRORS from
          DO_PEDANTICERRORS, and any template functions having the substring
          &ldquo;Pedantic&rdquo; have also changed to
          &ldquo;Extended&rdquo;.</li>

          <li>
            <p>Added a more basic sense to DO_EXTENDEDERRORS, plus symbolic
            constants.</p>

            <table border="0" cellpadding="2" cellspacing="0">
              <thead>
                <tr class="grey" align="left">
                  <td class="head">Symbol&nbsp;</td>

                  <td class="head">Value&nbsp;</td>

                  <td class="head">Meaning</td>
                </tr>
              </thead>

              <tbody>
                <tr>
                  <td>NO_EXTENDEDERRORS&nbsp;</td>

                  <td align="center">0&nbsp;</td>

                  <td>The default. Only the <i>zzzz</i>.C non-modifiable file
                  interprets and processes extended errors. The template still
                  returns old errors to the external caller.</td>
                </tr>

                <tr class="grey">
                  <td>PROCESS_EXTENDEDERRORS&nbsp;</td>

                  <td align="center">1&nbsp;</td>

                  <td>Your callout code (in <i>zzzz</i>1.C) interprets and
                  processes extended errors</td>
                </tr>

                <tr>
                  <td>RETURN_EXTENDEDERRORS&nbsp;</td>

                  <td align="center">2&nbsp;</td>

                  <td>All callers to your view interpret and process extended
                  errors, so the view returns them. Since your view might call
                  other views that do not interpret and process extended
                  errors, the template still translates old error to extended
                  errors.</td>
                </tr>

                <tr class="grey">
                  <td>UNIVERSAL_EXTENDEDERRORS&nbsp;</td>

                  <td align="center">3&nbsp;</td>

                  <td>All applications and system facilities interpret and
                  process extended errors. This is the ultimate goal, since it
                  does not translate any errors</td>
                </tr>
              </tbody>
            </table>
          </li>

          <li>
            Enriched the translation of error codes between the old set and the
            extended set. This was especially needed for callouts to your
            <i>zzzz</i>1.C code, and for calls to other views.

            <ul>
              <li>Changed ErrorMapExtendedToOld() to pass back extended error
              codes when they are not part of the old documented set. Errors
              which fall into the old documented set, as well as ERRNUM_GENERAL
              and ERRNUM_WARNING, get translated to the old set.</li>

              <li class="tight">An additional set of view routines are used
              with the prefix <i>xxxx</i>ExtendedBase<i>YYY</i>. They are
              actual implementation of the view entrypoints. Silly preprocessor
              tricks are used to alias those names to <i>xxxxYYY</i> and/or
              <i>xxxx</i>Base<i>YYY</i>.</li>

              <li class="tight">Added a new set of view calling stubs:
              viewOld<i>XXX</i>. These facilitate the mapping of extended
              errors to old errors. The modifiable .C files use this when
              NO_EXTENDEDERRORS is defined. The non-modifiable file(s) do not
              use this.</li>

              <li class="tight">Implemented an extra level of stub calls to the
              view...() routines. This lets both modifiable and non- code
              ignore these extended error translations</li>
            </ul>
          </li>

          <li>Added dbError(), analogous to revError(). fileError() calls it by
          default. The revError(), filterError() and dbError() function
          implementation may now remain in <i>zzzz</i>.C instead of having to
          be reimplemented in <i>zzzz1</i>.C when STUB_VIEW is in effect.</li>

          <li>The ERRNUM domain has been segregated. Any negative value is a
          warning. All places that deal with ERRNUMs have changed to allow
          warnings to be returned as success. Additionally, there is now a
          DB_ERRNUM type to hold database API error values, and a FL_ERRNUM
          type to hold filter API error values, instead of using ERRNUM in all
          these cases.</li>

          <li>
            Macros have been added in support of detection and management of
            extended error codes:

            <ul>
              <li>MaxError() accumulates the error result from the execution of
              a function call. Warnings take precedence over success, and
              errors take precedence over warnings. It looks and acts like a
              void function. Since it is a macro, however, if you use it as the
              only statement in a control structure enclose it in a { block
              }.</li>

              <li class="tight">ERRNUM_IS_SUCCESS() returns a boolean as to
              whether an ERRNUM value is success or a warning</li>

              <li class="tight">ERRNUM_IS_FAILURE() returns a boolean as to
              whether an ERRNUM value is an error</li>

              <li class="tight">ERRNUM_IS_FAULTLESS() returns a boolean as to
              whether an ERRNUM value is neither a warning nor an error</li>
            </ul>

            <p>There are also equivalents of the above four macros for
            DB_ERRNUM (MaxDatabaseError, DB_ERRNUM_IS_SUCCESS,
            DB_ERRNUM_IS_FAILURE, DB_ERRNUM_IS_FAULTLESS), and FL_ERRNUM
            (FL_ERRNUM_IS_SUCCESS, FL_ERRNUM_IS_FAILURE,
            FL_ERRNUM_IS_FAULTLESS, but no equivalent for MaxError).</p>
          </li>
        </ol>
      </li>

      <li>
        New callouts, overrides and conditional features

        <ol type="A">
          <li>Added the ability to override individual file<i>XXX</i> routines.
          Define DO_file<i>XXX</i> to override file<i>XXX</i>. The original
          behaviour is in file<i>XXX</i>Base</li>

          <li>Added A4W_API_VERSION feature. Use it to declare the minimum
          version of SM this view needs to run. It defaults to the current SDK
          version (for example 0x40A), and you should leave it as default
          unless you specifically need to support an older SM. Future releases
          of the CVIEW template may impose API version requirements
          incompatible with A4W_API_VERSION.</li>

          <li>Removed the DO_INLINEHELPERS conditional feature, so that the
          multitude of Find<i>XXX</i> dereferencing helper functions are
          expanded inline by default. If you really want these to be
          out-of-line once again, define the DO_HELPERSOUTOFLINE conditional
          feature.</li>

          <li>Added MapToNewFieldIndex() and MapToInternalComposite() macros,
          to facilitate the addition of fields and compositions that would
          otherwise cause renumbering of these entities. These default to
          identity functions (that is, they return what they are passed). To
          redefine them, make a #define DoMapToNewFieldIndex or
          DoMapToInternalComposite in your <i>zzzz</i>1.H file.</li>

          <li>
            <p>Added ValidateData() to validate the content of BCD-encoded
            fields, reporting and returning an error if invalid. It is called
            by <i>xxxx</i>Put() and xxxVerify(). If a field hasn&rsquo;t
            changed then xxxVerify() won&rsquo;t call ValidateData(),
            regardless of other all other conditions. You can define
            VALIDATE_DATA to determine how strictly it checks:</p>

            <table border="0" cellpadding="2" cellspacing="0">
              <thead>
                <tr class="grey" align="left">
                  <td class="head">Value&nbsp;</td>

                  <td class="head">Meaning</td>
                </tr>
              </thead>

              <tbody>
                <tr>
                  <td>VALIDATE_NO_DATA&nbsp;</td>

                  <td>No validation</td>
                </tr>

                <tr class="grey">
                  <td>VALIDATE_BCD_DATA&nbsp;</td>

                  <td>Contents are checked for conformity to the BCD
                  representation. This is the default.</td>
                </tr>

                <tr>
                  <td>VALIDATE_DATETIME_DATA&nbsp;</td>

                  <td>Contents are further checked for conformity to date or
                  time domain constraints.</td>
                </tr>
              </tbody>
            </table>
          </li>
        </ol>
      </li>

      <li>
        Miscellaneous Changes

        <ol type="A">
          <li>Generalized SUPER_VIEW conditional inclusions, such that
          file<i>XXX</i> routines are now available, and such that subclassing
          superviews works!</li>

          <li>Added BrowseBody() to allow <i>xxxx</i>Open() to share the browse
          state initialization used by <i>xxxx</i>Browse().</li>

          <li>Removed <i>xxxxYYY</i> exports (of the view entrypoints) from
          <i>zzzz</i>.DEF. The template source code and the compile options in
          ACCPAC.MAK ensure that callbacks work.</li>

          <li>Broke up <i>xxxx</i>Compose() to enhance maintenance.
          CompositeCategory() returns an enumeration of a composite&rsquo;s
          category. ComposeHeader(), ComposeDetail(), ComposeHierarchical() and
          ComposeDemand() are called appropriately by <i>xxxx</i>Compose()
          based on the result of CompositeCategory().</li>

          <li>Changed the use of ApplyHeaderFields() to now heed error returns,
          and fail the operation in progress. As well, any changes that had
          already been applied will be rolled back.</li>

          <li>Removed passive concurrency feature from revisioned views.</li>

          <li>Simplified the .DEP target in the makefile to handle cases where
          <i>zzzz</i>!=<i>tttt</i> automatically.</li>
        </ol>
      </li>
    </ol>
    <!-- ================================================================== -->

    <h2 class="overhead"><a id="97-OCT-20" name="97-OCT-20">Since
    97-OCT-20</a></h2>

    <ol>
      <li>
        Changes and Fixes

        <ol type="A">
          <li>The use of the NOCMP_IDX sentinel in the cmpFields[][] array has
          been discontinued. Field values of 0L are now used, since that value
          is already defined to be reserved and invalid.</li>

          <li>The ability to define fake keys, which are based on fields not in
          the physical table, has been fully implemented. Actually, any key
          which has segments that are in calculated record(s) must be
          designated as a fake key. The implication is that the superviews may
          now have keys.</li>

          <li>The <i>xxxx</i>Get(), <i>xxxx</i>Put(), <i>xxxx</i>BlkGet() and
          <i>xxxx</i>BlkPut() routines have been changed so that they are more
          forgiving of incorrect field sizes passed in. For example, when
          <i>xxxx</i>Get() is invoked to retrieve a DBSINT but the field size
          indicated is 4 bytes all 4 bytes will be initialized with the
          semantically equal value.</li>
        </ol>
      </li>

      <li>
        Makefiles

        <ol type="A">
          <li>The default way .TBL files are handled has changed. Rather than
          <i>tttt</i>*.GEN depending on <i>tttt</i>.TBL, <i>zzzz</i>.DEP
          depends <i>tttt</i>.TBL. When the table specification file gets
          rebuilt, the <i>zzzz</i>.DEP sentinel also gets touched. This new
          behaviour is coded in ACCPAC.MAK.</li>

          <li>
            A new file ACCPAC.MAK has been added to the SDK header files. This
            is a makefile inclusion which accepts a number of macros you
            supply, and defines a number of macros, inference rules and
            implicit command blocks. These allow you to simplify your makefiles
            substantially.

            <p>The macros you supply are:</p>

            <table border="0" cellpadding="2" cellspacing="0">
              <thead>
                <tr class="grey" align="left">
                  <td class="head">Macro&nbsp;</td>

                  <td class="head">Purpose&nbsp;</td>

                  <td class="head">Default</td>
                </tr>
              </thead>

              <tbody>
                <tr>
                  <td>ACCPAC_WIN32&nbsp;</td>

                  <td>targeted for Win32&nbsp;</td>

                  <td>(16-bit)</td>
                </tr>

                <tr class="grey">
                  <td>PROJPATH&nbsp;</td>

                  <td>root of the project directories&nbsp;</td>

                  <td>..\..</td>
                </tr>

                <tr>
                  <td>BUILDBRANCH&nbsp;</td>

                  <td>subdirectory to all build binaries&nbsp;</td>

                  <td>BUILD16, BUILD32</td>
                </tr>

                <tr class="grey">
                  <td>BUILDPATH&nbsp;</td>

                  <td>full path to all build binaries&nbsp;</td>

                  <td>$(PROJPATH)\$(BUILDBRANCH)</td>
                </tr>

                <tr>
                  <td>RESBRANCH&nbsp;</td>

                  <td>subdirectory to resource binaries&nbsp;</td>

                  <td>ENG</td>
                </tr>

                <tr class="grey">
                  <td>BINPATH&nbsp;</td>

                  <td>location of helper executeables&nbsp;</td>

                  <td>$(BUILDPATH)\BIN</td>
                </tr>

                <tr>
                  <td>INCPATH&nbsp;</td>

                  <td>location for inclusions&nbsp;</td>

                  <td>$(BUILDPATH)\INCLUDE</td>
                </tr>

                <tr class="grey">
                  <td>GENPATH&nbsp;</td>

                  <td>location for GENTABLE inclusions&nbsp;</td>

                  <td>$(BUILDPATH)\GEN</td>
                </tr>

                <tr>
                  <td>OBJPATH&nbsp;</td>

                  <td>location for compilers&rsquo; results&nbsp;</td>

                  <td>$(BUILDPATH)\OBJ</td>
                </tr>

                <tr class="grey">
                  <td>CODPATH&nbsp;</td>

                  <td>location for .COD files&nbsp;</td>

                  <td>$(BUILDPATH)\CODMAP</td>
                </tr>

                <tr>
                  <td>MAPPATH&nbsp;</td>

                  <td>location for .MAP files&nbsp;</td>

                  <td>$(BUILDPATH)\CODMAP</td>
                </tr>

                <tr class="grey">
                  <td>RLZPATH&nbsp;</td>

                  <td>location for Realizer inclusions&nbsp;</td>

                  <td>$(BUILDPATH)\RLZINCL</td>
                </tr>

                <tr>
                  <td>RUNPATH&nbsp;</td>

                  <td>location for binary executeable image&nbsp;</td>

                  <td>$(BUILDPATH)\RUNTIME</td>
                </tr>

                <tr class="grey">
                  <td>RESPATH&nbsp;</td>

                  <td>location for binary resource image&nbsp;</td>

                  <td>$(RUNPATH)\$(RESBRANCH)</td>
                </tr>

                <tr>
                  <td>RESSRCH&nbsp;</td>

                  <td>extra resource inclusions to search&nbsp;</td>

                  <td>&nbsp;</td>
                </tr>

                <tr class="grey">
                  <td>INCSRCH&nbsp;</td>

                  <td>extra inclusions to search&nbsp;</td>

                  <td>&nbsp;</td>
                </tr>

                <tr>
                  <td>LIBLIST&nbsp;</td>

                  <td>extra libraries to link in&nbsp;</td>

                  <td>&nbsp;</td>
                </tr>

                <tr class="grey">
                  <td>OBJLIST&nbsp;</td>

                  <td>extra objects to link in&nbsp;</td>

                  <td>&nbsp;</td>
                </tr>

                <tr>
                  <td>TBINPATH&nbsp;</td>

                  <td>location of tool executeables&nbsp;</td>

                  <td>$(BUILDPATH)\TBIN</td>
                </tr>

                <tr class="grey">
                  <td>TOBJPATH&nbsp;</td>

                  <td>location for compilers&rsquo; tool results&nbsp;</td>

                  <td>$(BUILDPATH)\TOBJ</td>
                </tr>

                <tr>
                  <td>TCODPATH&nbsp;</td>

                  <td>location for tool .COD files&nbsp;</td>

                  <td>$(BUILDPATH)\TOBJ</td>
                </tr>

                <tr class="grey">
                  <td>TMAPPATH&nbsp;</td>

                  <td>location for tool .MAP files&nbsp;</td>

                  <td>$(BUILDPATH)\TOBJ</td>
                </tr>

                <tr>
                  <td>TLIBLIST&nbsp;</td>

                  <td>extra libraries to link in to tools&nbsp;</td>

                  <td>&nbsp;</td>
                </tr>

                <tr class="grey">
                  <td>TOBJLIST&nbsp;</td>

                  <td>extra objects to link in to tools&nbsp;</td>

                  <td>&nbsp;</td>
                </tr>

                <tr>
                  <td>COPTS&nbsp;</td>

                  <td>extra C compiler options&nbsp;</td>

                  <td>&nbsp;</td>
                </tr>

                <tr class="grey">
                  <td>COPTS&nbsp;</td>

                  <td>extra preprocessor options&nbsp;</td>

                  <td>&nbsp;</td>
                </tr>

                <tr>
                  <td>ROPTS&nbsp;</td>

                  <td>extra resource compiler options&nbsp;</td>

                  <td>&nbsp;</td>
                </tr>

                <tr class="grey">
                  <td>AOPTS&nbsp;</td>

                  <td>extra assembler options&nbsp;</td>

                  <td>&nbsp;</td>
                </tr>

                <tr>
                  <td>LOPTS&nbsp;</td>

                  <td>extra linker options&nbsp;</td>

                  <td>&nbsp;</td>
                </tr>

                <tr class="grey">
                  <td>DESCRIPTION&nbsp;</td>

                  <td>module description string&nbsp;</td>

                  <td>&nbsp;</td>
                </tr>

                <tr>
                  <td>WIN16_MODEL&nbsp;</td>

                  <td>memory model to use under 16-bit&nbsp;</td>

                  <td>S (small)</td>
                </tr>
              </tbody>
            </table>

            <p>The implicit commands that are applied, along with the inference
            rules, are:</p>

            <table border="0" cellpadding="2" cellspacing="0">
              <thead>
                <tr class="grey">
                  <td class="head" colspan="2">Target&nbsp;</td>

                  <td class="head" colspan="2">Source&nbsp;</td>

                  <td class="head" rowspan="2">&nbsp;</td>

                  <td class="head" rowspan="2" align="left">Action</td>
                </tr>

                <tr class="grey" align="left">
                  <td class="subhead">Directory&nbsp;</td>

                  <td class="subhead">Ext&nbsp;&nbsp;</td>

                  <td class="subhead">Directory&nbsp;</td>

                  <td class="subhead">Ext&nbsp;</td>
                </tr>
              </thead>

              <tbody>
                <tr>
                  <td>RESPATH&nbsp;</td>

                  <td>DAT&nbsp;&nbsp;</td>

                  <td>.&nbsp;</td>

                  <td>TXT&nbsp;</td>

                  <td>&nbsp;</td>

                  <td>compile group resources</td>
                </tr>

                <tr class="grey">
                  <td>RESPATH&nbsp;</td>

                  <td>RET&nbsp;&nbsp;</td>

                  <td>.&nbsp;</td>

                  <td>RUN&nbsp;</td>

                  <td>&nbsp;</td>

                  <td>lock CA-RET report to target</td>
                </tr>

                <tr>
                  <td>RESPATH&nbsp;</td>

                  <td>RET&nbsp;&nbsp;</td>

                  <td>.&nbsp;</td>

                  <td>RET&nbsp;</td>

                  <td>&nbsp;</td>

                  <td>copy CA-RET report to target</td>
                </tr>

                <tr class="grey">
                  <td>RESPATH&nbsp;</td>

                  <td>RET&nbsp;&nbsp;</td>

                  <td>.&nbsp;</td>

                  <td>RLK&nbsp;</td>

                  <td>&nbsp;</td>

                  <td>copy locked CA-RET report to target</td>
                </tr>

                <tr>
                  <td>RESPATH&nbsp;</td>

                  <td>RPT&nbsp;&nbsp;</td>

                  <td>.&nbsp;</td>

                  <td>RPT&nbsp;</td>

                  <td>&nbsp;</td>

                  <td>copy Crystal report to target</td>
                </tr>

                <tr class="grey">
                  <td>RUNPATH&nbsp;</td>

                  <td>DAT&nbsp;&nbsp;</td>

                  <td>.&nbsp;</td>

                  <td>TXT&nbsp;</td>

                  <td>&nbsp;</td>

                  <td>compile roto resources</td>
                </tr>

                <tr>
                  <td>RUNPATH&nbsp;</td>

                  <td>RSC&nbsp;&nbsp;</td>

                  <td>.&nbsp;</td>

                  <td>TXT&nbsp;</td>

                  <td>&nbsp;</td>

                  <td>compile security resources</td>
                </tr>

                <tr class="grey">
                  <td>RUNPATH&nbsp;</td>

                  <td>INI&nbsp;&nbsp;</td>

                  <td>.&nbsp;</td>

                  <td>INI&nbsp;</td>

                  <td>&nbsp;</td>

                  <td>copy to target</td>
                </tr>

                <tr>
                  <td>INCPATH&nbsp;</td>

                  <td>H&nbsp;&nbsp;</td>

                  <td>.&nbsp;</td>

                  <td>H&nbsp;</td>

                  <td>&nbsp;</td>

                  <td>copy to target</td>
                </tr>

                <tr class="grey">
                  <td>INCPATH&nbsp;</td>

                  <td>I&nbsp;&nbsp;</td>

                  <td>.&nbsp;</td>

                  <td>I&nbsp;</td>

                  <td>&nbsp;</td>

                  <td>copy to target</td>
                </tr>

                <tr>
                  <td>RLZPATH&nbsp;</td>

                  <td>RLZ&nbsp;&nbsp;</td>

                  <td>.&nbsp;</td>

                  <td>RLZ&nbsp;</td>

                  <td>&nbsp;</td>

                  <td>copy to target</td>
                </tr>

                <tr class="grey">
                  <td>GENPATH&nbsp;</td>

                  <td>DEP&nbsp;&nbsp;</td>

                  <td>.&nbsp;</td>

                  <td>TBL&nbsp;</td>

                  <td>&nbsp;</td>

                  <td>generate database table information</td>
                </tr>

                <tr>
                  <td>OBJPATH&nbsp;</td>

                  <td>OBJ&nbsp;&nbsp;</td>

                  <td>.&nbsp;</td>

                  <td>C&nbsp;</td>

                  <td>&nbsp;</td>

                  <td>compile C source</td>
                </tr>

                <tr class="grey">
                  <td>TOBJPATH&nbsp;</td>

                  <td>OBJ&nbsp;&nbsp;</td>

                  <td>.&nbsp;</td>

                  <td>C&nbsp;</td>

                  <td>&nbsp;</td>

                  <td>compile tool C source</td>
                </tr>

                <tr>
                  <td>TBINPATH&nbsp;</td>

                  <td>EXE&nbsp;&nbsp;</td>

                  <td>.&nbsp;</td>

                  <td>C&nbsp;</td>

                  <td>&nbsp;</td>

                  <td>compile and link tool C source</td>
                </tr>

                <tr class="grey">
                  <td>OBJPATH&nbsp;</td>

                  <td>PCH&nbsp;&nbsp;</td>

                  <td>.&nbsp;</td>

                  <td>C&nbsp;</td>

                  <td>&nbsp;</td>

                  <td>generate precompiled headers</td>
                </tr>

                <tr>
                  <td>OBJPATH&nbsp;</td>

                  <td>OBJ&nbsp;&nbsp;</td>

                  <td>.&nbsp;</td>

                  <td>ASM&nbsp;</td>

                  <td>&nbsp;</td>

                  <td>compile assembler source</td>
                </tr>

                <tr class="grey">
                  <td>OBJPATH&nbsp;</td>

                  <td>RES&nbsp;&nbsp;</td>

                  <td>.&nbsp;</td>

                  <td>RC&nbsp;</td>

                  <td>&nbsp;</td>

                  <td>compile language resources</td>
                </tr>

                <tr>
                  <td>RESPATH&nbsp;</td>

                  <td>DLL&nbsp;&nbsp;</td>

                  <td>OBJPATH&nbsp;</td>

                  <td>RES&nbsp;</td>

                  <td>&nbsp;</td>

                  <td>link resource-only library</td>
                </tr>

                <tr class="grey">
                  <td>RUNPATH&nbsp;</td>

                  <td>DLL&nbsp;&nbsp;</td>

                  <td>OBJPATH&nbsp;</td>

                  <td>RES&nbsp;</td>

                  <td>&nbsp;</td>

                  <td>link resource-only library</td>
                </tr>

                <tr>
                  <td>RUNPATH&nbsp;</td>

                  <td>DLL&nbsp;&nbsp;</td>

                  <td>OBJPATH&nbsp;</td>

                  <td>OBJ&nbsp;</td>

                  <td>&nbsp;</td>

                  <td>link code-only library</td>
                </tr>

                <tr class="grey">
                  <td>RUNPATH&nbsp;</td>

                  <td>EXE&nbsp;&nbsp;</td>

                  <td>OBJPATH&nbsp;</td>

                  <td>RES&nbsp;</td>

                  <td>&nbsp;</td>

                  <td>link application with resources</td>
                </tr>

                <tr>
                  <td>RUNPATH&nbsp;</td>

                  <td>EXE&nbsp;&nbsp;</td>

                  <td>OBJPATH&nbsp;</td>

                  <td>OBJ&nbsp;</td>

                  <td>&nbsp;</td>

                  <td>link application without resources</td>
                </tr>

                <tr class="grey">
                  <td>OBJPATH&nbsp;</td>

                  <td>LIB&nbsp;&nbsp;</td>

                  <td>.&nbsp;</td>

                  <td>DEF&nbsp;</td>

                  <td>&nbsp;</td>

                  <td>create static link library</td>
                </tr>

                <tr>
                  <td>TBINPATH&nbsp;</td>

                  <td>EXE&nbsp;&nbsp;</td>

                  <td>TOBJPATH&nbsp;</td>

                  <td>OBJ&nbsp;</td>

                  <td>&nbsp;</td>

                  <td>link tool executable</td>
                </tr>
              </tbody>
            </table>

            <p>It is important to realize that one of the biggest benefits of
            incorporating the use of the new ACCPAC.MAK is that with just a
            single set of sources you can build both 16-bit and 32-bit targets.
            To retrofit your existing applications the simplest approach may be
            to recreate them. You must bring your view sources into a single
            location, delete your existing makefiles and let MKINST recreate
            them. For each view, add to MAKEFILE a dependency on the view, and
            a dependency on the view&rsquo;s inclusions. Finally, insert a line
            including the view&rsquo;s makefile.</p>

            <p>If you have not edited your makefiles in the past you
            won&rsquo;t need to with the new ones. If you have created extra
            headers (not from the template) which some of your views depend on
            you will need to add those dependencies back in. Similarly, if you
            have created extra C sources (not from the template) which are
            compiled and linked with some of your views you will need to add
            those targets and dependencies back in.</p>

            <p>Note that almost all the command blocks are implicit. That is,
            you shouldn&rsquo;t need to specify your own commands anymore. If
            you have irregular dependency lines you may need to resort to
            explicit command blocks. However, If you have added your own file
            types, procedures and tools you can encode them so that they are
            get applied implicitly too. Simply add your own suffixes and
            inference rules after the inclusion of ACCPAC.MAK.</p>

            <p>Retrofitting your language resources is largely similar to the
            above procedure.</p>
          </li>
        </ol>
      </li>

      <li>
        GENTABLE

        <ol type="A">
          <li>The <i>zzzz</i>_IDX() and <i>zzzz</i>_SIZ() macros which have
          been defined in <i>zzzz</i>.H are now generated automatically, which
          ensures their correctness. The macro definitions in <i>zzzz</i>.H
          need to be removed as a result.</li>

          <li>Further support for use of the C preprocessor has been added by
          the recognition of #line. This allows accurate reporting of the locus
          of errors.</li>

          <li>The command line rules have been relaxed. GENTABLE now accepts a
          list of bare table names, and defaults the view name to be the same
          as the first table name, and defaults the table specification file
          names from the table names. This enables makefiles to be simplified
          (see #3).</li>

          <li>
            <p>The default C data types to which GENTABLE maps from its types
            have been generalized, primarily to ease the migration of views to
            32-bit. The new mappings are listed below; those prefixed with
            &ldquo;DBS&rdquo; are new types introduced for 32-bit compatibility
            and are discussed in #5 below.</p>

            <table border="0" cellpadding="2" cellspacing="0">
              <thead>
                <tr class="grey" align="left">
                  <td class="head">Table Type&nbsp;</td>

                  <td class="head">Old Mapping&nbsp;</td>

                  <td class="head">New Mapping</td>
                </tr>
              </thead>

              <tbody>
                <tr>
                  <td>binary&nbsp;</td>

                  <td>unsigned char&nbsp;</td>

                  <td>BYTE</td>
                </tr>

                <tr class="grey">
                  <td>string&nbsp;</td>

                  <td>char&nbsp;</td>

                  <td>CHAR</td>
                </tr>

                <tr>
                  <td>real&nbsp;</td>

                  <td>double&nbsp;</td>

                  <td>DBSREAL</td>
                </tr>

                <tr class="grey">
                  <td>number&nbsp;</td>

                  <td>unsigned char&nbsp;</td>

                  <td>BYTE</td>
                </tr>

                <tr>
                  <td>integer&nbsp;</td>

                  <td>int&nbsp;</td>

                  <td>DBSINT</td>
                </tr>

                <tr class="grey">
                  <td>long&nbsp;</td>

                  <td>long&nbsp;</td>

                  <td>DBSLONG</td>
                </tr>

                <tr>
                  <td>boolean&nbsp;</td>

                  <td>int&nbsp;</td>

                  <td>DBSBOOL</td>
                </tr>
              </tbody>
            </table>

            <p>Because of the need to use derived types to ensure 16/32-bit
            compatibility use of the C-type column of the table specification
            file (column #3) is now strongly depracated. The generated include
            files will continue to compile under 16-bit, but will fail to
            compile under 32-bit.</p>
          </li>

          <li>
            <p>There are also new command-line options designed to control the
            generation of the include files:</p>

            <table border="0" cellpadding="2" cellspacing="0">
              <thead>
                <tr class="grey" align="left">
                  <td class="head">Option&nbsp;</td>

                  <td class="head">Meaning</td>
                </tr>
              </thead>

              <tbody>
                <tr>
                  <td>-s&nbsp;</td>

                  <td>apply strict C-type column checking in 16-bit too</td>
                </tr>

                <tr class="grey">
                  <td>-16&nbsp;</td>

                  <td>generate inclusions compatible with pre-2.0A
                  GENTABLE</td>
                </tr>

                <tr>
                  <td>-o&nbsp;</td>

                  <td>create generated files in the specified directory</td>
                </tr>

                <tr class="grey">
                  <td>-x&nbsp;</td>

                  <td>strip the C-type column (no inclusions generated)</td>
                </tr>
              </tbody>
            </table>
          </li>
        </ol>
      </li>

      <li>
        32-bit Compatibility

        <p>Extensive changes have been made to the templates in support of
        32-bit compatibility. Views must all be reinstantiated to take
        advantage of this support. Also, there have been changes to makefiles
        and GENTABLE in support of 32-bit. Refer to #3 and #4 above. The
        changes you will need to make revolve around the definition and use of
        types. The goal is to make the interface to your views (the routine
        prototypes) and their implementation insulated from target changes.</p>

        <ol type="A">
          <li>
            Types

            <p>In order to enhance portability primitive C types should not be
            used directly. The only exception is void. To address this two
            tiers of types have been introduced: basic and derived. The basic
            types are defined as:</p>

            <table border="0" cellpadding="2" cellspacing="0">
              <thead>
                <tr class="grey" align="left">
                  <td class="head">Basic Type&nbsp;</td>

                  <td class="head">Definition&nbsp;</td>

                  <td class="head">Size</td>
                </tr>
              </thead>

              <tbody>
                <tr>
                  <td>INT8&nbsp;</td>

                  <td>Signed integer&nbsp;</td>

                  <td>1</td>
                </tr>

                <tr class="grey">
                  <td>INT16&nbsp;</td>

                  <td>Signed integer&nbsp;</td>

                  <td>2</td>
                </tr>

                <tr>
                  <td>INT32&nbsp;</td>

                  <td>Signed integer&nbsp;</td>

                  <td>4</td>
                </tr>

                <tr class="grey">
                  <td>INT64&nbsp;</td>

                  <td>Signed integer&nbsp;</td>

                  <td>8</td>
                </tr>

                <tr>
                  <td>UINT8&nbsp;</td>

                  <td>Unsigned integer&nbsp;</td>

                  <td>1</td>
                </tr>

                <tr class="grey">
                  <td>UINT16&nbsp;</td>

                  <td>Unsigned integer&nbsp;</td>

                  <td>2</td>
                </tr>

                <tr>
                  <td>UINT32&nbsp;</td>

                  <td>Unsigned integer&nbsp;</td>

                  <td>4</td>
                </tr>

                <tr class="grey">
                  <td>UINT64&nbsp;</td>

                  <td>Unsigned integer&nbsp;</td>

                  <td>8</td>
                </tr>

                <tr>
                  <td>FLOAT32&nbsp;</td>

                  <td>IEEE floating point&nbsp;</td>

                  <td>4</td>
                </tr>

                <tr class="grey">
                  <td>FLOAT64&nbsp;</td>

                  <td>IEEE floating point&nbsp;</td>

                  <td>8</td>
                </tr>
              </tbody>
            </table>

            <p>The basic types allow the definition of types whose
            characteristics are well known. They are defined conditionally for
            each operating system target, but have the precisely the same
            meaning on every target. These types are not to be used directly in
            your sources. Instead, they are used in the definition of the
            derived types, listed below:</p>

            <table border="0" cellpadding="2" cellspacing="0">
              <thead>
                <tr class="grey" align="left">
                  <td class="head">Derived Type&nbsp;</td>

                  <td class="head">Purpose&nbsp;</td>

                  <td class="head">Size&nbsp;</td>

                  <td class="head">Replaces</td>
                </tr>
              </thead>

              <tbody>
                <tr>
                  <td>INT&nbsp;</td>

                  <td>signed integer&nbsp;</td>

                  <td>CPU&rsquo;s natural word&nbsp;</td>

                  <td>int, WORD</td>
                </tr>

                <tr class="grey">
                  <td>UINT&nbsp;</td>

                  <td>unsigned integer&nbsp;</td>

                  <td>CPU&rsquo;s natural word&nbsp;</td>

                  <td>unsigned int, WORD</td>
                </tr>

                <tr>
                  <td>ERRNUM&nbsp;</td>

                  <td>A4W API error&nbsp;</td>

                  <td>2&nbsp;</td>

                  <td>int, WORD</td>
                </tr>

                <tr class="grey">
                  <td>BOOL&nbsp;</td>

                  <td>General boolean flag&nbsp;</td>

                  <td>CPU&rsquo;s natural word&nbsp;</td>

                  <td>int</td>
                </tr>

                <tr>
                  <td>CHAR&nbsp;</td>

                  <td>Printable character&nbsp;</td>

                  <td>1&nbsp;</td>

                  <td>char</td>
                </tr>

                <tr class="grey">
                  <td>BYTE&nbsp;</td>

                  <td>unsigned integer&nbsp;</td>

                  <td>1&nbsp;</td>

                  <td>unsigned char, char</td>
                </tr>

                <tr>
                  <td>SHORT&nbsp;</td>

                  <td>signed integer&nbsp;</td>

                  <td>2&nbsp;</td>

                  <td>int, WORD</td>
                </tr>

                <tr class="grey">
                  <td>LONG&nbsp;</td>

                  <td>signed integer&nbsp;</td>

                  <td>4&nbsp;</td>

                  <td>long, DWORD</td>
                </tr>

                <tr>
                  <td>USHORT&nbsp;</td>

                  <td>unsigned integer&nbsp;</td>

                  <td>2&nbsp;</td>

                  <td>unsigned int, WORD</td>
                </tr>

                <tr class="grey">
                  <td>ULONG&nbsp;</td>

                  <td>unsigned integer&nbsp;</td>

                  <td>4&nbsp;</td>

                  <td>unsigned long, long</td>
                </tr>

                <tr>
                  <td>WORD&nbsp;</td>

                  <td>unsigned integer&nbsp;</td>

                  <td>2&nbsp;</td>

                  <td>unsigned int</td>
                </tr>

                <tr class="grey">
                  <td>DWORD&nbsp;</td>

                  <td>unsigned integer&nbsp;</td>

                  <td>4&nbsp;</td>

                  <td>long, unsigned long</td>
                </tr>

                <tr>
                  <td>RSCID&nbsp;</td>

                  <td>A4W API resource ID&nbsp;</td>

                  <td>A4W API dependent&nbsp;</td>

                  <td>int, WORD</td>
                </tr>

                <tr class="grey">
                  <td>REAL&nbsp;</td>

                  <td>IEEE floating point&nbsp;</td>

                  <td>8&nbsp;</td>

                  <td>double</td>
                </tr>

                <tr>
                  <td>DBSINT&nbsp;</td>

                  <td>database integer field&nbsp;</td>

                  <td>2&nbsp;</td>

                  <td>int, INT, WORD</td>
                </tr>

                <tr class="grey">
                  <td>DBSLONG&nbsp;</td>

                  <td>database integer field&nbsp;</td>

                  <td>4&nbsp;</td>

                  <td>long, DWORD</td>
                </tr>

                <tr>
                  <td>DBSBOOL&nbsp;</td>

                  <td>database boolean field&nbsp;</td>

                  <td>2&nbsp;</td>

                  <td>int, BOOL, INT</td>
                </tr>

                <tr class="grey">
                  <td>DBSREAL&nbsp;</td>

                  <td>database IEEE field&nbsp;</td>

                  <td>8&nbsp;</td>

                  <td>double</td>
                </tr>
              </tbody>
            </table>

            <p>The &ldquo;Replaces&rdquo; column lists uses of types which may
            be ambiguous or inappropriate which that derived type should
            replace. The decision to replace the type of a variable should be
            based on the purpose of the variable. To that end the
            &ldquo;Purpose&rdquo; column should be used to determine this.</p>
          </li>

          <li>
            Interface

            <p>The main problem here is parameters passed by reference, because
            of the fact that different clients interpret types differently and
            the same client may interpret them differently on different target
            platforms. Consequently, views and their clients must pass
            reference parameters according to the same type rules. The
            following table describes those routines which have ambiguous
            reference parameters which must be corrected.</p>

            <table border="0" cellpadding="2" cellspacing="0">
              <thead>
                <tr class="grey" align="left">
                  <td class="head">Entrypoint&nbsp;</td>

                  <td class="head">Parameter&nbsp;</td>

                  <td class="head">Type</td>
                </tr>
              </thead>

              <tbody>
                <tr>
                  <td><i>xxxx</i>BlkGet&nbsp;</td>

                  <td>list of field sizes&nbsp;</td>

                  <td>LPSHORT</td>
                </tr>

                <tr class="grey">
                  <td><i>xxxx</i>BlkPut&nbsp;</td>

                  <td>list of field sizes&nbsp;</td>

                  <td>LPSHORT</td>
                </tr>

                <tr>
                  <td><i>xxxx</i>CmpNames&nbsp;</td>

                  <td>number of composites&nbsp;</td>

                  <td>LPSHORT</td>
                </tr>

                <tr class="grey">
                  <td><i>xxxx</i>Fields&nbsp;</td>

                  <td>number of fields&nbsp;</td>

                  <td>LPSHORT</td>
                </tr>

                <tr>
                  <td><i>xxxx</i>Key&nbsp;</td>

                  <td>number of key segments&nbsp;</td>

                  <td>LPSHORT</td>
                </tr>

                <tr class="grey">
                  <td><i>xxxx</i>Keys&nbsp;</td>

                  <td>number of keys&nbsp;</td>

                  <td>LPSHORT</td>
                </tr>

                <tr>
                  <td><i>xxxx</i>Presents&nbsp;</td>

                  <td>list of element numbers&nbsp;</td>

                  <td>LPSHORT</td>
                </tr>

                <tr>
                  <td>
                  </td>

                  <td>number of list elements&nbsp;</td>

                  <td>LPSHORT</td>
                </tr>

                <tr class="grey">
                  <td>rotoEntryEtc&nbsp;</td>

                  <td>(any which are passed by reference)&nbsp;</td>

                  <td>depends on the use</td>
                </tr>
              </tbody>
            </table>

            <p>Note that <i>xxxx</i>Dirty() and <i>xxxx</i>Exists() are are not
            listed. This is because the natural type for a BOOL is an int. C
            programs can compile and run this without complaint, while Realizer
            programs are insulated from this.</p>
          </li>

          <li>
            Implementation

            <p>The prototypes and bodies of any callouts, overrides, or data
            structures you have filled in or created will need to be corrected
            to use the appropriate derived types.</p>

            <p>You will need to examine any uses of the Accpac API to ensure
            suitable types are being used. The best way to do so is to replace
            all uses of types with the appropriate derived types. Although this
            applies to any of the many Accpac API functions, there are a subset
            which are most frequently used: views, currencies, error reporting,
            company profile and fiscal calendars.</p>

            <p>Similarly you will need to examine any uses of the Win32 API,
            and substitute suitable derived types. There are also some
            functions which receive special treatment. The return value of
            LoadLibrary() should be assigned to a variable, then that variable
            checked by calling LIBRARY_WAS_LOADED(). If GetWindowWord() is
            called to retrieve a HANDLE, use GetWindowHandle() instead.</p>
          </li>
        </ol>
      </li>

      <li>
        Pedantic Error Codes

        <p>The error code scheme has been superceded. The old scheme was not
        very descriptive: the user typically got more information than the
        programmer about what had actually happened. The new scheme has a
        different error code for each distinct error condition that the
        template may encounter, including most filter and database error
        conditions. For this reason it is called the pedantic error scheme.</p>

        <p>The template has been completely changed to use the pedantic errors
        at all times. However, because most programs calling views don&rsquo;t
        yet use these pedantic errors by default errors are returned in the old
        scheme. In order to facilitate adoption of the pedantic error scheme
        there are three new features. First, DO_PEDANTICERRORS must be defined
        in <i>zzzz</i>1.H to make your views return the pedantic errors.
        Second, there are 6 functions which map between the different error
        coding schemes: ErrorMapDatabaseToPedantic(),
        ErrorMapFilterToPedantic(), ErrorMapPedanticToOld(),
        ErrorMapViewToDatabase(), ErrorMapViewToFilter() and
        ErrorMapViewToPedantic(). Third, eRevision has been added to the view
        handle so that template functions and call-outs defined to return
        revision errors can transmit database error codes.</p>

        <p>The pedantic error codes are defined in CVIEW.H. It is strongly
        recommended that the pedantic errors be used, as they are much more
        useful for programmers. The old error scheme will be depracated, and
        eventually will be removed altogether.</p>
      </li>

      <li>
        Miscellaneous New Features

        <ol type="A">
          <li>Added DO_GETPERMISSIONS callout. It actually overrides
          GetPermissions(), also activating GetPermissionsBase() for use. Also
          available are BaseGetPermissions() and SecurityPermissions().</li>

          <li>
            <p>Accessor functions have been added for all remaining static and
            nearly all the remaining dynamic data structures. They can be made
            to expand inline by selecting the DO_INLINEHELPERS callout.</p>

            <table border="0" cellpadding="2" cellspacing="0">
              <thead>
                <tr class="grey" align="left">
                  <td class="head">Accessor&nbsp;</td>

                  <td class="head">Returns&nbsp;</td>

                  <td class="head">References</td>
                </tr>
              </thead>

              <tbody>
                <tr>
                  <td>FindCmp&nbsp;</td>

                  <td>VIEWDEF for this composite&nbsp;</td>

                  <td>lpv-&gt;cmp[]</td>
                </tr>

                <tr class="grey">
                  <td>FindCmpField&nbsp;</td>

                  <td>composite&rsquo;s field for a foreign key&nbsp;</td>

                  <td>lpv-&gt;cmpFields[][]</td>
                </tr>

                <tr>
                  <td>FindCmpForeign&nbsp;</td>

                  <td>foreign key for this composite?&nbsp;</td>

                  <td>lpv-&gt;cmpForeign[]</td>
                </tr>

                <tr class="grey">
                  <td>FindCmpKey&nbsp;</td>

                  <td>CMPKEY for this composite&nbsp;</td>

                  <td>lpv-&gt;cmpKey[]</td>
                </tr>

                <tr>
                  <td>FindCmpName&nbsp;</td>

                  <td>rotoID string for this composite&nbsp;</td>

                  <td>cmpNameList[]</td>
                </tr>

                <tr class="grey">
                  <td>FindDetailMap&nbsp;</td>

                  <td>array of DETAILMAP structures&nbsp;</td>

                  <td>headerFields</td>
                </tr>

                <tr>
                  <td>FindGenStub&nbsp;</td>

                  <td>composite is GENSTUB?&nbsp;</td>

                  <td>lpv-&gt;cmpGenStub[]</td>
                </tr>

                <tr class="grey">
                  <td>FindImpOpen&nbsp;</td>

                  <td>implicit composite opened?&nbsp;</td>

                  <td>lpv-&gt;impOpen[]</td>
                </tr>

                <tr>
                  <td>FindImpRead&nbsp;</td>

                  <td>implicit composite read?&nbsp;</td>

                  <td>lpv-&gt;impRead[]</td>
                </tr>

                <tr class="grey">
                  <td>FindPermissionMap&nbsp;</td>

                  <td>array of default permissions&nbsp;</td>

                  <td>permission</td>
                </tr>
              </tbody>
            </table>
          </li>

          <li>The DATAPIPE template has been revamped to follow the 32-bit
          compatibility conventions. The main impacts are the use of the
          derived types and the use of ACCPAC.MAK and new makefile structuring.
          Also, it has been integrated more closely with the CLANG
          template.</li>

          <li>eValidation has been added to the view handle to allow validation
          functions (templated, call-outs and user-defined) to transmit error
          codes back to the template.</li>

          <li>True passive concurrency has been implemented. This means that
          the current record will not be locked before updating or deleting it.
          This requires version 4.0A of the system manager to functions. It
          must be explicitly activated per view by defining
          DO_PASSIVECONCURRENCY in <i>zzzz</i>1.H. MergeConflictedRecords() was
          added, which resolves record conflicts when optimistic concurrency is
          in use.</li>

          <li>Use of the new filter routines in version 4.0A of the system
          manager has been implemented. This feature is automatically available
          and used when this template is used in reinstantiating your views.
          When a filter specifies that leading segments of the key are fixed to
          a single value subsequent fetches will search only a subset of the
          records. For subclass views the filter expression is now passed to
          the base view, with the subclass view&rsquo;s fields removed.</li>
        </ol>
      </li>
    </ol>
    <!-- ================================================================== -->

    <h2 class="overhead"><a id="97-MAY-30" name="97-MAY-30">Since 97-MAY-30,
    released in SDK 3.0A</a></h2>

    <ol>
      <li>
        New features

        <ol type="A">
          <li>Simplified DO_CALLOUTERRORS so that only one branch of code need
          be maintained. CALLOUTERROR is a type defined as appropriate (void or
          ERRNUM), ERROR_FROM_CALLOUT is a macro that always returns an ERRNUM,
          and ERROR_RETURN_CALLOUT is a macro that returns a value of type
          CALLOUTERROR.</li>

          <li>Added enumerations for different revision and subclass protocol
          modifiers. For revisions there is NO_REVISIONS, SEQUENCE_REVISIONS
          and ORDER_REVISIONS. For subclasses there is JOIN_SUBCLASS,
          ALTER_SUBCLASS and OVERRIDE_SUBCLASS.</li>

          <li>Added a new callout CreateEtc(), activated by DO_CREATEETC, which
          is called from the fileAdd() function during <i>xxxx</i>Create(). It
          is called after new table and fields have been added, but before any
          new keys have been added. It allows you to do any specialized
          initialization of the tables or fields. In particular this is useful
          for subclass views.</li>

          <li>
            <p>Added accessor functions for most of the static and some of the
            dynamic data structures. This makes it simpler to have situations
            such as no fields, no tables, no keys, etc. Many of these can be
            made to expand inline by selecting the new DO_INLINEHELPERS
            callout.</p>

            <table border="0" cellpadding="2" cellspacing="0">
              <thead>
                <tr class="grey" align="left">
                  <td class="head">Accessor&nbsp;</td>

                  <td class="head">Returns&nbsp;</td>

                  <td class="head">References</td>
                </tr>
              </thead>

              <tbody>
                <tr>
                  <td>FindFieldIndex&nbsp;</td>

                  <td>field index given a field number&nbsp;</td>

                  <td>fldNumToIdx[]</td>
                </tr>

                <tr class="grey">
                  <td>FindFieldMap&nbsp;</td>

                  <td>IDXMAP for a field index&nbsp;</td>

                  <td>fldIdxMap[]</td>
                </tr>

                <tr>
                  <td>FindKeyDef&nbsp;</td>

                  <td>KEYMAP for a key number&nbsp;</td>

                  <td>keyNumMap[]</td>
                </tr>

                <tr class="grey">
                  <td>FindRecord&nbsp;</td>

                  <td>current record set&nbsp;</td>

                  <td>lpv-&gt;record</td>
                </tr>

                <tr>
                  <td>FindRecordRead&nbsp;</td>

                  <td>record set as first read&nbsp;</td>

                  <td>lpv-&gt;recordRead</td>
                </tr>

                <tr class="grey">
                  <td>FindRecordTemp&nbsp;</td>

                  <td>temporary record set&nbsp;</td>

                  <td>lpv-&gt;recordTemp</td>
                </tr>

                <tr>
                  <td>FindTableHandle&nbsp;</td>

                  <td>array of table handles&nbsp;</td>

                  <td>lpv-&gt;ahTable</td>
                </tr>

                <tr class="grey">
                  <td>FindTableMap&nbsp;</td>

                  <td>array of TBLMAP structures&nbsp;</td>

                  <td>tables</td>
                </tr>

                <tr>
                  <td>FindTableRev&nbsp;</td>

                  <td>array of revision handles.&nbsp;</td>

                  <td>lpv-&gt;rev</td>
                </tr>
              </tbody>
            </table>
          </li>

          <li>
            Added a number of new error reporting functions.
            ReportCompositeKeyError() reports mismatches between your
            view&rsquo;s KEYMAP and the composite view&rsquo;s key.
            ReportRotoError() reports unhandled (non-standard) view op-codes.
            ReportSubclassComposeError() reports errors between the composition
            list of your subclass view and its base view.

            <p>ReportRotoError() is called by a new function BaseRotoEntry(),
            which uniformly handles the detection of non-stardard view
            op-codes. If your view is a subclass it will forward the operation
            to the base view, otherwise it will report this error.</p>
          </li>
        </ol>
      </li>

      <li>
        Restructuring. The placement, content and treatment of files in the
        templates have been altered somewhat, and that will have an impact on
        your procedures if you wish to make use of them.

        <ol type="A">
          <li>Alphabetized the callouts in <i>zzzz</i>1.H and
          <i>zzzz</i>1.C</li>

          <li>Moved or removed declarations from <i>zzzz</i>.H to
          <i>zzzz</i>1.H or <i>zzzz</i>2.h which were not part of the
          view&rsquo;s published interface. In particular <i>zzzz</i>_LAST_IDX
          has been discontinued, as it was only used to define FLD_IDX_LIMIT in
          <i>zzzz</i>1.H. You need to delete the view routine prototypes
          appearing in <i>zzzz</i>.H. Finally, you must move the FLD_IDX_PFX
          macro to <i>zzzz</i>1.H to ensure subclassing works correctly in your
          projects.</li>

          <li>Declarations which were literally duplicated verbatim from one
          view to the next and were not parameterized by any patterns have been
          moved from <i>zzzz</i>1.H and <i>zzzz</i>2.H to a new file CVIEW.H
          which is not part of the template sources as such but rather the SDK.
          The <i>zzzz</i>.H and <i>zzzz</i>2.H headers have been greatly
          simplified as a result.</li>

          <li>
            The default structure of the directory tree holding the project
            files has been changed to follow that used in the tutorial. This is
            the recommended structure to begin with, where all views are in
            VIEWS, common inclusions are copied to INCLUDE, intermediate
            objects are in OBJ, and intermediate generated sources are in GEN.
            <i>zzzz</i>.MAK has been changed to reflect this.

            <p>In keeping with this directory structure an overarching MAKEFILE
            and associated MAKE.BAT and MAKED.BAT drivers have been added.
            Whenever you add any views to a project the MAKEFILE should be
            updated to include the new view&rsquo;s <i>zzzz</i>.MAK plus
            <i>zzzz</i> and i<i>zzzz</i> build targets. MAKEFILE and MAKE.BAT
            are editable files; that is, any changes you make to them will be
            preserved.</p>
          </li>

          <li>The aaaa.H header file has been moved from CLANG to CVIEW. If you
          control this file in a location other than the directory containing
          the view, you will need to delete it from the view directory after
          reinstantiating. Since this is an editable file, you will want to
          maintain your own. The MAKEFILE has an intermediate build target
          iaaaa in order to maintain any global dependencies.</li>

          <li>
            The aaaaERR.RC view common error message string source file in
            CLANG has been changed from non-editable to editable. This means
            that if you reinstantiate any of your views you will also have to
            reinstantiate your language resource sources, then edit your
            aaaaERR.RC manually to add in the new common strings and error
            messages required by the new templates.

            <p>The reason for this change is that it is useful to edit these
            common messages so that they follow some project-defined convention
            or language. If you have not actually edited this files you can
            actually delete it and let MKINST recreate it for you.</p>
          </li>
        </ol>
      </li>

      <li>
        Subclass support. There have been extensive changes in this area. See
        also #4 below and CreateEtc() in #1 above.

        <ol type="A">
          <li>The use of SUB_VIEW has been changed to SUBCLASS_VIEW, as it is
          more mnemonic. This change is backward-compatible; that is, they may
          be used interchangeably.</li>

          <li>Added BasePutData() and BaseGetData() to put/get the filler field
          in the base view.</li>

          <li>Added a new style of subclassing: overriding. This allows you to
          attach functionality to any entrypoints of a base view without adding
          fields or tables. In fact, you can add calculated fields, but
          physical fields or tables cannot be added.</li>

          <li>
            The styles of subclassing have been reworked so that they build on
            each other. The basic type is overriding, as described above. Then
            there is altering, which adds fields and keys directly to a base
            view&rsquo;s table. There is a major change in this area: TBL_COUNT
            is now treated exclusively as the number of physical tables unique
            to a view; you must use BASE_TBL_COUNT to specify the fields you
            are adding to the base view&rsquo;s table.

            <p>Finally, there is joining, which joins a secondary database
            table with the base view, much in the same manner as a multi-table
            view. Note that joining is no longer exclusive of altering. In fact
            it may be necessary to use both if you want to both add fields
            join-style, and also add keys. This is because to add indexes to a
            view it must be done to the base view&rsquo;s table (I.E. -
            altering). Note that when join-subclassing is used the template
            automatically generates a JOIN_KEY_COUNT.</p>
          </li>

          <li>
            Fixed a number of bugs introduced in late-1995 and later releases
            of the template which impede a view&rsquo;s ability to act as a
            base view. These were in the relaying of the filler field in
            <i>xxxx</i>Get() and <i>xxxx</i>Put(), in selecting an alternate
            key with <i>xxxx</i>Order(), and proper attribute reporting via
            <i>xxxx</i>Attrib(). These have all been corrected. For the
            <i>xxxx</i>Order() entrypoint an new template function FlagKeyAux()
            has been added which indicates how many keys the base view has.

            <p>Because of the nature of these problems, existing applications
            will not always work predictably when subclass views are added to
            them. It is most noticeable with alter-style subclasses and with
            alternate keys. With simple join-style subclasses there are usually
            few problems. Finally, the only reliable method of subclassing a
            revision-based view is by altering it, thus to make use of
            subclassing for most realistic add-ins will require these problems
            to be addressed.</p>

            <p>We will PTF views on an as-needed basis for views to which you
            need to add-in to applications we supply. And of course as we
            revise our applications this fix will be implemented across the
            board. Finally, to make your applications subclass capable you
            should reinstantiate your views.</p>
          </li>
        </ol>
      </li>

      <li>
        GENTABLE

        <ol type="A">
          <li>Revised GENTABLE to support subclassing. Two new identifiers
          (idx) and (ids) allow you to specify parameterized definitions for
          the macro used to create them. (idx) specifies the view field index,
          and (ids) specifies the string ID for the description string. In
          addition there are two new parameters used for this: nnnn is the
          database field number, <i>xxxx</i> is the view field index
          subscript.</li>

          <li>
            <p>A new directive has been added: $. It lets you define a new type
            or redefine an existing type. This entails telling GENTABLE how the
            type maps to the DBS API and how it maps to C.</p>

            <table border="0" cellpadding="2" cellspacing="0">
              <thead>
                <tr class="grey" align="left">
                  <td class="head">Column&nbsp;</td>

                  <td class="head">Description&nbsp;</td>

                  <td class="head" align="center">Required?</td>
                </tr>
              </thead>

              <tbody>
                <tr>
                  <td align="center">2&nbsp;</td>

                  <td>GENTABLE type&nbsp;</td>

                  <td align="center">Yes</td>
                </tr>

                <tr class="grey">
                  <td align="center">3&nbsp;</td>

                  <td>C type&nbsp;</td>

                  <td align="center">Yes</td>
                </tr>

                <tr>
                  <td align="center">4&nbsp;</td>

                  <td>Pointer to C type&nbsp;</td>

                  <td align="center">Yes</td>
                </tr>

                <tr class="grey">
                  <td align="center">5&nbsp;</td>

                  <td>Database type&nbsp;</td>

                  <td align="center">Yes</td>
                </tr>

                <tr>
                  <td align="center">6&nbsp;</td>

                  <td>size of type&nbsp;</td>

                  <td align="center">Yes</td>
                </tr>

                <tr class="grey">
                  <td align="center">7&nbsp;</td>

                  <td>Number of implicit fixed decimal places&nbsp;</td>

                  <td align="center">&nbsp;</td>
                </tr>

                <tr>
                  <td align="center">8&nbsp;</td>

                  <td>Is data actually an array of this type?&nbsp;</td>

                  <td align="center">&nbsp;</td>
                </tr>

                <tr class="grey">
                  <td align="center">9&nbsp;</td>

                  <td>Can decimal places be specified?&nbsp;</td>

                  <td align="center">&nbsp;</td>
                </tr>
              </tbody>
            </table>

            <p>For example:</p>
<pre>
$ short short LPSHORT FT_INT SIZEOF_INT
</pre>
          </li>

          <li>Two new ways of specifying comments have been added. LISP-style
          semicolon and C++-style slash-slash. As well, comments can now appear
          anywhere, and cause the remainder of the line to be ignored. Because
          of this change it is now possible to apply the C preprocessor to
          table specification files, thereby allowing inclusions and
          macros.</li>
        </ol>
      </li>

      <li>
        Miscellaneous

        <ol type="A">
          <li>The default behaviour of <i>xxxx</i>Post() was changed so that
          when called for a non-revisioned view no operation is performed
          (unless it has been overridden). The old behaviour, which can be
          reactivated by defining DO_OLDPOST, was that existence of the record
          was checked, then <i>xxxx</i>Insert() or <i>xxxx</i>Update() was
          performed as appropriate.</li>

          <li>Formerly detail views were required to be revisioned. This has
          been relaxed slightly: a detail view may be specified as direct to
          database (HAS_REVISIONS==0) provided it is not sequenced, and that
          neither DO_REVPOSTETC nor DO_PREPOSTETC are defined. In this case,
          database I/O must take place within a transaction. Note that this
          feature is static; that is, it is set at compile time.</li>
        </ol>
      </li>
    </ol>
    <!-- ================================================================== -->

    <h2 class="overhead"><a id="96-JUL-19" name="96-JUL-19">Since 96-JUL-19,
    released in SDK 2.5A</a></h2>

    <ol>
      <li>A minor memory leak in <i>xxxx</i>Compose() has been fixed. The
      particulars are when DO_HEADERETC is defined, and <i>xxxx</i>Compose()
      got called more than once.</li>

      <li>Commented inclusions and declarations have been added at the
      necessary points throughout the modifiable files (<i>zzzz</i>.H,
      <i>zzzz</i>1.H, <i>zzzz</i>.I, <i>zzzz</i>1.C and <i>zzzz</i>.MAK) in
      order to implement multiple tables, especially calculated tables. To make
      use of them, simply uncomment them, define TBL_COUNT and/or
      CALC_TBL_COUNT appropriately, and create a second table specification
      file of the form <i>tttt</i>2.TBL. See chapter 2 of the &ldquo;C
      Reference Guide&rdquo; under &ldquo;Advanced Features&rdquo; for
      GENTABLE.</li>

      <li>
        rotoEntry() enhancements

        <ol type="A">
          <li>A new method of overriding rotoEntry() has been added:
          DO_ROTOENTRY. When activated the function rotoEntry() in
          <i>zzzz</i>1.C is available and is called in preference to the
          template&rsquo;s. You may access the original functionality by
          calling rotoEntryBase().</li>

          <li>
            RotoView and RotoLength fields have been added to the V view handle
            structure. These are set by rotoEntry() prior to control being
            passed to the specific view routines. They allow view routines,
            call-outs and overrides to make use of the actual ROTOVIEW
            structure passed in. The most common use is by a call-out to
            recover the view operation from which it was invoked.

            <p>In order to properly support this feature it has also been
            necessary to make the template reentrant. This has been done by
            adding the ENTRYSTATE structure in <i>zzzz</i>2.H, and the template
            functions EntryStatePush() and EntryStatePop(). These are used in
            rotoEntry().</p>
          </li>
        </ol>
      </li>

      <li>
        Revision list support enhancements

        <ol type="A">
          <li>DetailKeyWithinHeader() was added in order to allow detail views
          which are not in the primary order to subtotal fields to the header.
          A detail view now examines the view field indexes of segments of the
          current key. If they match the header&rsquo;s portion of the primary
          key, it is allowed. Otherwise the old behaviour remains. It is
          usually not necessary to call this function directly.</li>

          <li>
            Two call-outs have been implemented which enable the template to be
            used for multi-level revision lists.

            <p>DO_AUTOCANCELBODY activates the function AutoCancelBody(), which
            you fill in with the logic needed to detect if the given field
            should cancel the details, and to do so.</p>

            <p>DO_MAPTODETAIL activates the function MapToDetail() which you
            can use to perform any appropriate processing when a particular
            view operation needs to be applied to a given detail. The default
            behaviour may be invoked by calling MapToDetailBase(). Note that
            when this call-out is activated the operation passed in changes
            from a function pointer to a view operation code. Note also that
            MapToDetails() has always been in the template and is used when
            some view operation will cause further operations, such as posting
            or cancelling, to be cascaded to its details.</p>
          </li>
        </ol>
      </li>

      <li>
        Miscellaneous enhancements

        <ol type="A">
          <li>Error reporting was added to OpenOneView() in certain cases where
          it is indeterminate if an error return from a function has been
          reported yet.</li>

          <li>DO_INITBYFIELD has been defaulted to being activated with a newly
          instantiated view. It can be deactivated if desired.</li>

          <li>Length padding of BCD fields has been implemented in
          <i>xxxx</i>Put(). BCD data passed in which is not the exact size
          required by the database table will be padded on the left with 0x00
          values. Note that because the caller does not pass the number of
          decimals, a value which is padded cannot be scaled if it was passed
          in formatted with the incorrect number of decimals. Note also that
          this is not with the BCD-based types of date and time.</li>
        </ol>
      </li>
    </ol>
    <!-- ================================================================== -->

    <h2 class="overhead"><a id="96-JAN-26" name="96-JAN-26">Since 96-JAN-26,
    released in SDK 2.0A</a></h2>

    <ol>
      <li>Changed ReportAssertion(), called by VIEWASSERT(), so that it will
      cause a GPF only in the case that VIEWDEBUG is defined to 0xDEAD.</li>

      <li>Implemented DO_PUTSAVECURRENT, which causes <i>xxxx</i>BasePut() to
      save the entire lpv-&gt;record[] contents into lpv-&gt;recordTemp[]. This
      allows user code, particularly PutEtc() and field validations, to
      reference any field values as they were prior to the call. This feature
      is not reentrant.</li>

      <li>Implemented DO_INITBYFIELD, which changes the default record
      initialization behaviour from setting everything to blanks to setting
      each field to blanks or zeroes, as appropriate to each field&rsquo;s
      type. There is no additional function to edit in the <i>zzzz</i>1.C file.
      There are new functions in the <i>zzzz</i>.C file made available:
      InitFields(), InitFieldList() (for fields with presents lists), and
      InitFieldBuffer(). Note that these functions don&rsquo;t need to be
      called directly; any initial field value specializations you need to do
      is still done with InitNonBlankFields().</li>

      <li>Implemented DO_RECORDREAD, which separates the logic of saving to
      lpv-&gt;recordRead[] from the DO_CONCURRENCYETC logic, allowing it to be
      used independently. This means that you can keep a copy of the record as
      it was read or initialized distinct from the current contents of the
      record, allowing you to make comparisons to prior values without extra
      database I/O.</li>

      <li>Fixed the joined-style subclassing protocol to push the key into the
      base view whereever possible, rather than pulling it from the base view.
      This fixed a number of problems most noticeable when filters were
      used.</li>
    </ol>
    <!-- ================================================================== -->

    <h2 class="overhead"><a id="95-JAN-24" name="95-JAN-24">Since
    95-JAN-24</a></h2>

    <ol>
      <li>Added DO_CLEARAUDIT, which when defined activates code which clears
      the audit stamp of the physical record whenever the current key of the
      view is altered via viewPut(). By default this symbol is not defined,
      hence the template&rsquo;s original behaviour is still current.</li>

      <li>Changed <i>xxxx</i>Put() to blank-pad all strings all the time,
      regardless of whether they are masked. Note that if a field is masked
      this blank- padding is done prior to masking.</li>

      <li>Implemented DECLARE_LIST and DECLARE_MASK macros (plus support and
      variant macros). These make adding presentation information much simpler,
      especially when a table specification file is also used. For details on
      them, lookup their definitions and comments in the <i>zzzz</i>2.H file,
      and some sample uses in the <i>zzzz</i>1.C file.</li>

      <li>Added a new status V.bExists to the view handle. It indicates if the
      current record loaded in the view exists.</li>

      <li>Fixed a problem with detail views where viewInsert() immediately
      followed by viewUpdate() without the current record being reloaded causes
      running totals to go out balance. This was due to a bug in the
      implementation of the support code for DO_HEADERETC.</li>

      <li>
        Subclass view support.

        <ol type="A">
          <li>Updated the implementation. Rather than having the last implicit
          composition be the base view, you can specify the base rotoID by
          filling in the a new global variable subCmpName. Also, a new view
          handle member V.subCmp holds the base view&rsquo;s VIEWDEF. Finally,
          there are new manipulation functions: BaseOpen(), BaseClose(),
          BaseUnload(), BaseGetKey(), BasePutKey(), ReportBaseError(),
          ReportBaseLoadError() and ReportBaseMemoryError().</li>

          <li>Implemented joined-style subclassing. Activated by defining
          SUB_VIEW to 2. This allows fields to be added to a view, but is done
          by maintaining a secondary table parallel to the table of the view
          being subclassed.</li>
        </ol>
      </li>

      <li>
        PutCmpField() and related field propagation changes

        <ol type="A">
          <li>Fixed PutCmpField() to return an ERRNUM as expected in the
          template.</li>

          <li>Added PutCmpFieldAux(), which parameterizes the field-level
          verification flag passed in to the cascading viewPut() calls, as well
          as the range of views receiving the new data.</li>

          <li>Added the ability to override PutCmpField(), PutCmpFieldAux() and
          PutCmpFields(). It is activated by defining the DO_PUTCMPFIELD symbol
          in <i>zzzz</i>1.H, and filling in the appropriate code in
          <i>zzzz</i>1.C.</li>

          <li>Added PutCmpKey(), which allows all segments of specified key for
          a particular instance of a composite view to be propagated. The data
          propagated are taken from the current record contents. This function
          may be overridden by defining the DO_PUTCMPKEY symbol in
          <i>zzzz</i>1.H, and filling in the appropriate code in
          <i>zzzz</i>1.C; the original behaviour is available by calling
          PutCmpKeyBase().</li>
        </ol>
      </li>

      <li>
        Implemented lazy semantics. There are two distinct but related features
        in this category.

        <ol type="A">
          <li>
            The first feature is lazy verification, activated by defining the
            DO_LAZYVERIFY symbol in <i>zzzz</i>1.H. It allows you to suppress
            unnecessary field and key validations when the current record is
            verified. In support of this ValidateKeys() has been changed to
            take an additional parameter: a flag indicating if verification is
            to be complete.

            <p>The condition allowing a field validation to be skipped is if it
            has not been changed. The condition allowing a key validation to be
            skipped is if none of its constituent fields have been changed.
            These semantics are by default in effect for <i>xxxx</i>Update(),
            but not for <i>xxxx</i>Insert() or <i>xxxx</i>Verify().</p>

            <p>Note that because of these semantics it is possible to suppress
            validations at times when you really need them, thereby allowing
            invalid data to reach the database. This may be the case when there
            has been an improper partitioning of validation. In particular, if
            field validation functions and key validation are used to the
            exclusion of the ValidateFieldDependencies() call-out, or
            ValidateFieldDependencies() is used incorrectly or incompletely.
            Regardless of lazy verification, ValidateFieldDependencies() will
            be called, therefore it is important to check record-level and
            inter-field dependencies there, not in field validation
            functions.</p>
          </li>

          <li>
            The second feature is lazy propagation, activated by defining the
            DO_LAZYPUT symbol in <i>zzzz</i>1.H. It allows you to control the
            cascading of calls to composites. It consists of suppressing
            viewPut() calls to your composites whenever foreign key fields
            change in your view. This then allows you to choose when to
            propagate the necessary values to your composites when it is more
            appropriate. In particular, upon key validation by using the new
            PutCmpKey() function.

            <p>It is vital to note that views that have been composed in
            explicitly (via <i>xxxx</i>Compose() having been called) cannot
            have these semantics applied to them. Only views that you have
            opened implicitly may take on lazy semantics. This can be checked
            by examining the appropriate entry of the impOpen[] view handle
            flag array.</p>

            <p>When it is activated, the semantics and parameters of
            ValidateKey() and ValidateKeyField() change. ValidateKey() changes
            to take the composite instance instead of the source key map and
            target view field indexes. It is wholly responsible for propagating
            the key value, whereas before this responsibility varied. Also, the
            current record contains the values to be propagated, even if they
            haven&rsquo;t officially reached the record yet. This latter
            situation is due to the changes in the other function
            ValidateKeyField(). It takes the data buffer and size as additional
            parameters, and temporarily switches that data into the current
            record, restoring the original contents when completed.</p>

            <p>Retrofitting lazy propagation semantics to existing views has a
            number of caveats. First, composites defined in the DMND_CMP_COUNT
            and IMP_CMP_COUNT ranges will now be guaranteed to never be open
            until you perform an OpenOneView(), DemandOpen(), PutCmpField() or
            PutCmpKey() in your <i>zzzz</i>1.C file. You must ensure you call
            one of these. Second, blithely putting in PutCmpKey() calls without
            regard to what&rsquo;s actually needed at that point may defeat
            some of the benefit of using it. In particular, you want to wait
            until to latest possible moment to open your composites, otherwise
            there will be no opportunity for resource or time conservation.
            This latter caveat applies generally to using lazy propagation, not
            only in retrofitting it.</p>
          </li>
        </ol>
      </li>

      <li>
        Key validation.

        <ol type="A">
          <li>Fixed ValidateKeyField() so that all composites affected by the
          specified field changing are <i>xxxx</i>Put() and verified.
          Previously only the first such was done, which was insufficient.</li>

          <li>Changed ValidateKeyField() so that it validates keys only when
          the final segment of a foreign key is <i>xxxx</i>Put().</li>

          <li>Changed ValidateKeys() and ValidateKeyField() so that 0-valued
          view field indexes appearing in the hierarchyKeyMap[] are now taken
          into account and such fields are skipped. You can fill in the missing
          view field indexes if needed by overriding the PutCmpKey()
          function.</li>
        </ol>
      </li>

      <li>
        <i>xxxx</i>Verify().

        <ol type="A">
          <li>Changed to call mskFormat() instead of mskVerify(). If the result
          has bad characters it is rejected, else the formatted data replaces
          the original.</li>

          <li>Implemented xxxVerify(), which is parametrically called by
          <i>xxxx</i>Verify(), <i>xxxx</i>Insert() and <i>xxxx</i>Update(), and
          allows you to explicitly control lazy verification.</li>
        </ol>
      </li>

      <li>Added DO_REVPEDANTIC, which is a revision list compatibility switch.
      The default behaviour of revision lists has been changed to be optimized:
      before fileCreate() or fileCancel() are called the revision list is
      checked, and if empty they are suppressed. Activating this switch makes
      revision lists always be created or cancelled regardless of their current
      contents.</li>

      <li>
        Added scratch buffer management. Any code can now allocate scratch
        buffers, and they will automatically be freed when the view is closed.
        The intent with these is for holding temporary field values,
        intermediate results, etc. The template has been updated to use this
        support.

        <p>There are several new template functions available: ScratchCreate(),
        ScratchDestroy() and ScratchError() are called automatically by the
        template and aren&rsquo;t directly useful. ScratchAlloc() and
        ScratchFree() manage randomly allocated buffers, of unknown lifetime.
        Finally, ScratchPush() and ScratchPop() manage short-lived buffers, and
        are intended as replacements for alloca() (from the C runtime).</p>

        <p>The maximum number of ScratchAlloc() allocations is determined by
        the DO_SCRATCHHEAP preprocessor symbol. The default is 0. If this sort
        of heap management is desired define this to some appropriate (limited)
        maximum.</p>

        <p>There is no limit to the number of ScratchPush() allocations, but
        there is a limit to the total sizes of those allocations, determined by
        the DO_SCRATCHSTACK preprocessor symbol. The default is 2048. Note that
        the template makes use of the scratch stack, so if you plan to make
        heavy use of it you should expand the stack limit appropriately. Memory
        allocated with ScratchPush() should be freed before the scope in which
        it was allocated is exitted.</p>
      </li>

      <li>
        Implemented DO_CALLOUTERRORS feature. It changes the prototypes of a
        number of template and call-out functions from being void procedures to
        functions returning an ERRNUM. The affected functions are:
        CalculateFields(), InitNonBlankFields(), GenerateKey(),
        InitFieldStructEtc(), InitFieldStruct(), and PutCmpFields().

        <p>Note that in order to retain backward compatibility the functions
        coded in the <i>zzzz</i>1.C file are declared conditionally to allow
        both definitions possible. When editting one of these functions, make
        sure you edit the correct one.</p>
      </li>

      <li>Changed the implementation of security permission determination.
      Formerly it was done once and cached in the view handle. When used with
      secGlobalAccess() this fails, so the default behaviour has been changed
      to determine permissions every time they are requested. If the old
      behaviour is really desired, define the DO_OLDPERMISSION symbol in
      <i>zzzz</i>1.H</li>

      <li>Changed ReportAssertion(), called by VIEWASSERT(), to output its
      string to a debugging monitor, then dereference a NULL pointer, so as to
      force a termination when debugging at the point of failure. Note that
      this is only available when the VIEWDEBUG symbol is defined.</li>

      <li>Added DO_PREPOSTETC, activating PrePostEtc(). This feature allows you
      to manipulate, and alter, the records of a revision-based view as they
      are posted, before being written to disk. This is complementary to the
      DO_REVPOSTETC call-out. This introduced a new routine filePrePost(),
      which posts a single record to a single table. Note that record-level
      re-verification as records are committed may be implemented using
      this.</li>

      <li>
        Optimistic concurrency

        <ol type="A">
          <li>Corrected the maintenance of the V.bBrowsing flag to be set to
          FALSE when dbGetLock() must be called. The lack of this was causing
          invalid position errors in later database operations.</li>

          <li>Corrected the re-calculation and re-verification of the results
          of calling ConcurrencyEtc(). These were being done on the old record
          set, not the newly merged record set. This has been corrected by a
          call to SwapRecords() at the correct point.</li>
        </ol>
      </li>

      <li>Changed xxxFetch() and xxxRead() to be externally visible and
      available.</li>

      <li>Added <i>zzzz</i>_IDX() and <i>zzzz</i>_SIZ() macros to
      <i>zzzz</i>.H. These allow you to specify view field indexes and view
      field sizes in an identifier-independent format. They are defined by
      default to follow original template-supplied identifier format, but they
      may be redefined to be anything else needed.</li>

      <li>Fixed a bug in the creation of revision lists (in fileCreate()). If
      the order of the view was an alternate key, the revision list(s)
      weren&rsquo;t being created with the correct order.</li>
    </ol>
    <!-- ================================================================== -->

    <h2 class="overhead"><a id="94-AUG-12" name="94-AUG-12">Since
    94-AUG-12</a></h2>

    <ol>
      <li>
        Bolstered the capabilities of the security resource permissions
        facility:

        <ol type="A">
          <li>Added a NULL resource, which is an artificial resource used by
          the template to establish the permissions to be used by default. If
          the resource name is the NULL pointer, the permissions listed become
          the base, and are bitwise-OR-ed with the remaining permission entries
          as before.</li>

          <li>Made the permission resource array parallel in intent and
          operation to the menu resource file. This was done by adding an
          AndResources field to the PERMISSIONMAP structure. Additional
          PERMISSIONMAPs link through the AndResources field are bitwise-AND-ed
          together. That is, before it was &ldquo;OR down&rdquo;; now it is
          &ldquo;AND across, OR down&rdquo;. This has been done in a manner
          that is completely backward compatible.</li>
        </ol>
      </li>

      <li>Fixed isGenericStub() to detect and report load errors. Fixed all
      other similar situations where it might have occurred. Added
      GenericStub() as the preferred function to call to determine if a view is
      the CA generic stub, though isGenericStub() is still available for full
      backward compatibility.</li>

      <li>Rearranged #include statements to allow precompiled headers to be set
      up on the 5 most common files included in template-based view sources.
      Activating it will require editing of your makefile(s), and the exact
      commands needed will depend on your compiler.</li>

      <li>Fixed OpenOneView() to not re-open already open views. This was a
      potential memory leak bug.</li>

      <li>Fixed a bug in explicit composition with views for which there are
      multiple references.</li>

      <li>Fixed <i>xxxx</i>Compose() in detail protocol to allow NULL header
      VIEWDEF&rsquo;s. This allows a detail view to act as a flat view fully
      when not composed to its header view.</li>

      <li>Fixed a filter problem in <i>xxxx</i>Fetch() where the error return
      was being overwritten in certain obscure cases to indicate success.</li>

      <li>Made <i>xxxx</i>Exists() reset the bBrowsing flag, since dbLocate
      destroys direction. This causes the next <i>xxxx</i>Fetch() to
      reestablish the direction.</li>

      <li>
        Added optimistic concurrency, a facility allowing you to merge record
        changes when there would otherwise be a concurrency error from
        <i>xxxx</i>Update(). It is activated by #defining the DO_CONCURRENCYETC
        symbol in the <i>zzzz</i>1.H file, which declares the call-out function
        ConcurrencyEtc() in the <i>zzzz</i>1.C file and must be filled in to be
        effective. See the comment header of ConcurrencyEtc() for more details.


        <p>Several new functions are available from the <i>zzzz</i>.C file.
        fileOptLock() is a file-level function, analogous to fileLock(), and
        invokes ConcurrencyEtc(). CopyRecords() and SwapRecords() allow you to
        easily manipulate the view handle record, recordTemp and recordRead
        arrays. Finally, FindFieldValueAux() is analogous to FindFieldValue(),
        except that you can specify which set of records to reference.</p>
      </li>

      <li>
        Fixed implementation of <i>xxxx</i>Fetch() for views with multiple
        physical records. Previously there was a single buffer recordTemp
        remembering the old record values, which meant failed
        <i>xxxx</i>Fetch() calls may have disturbed the prior record contents.
        The recordTemp declaration in <i>zzzz</i>2.H has changed from:
<pre>
LPSTR recordTemp;
</pre>

        <p>to:</p>
<pre>
LPSTR recordTemp[TBL_COUNT+CALC_TBL_COUNT];
</pre>

        <p>Failed <i>xxxx</i>Fetch() calls now guarantee that the prior record
        contents will be undisturbed.</p>

        <p>This change is not fully backward compatible. If recordTemp was ever
        referenced in your <i>zzzz</i>1.C code, it will need to change to
        recordTemp[X], where X is the appropriate record index, typically
        0.</p>
      </li>

      <li>Fixed a bug in InitBodyGen(), called by <i>xxxx</i>Init() and
      <i>xxxx</i>Cancel(), which assumed there was no more than one calculated
      table defined.</li>

      <li>Changed detail protocol to <i>xxxx</i>Cancel() itself when it detects
      a new header is <i>xxxx</i>Put() rather than the header cancelling the
      details. Added AutoCancel() for this.</li>
    </ol>
    <!-- ================================================================== -->

    <h2 class="overhead"><a id="94-JUN-02" name="94-JUN-02">Since 94-JUN-02,
    released in SDK 1.0A</a></h2>

    <ol>
      <li>Corrected the implementation of batch/header/detail protocol. What
      had been implemented previously did not conform to the specified
      behaviour for this protocol. A new base protocol switch was added to the
      <i>zzzz</i>1.H file: BATCH_VIEW. To define a batch view, define this
      switch alone. Note that this protocol switch is already in use, but only
      as a behaviour modifier. When used as a modifier it means that the key in
      the view&rsquo;s header view must exist for a record operation to be
      valid. These two different uses of BATCH_VIEW are mutually exclusive of
      each other, meaning that prior uses of it in your code are still fully
      compatible with the latest template.</li>

      <li>Corrected <i>xxxx</i>Security() to allow all permissions when no
      resources are needed (that is, RSC_COUNT is defined to 0).</li>

      <li>Added retrieval of key information when composites are implicitly or
      explicitly composed. Supporting this are a new type, CMPKEY, and a new
      &rsquo;cmpKey&rsquo; member in the V view handle structure. This allows
      more intelligent usage of composite keys, plus is more time
      efficient.</li>

      <li>Fixed validated <i>xxxx</i>Put() to a field which is a key to a
      detail view, and whose value isn&rsquo;t changing. It was formerly
      causing details to be cancelled.</li>

      <li>Changed deletion of details to use <i>xxxx</i>Put() instead of
      <i>xxxx</i>Init() or <i>xxxx</i>Cancel() to initialize the value of the
      key fields to the start of the set of details.</li>

      <li>Fixed <i>xxxx</i>Init() to propagate the view&rsquo;s primary key to
      detail composites. This fix coincidentally addressed a generated key
      bug.</li>

      <li>Fixed a syntax error in the calling of GetEtc().</li>

      <li>Fixed LoadMask() to check the return value of LoadRsc() as
      necessary.</li>

      <li>Changed the implementation of detail protocol to restore the header
      portion of its key from the header view whenever <i>xxxx</i>Fetch() has
      to automatically re-browse to establish position. This is needed to keep
      the detail in sync with the header, since the detail view has no
      knowledge of who is calling it.</li>

      <li>Made FindPresentsInfo() available at all times, not just when
      DO_FINDPRESENTSINFO is defined.</li>

      <li>Changed <i>xxxx</i>Put() to propagate SYSACCESS to the base view in
      subclass protocol views.</li>

      <li>Fixed <i>xxxx</i>Verify() to not validate disabled fields.</li>

      <li>Added ValidateList(), allowing the programmer to explicitly request
      validation of fields with presentation lists. Field validation behaviour
      was also slightly altered: if a field has a presentation list AND an
      explicit validation function, only the function is invoked. If the
      programmer wants the list validated in this case, call
      ValidateList().</li>
    </ol>
    <!-- ================================================================== -->

    <h2 class="overhead"><a id="94-MAY-09" name="94-MAY-09">Since
    94-MAY-09</a></h2>

    <ol>
      <li>Added a new KEYMAP.system member. This allows a view to implicitly
      compose to views having their data in the system database. It is only
      meaningful to use this feature in the hierarchyKeyMap array, and only
      with demand or implicit compositions. It is entirely backward compatible
      with existing views, so re-instantiating views will not change their
      behaviour, that is, existing implicit compositions will be interpreted as
      being in the company database. To specify a composed view which is in the
      system database, set this member to TRUE. Note that if such a view is
      implicitly opened, the read-only system link supplied in the PIB will be
      used; if a read-write link is needed the caller must explicitly open and
      compose the view.</li>

      <li>Changed list verification to check fields of length 1 properly.
      Formerly it compared values as though all were integer-sized, causing
      incorrect and unpredictable results for 1-character strings.</li>

      <li>Changed the deletion of details from within the deletion of a header.
      Formerly the header prepared the detail by issuing a viewInit() on it. In
      cases where the detail has special key-generating behaviour implemented
      in its <i>xxxx</i>Init() code, this can cause unpredictable results. This
      has been changed to viewBrowse() plus viewCancel(), since it initializes
      the record without invoking key generation. The viewBrowse() called
      because the header view has no knowledge of the detail view&rsquo;s
      browse state.</li>

      <li>Added a new call-out conditional feature. It is activated by defining
      DO_REVPOSTETC in <i>zzzz</i>1.H, which defines the revPostEtc() function
      in <i>zzzz</i>1.C. This function is called on each record change
      committed to the database during the the <i>xxxx</i>Post() function. It
      allows you to add special per-detail processing which could not be done
      prior to <i>xxxx</i>Post(), for reasons of integrity, speed, or
      recoverability.</li>

      <li>Changed FindFieldDef() FindFieldValue() ValidateField() and
      ValidIndex() from macros to functions, ostensibly to save space.</li>

      <li>
        Added standard error reporting. Although it has been arranged to be
        backward-compatible, it is considered to be quite important to retrofit
        to existing views. This is because there are a dozen error conditions
        that were formerly not reported, and for which there was no easy way
        for you to add support. Consequently, if you re-instantiate existing
        views but do nothing else to them, you won&rsquo;t get the reporting,
        plus you will get a message advising you of this condition.

        <p>In order to upgrade existing views to have standard error reporting
        there are a number of steps to be done:</p>

        <ol type="A">
          <li>In each view for which you want standard error reporting, define
          the preprocessor symbol DO_STANDARDERRORS in the respective
          <i>zzzz</i>1.H files.</li>

          <li>Change your working directory to the location of your language
          resource sources.</li>

          <li>Re-instantiate your language resource sources. This will generate
          two new files: aaaaERR.I and aaaaERR.RC.</li>

          <li>
            Edit your aaaa.I file and add the following two lines near the top,
            prior to any other existing statments:
<pre>
#define aaaa_ERROR_OFFSET 32700
#include &quot;aaaaERR.I&quot;
</pre>

            <p>Since there is a possibility of resource-definition clash with
            your existing resources, redefine aaaa_ERROR_OFFSET as necessary to
            a value more appropriate to your application.</p>
          </li>

          <li>
            Edit your yyyy.RC file and add the following line, after the
            inclusion of aaaa.I:
<pre>
#include &quot;aaaaERR.RC&quot;
</pre>

            <p>If you wish to use your own wording for these standard errors
            you may do so. You need to not include this file, but instead
            duplicate its contents into your own source area and edit the
            messages as you see fit. Note that the number and ordering of
            message parameters cannot change.</p>
          </li>

          <li>
            Edit your yyyy.MAK file in order to add dependencies to the
            appropriate lines on these two new sources. Add aaaaERR.I and
            aaaaERR.RC to the dependency line for $(OBJPATH)\yyyy.RES. Add
            $(INCPATH)\aaaaERR.I to the dependency line you use to copy
            includes to the common include directory.

            <p>Additionally, add the following new dependency in order to copy
            the new include file to the common include directory:</p>
<pre>
$(INCPATH)\aaaaERR.I: aaaaERR.I
   copy $? $@
</pre>
          </li>

          <li>Finally, there are a new set of functions available from
          <i>zzzz</i>.C: LoadRsc(), ReportError(), ReportDisabledError(),
          ReportFieldError(), ReportIndexError(), ReportKeyError(),
          ReportListError(), ReportLoadError(), ReportMaskError(),
          ReportMemoryError(), ReportReadonlyError(), ReportReverseError(),
          ReportSecurityError ()</li>
        </ol>
      </li>

      <li>Modified GENTABLE to allow greater configureability of certain
      features. See the GENTABLE.TXT file for details.</li>
    </ol>
    <!-- ================================================================== -->

    <h2 class="overhead"><a id="94-APR-15" name="94-APR-15">Since
    94-APR-15</a></h2>

    <ol>
      <li>
        Added support for using the SYSACCESS field as specified in the SDK
        documentation. This consists of two parts:

        <ol type="A">
          <li>A sysAccess member has been added to the V struct. There are
          associated constants defined for its possible values in
          <i>zzzz</i>2.H. As well, the behaviour of <i>xxxx</i>Put() has been
          altered so that when importing field validation is never performed,
          though it still is done for <i>xxxx</i>Verify().</li>

          <li>A new conditional feature has been added allowing the default
          definition and maintenance of attributes to be superceded. It is
          activated by defining the DO_ATTRIBETC preprocessor symbol. The
          programmer then specifies 5 functions in <i>zzzz</i>1.C:
          AttribTest(), AttribSet(), AttribClear(), AttribPut(), and
          AttribGet(). They have been implemented in <i>zzzz</i>1.C to provide
          import/export support by default. If you need to retrofit this
          feature into existing views reinstantiate your views, then copy the
          DO_ATTRIBETC definitions and conditional sections from <i>zzzz</i>1.C
          in the template into your own <i>zzzz</i>1.C.</li>
        </ol>
      </li>

      <li>Corrected the handling of ATTR_PRESENTATION and ATTR_TYPE attributes
      in <i>zzzz</i>.C to be static, as specified in documentation.</li>

      <li>Fixed a bug in <i>xxxx</i>Init() where detail views having calculated
      tables were overrun, causing GPF occassionally.</li>

      <li>Fixed a bug in <i>xxxx</i>Put() where masked fields would
      occassionally cause NULL character to enter the database. This has been
      corrected so that string fields are always blank padded.</li>

      <li>Fixed <i>xxxx</i>Init() to not overrun the record buffer of views
      having a secondary table of only calculated fields. This problem only
      appeared when the view used detail protocol.</li>

      <li>Fixed handling of ATTR_PRESENTATION and ATTR_TYPE attributes to treat
      them statically, as specified.</li>

      <li>Fixed <i>xxxx</i>Cancel() to not generate a new key when a view
      allows it (as with batch protocol views).</li>

      <li>Added a new type to the PRESENTATIONINFO programmer-defined
      structure. It is PRESENTS_LIST_INLINE, and allows a list of strings to be
      specified inline by overloading the mask member. This is particularly
      useful for presentation lists which depend on the contents of the current
      record, or of some other record which may change.</li>

      <li>Edited the default behaviour of rotoEntryEtc so that when the view is
      a subclass kind it will call through to the base view.</li>

      <li>Changed record locking support to use the new current record lock
      parameter of dbLock. This also allowed <i>xxxx</i>Delete() and
      <i>xxxx</i>Update() to be changed to not rebrowse automatically.</li>

      <li>Added tags to C structures declared in <i>zzzz</i>2.H to allow them
      to be used before they are actually declared.</li>

      <li>Fixed some subtle bugs relating to the buffer size passed to
      rscLoadText().</li>

      <li>Fixed OpenOneView() so that <i>xxxx</i>Order() and <i>xxxx</i>Key()
      are not called on composite views with no keys. This affected
      superviews.</li>
    </ol>
    <!-- ================================================================== -->

    <h2 class="overhead"><a id="94-MAR-25" name="94-MAR-25">Since
    94-MAR-25</a></h2>

    <ol>
      <li>Added a new tool facilitating the development of views from the C
      template called GENTABLE. See the GENTABLE.TXT file in the SDK README
      directory for detailed instructions on its use. Though GENTABLE builds on
      top of MKINST rather than replacing it, the template has been changed to
      facilitate its use. There is now a <i>tttt</i>.TBL file in the template,
      containing sufficient definitions to create the phone list tutorial view.
      The modifiable files (<i>zzzz</i>.H, <i>zzzz</i>1.H, <i>zzzz</i>.I,
      <i>zzzz</i>1.C, and <i>zzzz</i>.MAK) have had suitable sections replaced
      by #include statements including the appropriate files generated by
      GENTABLE. Note that prior views are fully backward-compatible with this
      tool.</li>

      <li>Fixed a bug in OpenOneView. If there were both manual compositions
      and implicit or demand compositions, the manual compositions were treated
      as implicits.</li>

      <li>
        Added key validation on <i>xxxx</i>Put calls when field validation is
        requested for fields which are foreign keys. This uses the existing
        ValidateKey programmer-defined function, and is unconditionally
        available with hierarchical, implicit and demand compositions. It works
        by putting the foreign key value to the composed views, then calling
        ValidateKey. Because of this, you will need to edit your existing
        ValidateKeys function to not put the foreign key values when it has
        been called from <i>xxxx</i>Put. Locate the following line in
        ValidateKey in your <i>zzzz</i>1.C files:
<pre>
if ( viewPut (lpv-&gt;cmp[view].rvh, lpv-&gt;cmp[view].view,
</pre>

        <p>and change them to:</p>
<pre>
if ( lpv-&gt;bVerifying &amp;&amp;
     viewPut (lpv-&gt;cmp[view].rvh, lpv-&gt;cmp[view].view,
</pre>

        <p>the bVerifying flag is new in this release of the template, and is
        set to TRUE when <i>xxxx</i>Verify is currently processing. Note that
        this feature may supercede field validations you may have written in
        the validation functions for the purpose of checking foreign keys. If
        this is the case you may need to remove most of that code from your
        field validations.</p>
      </li>

      <li>Added list validation on <i>xxxx</i>Put calls when field validation
      is requested. Whenever a field has a presentation list defined the
      field&rsquo;s value will be verified against the list of possible values
      whenever <i>xxxx</i>Put with validation or <i>xxxx</i>Verify are
      called.</li>

      <li>Made the return codes from the stub functions in <i>zzzz</i>1.C
      reasonable and meaningful defaults.</li>

      <li>Added automatic size determination of presents lists and masks.
      Formerly the size field of the PRESENTATIONINFO structure needed to be
      sufficient to load all string data associated with that presentation.
      This has now been changed to be done automatically -- this was needed
      because of two factors. First: if the presents info is dynamic the
      staticly declared size could have been problematic, and second: to allow
      subclass views to alter these data at runtime. Though the size field of
      the PRESENTATIONINFO structure is now obsolete, it needs to remain as a
      place holder.</li>

      <li>
        Fixed a number of <i>xxxx</i>Init bugs relating to generated keys:

        <ol type="A">
          <li>The segment being checked to determine if generation is requested
          was wrong; it is corrected now to be the final segment of the primary
          key.</li>

          <li>Formerly the final segment could only be of type string. It may
          now be of any type which has a meaningful &ldquo;zero&rdquo; value:
          byte arrays, integers, longs and real data must be filled with binary
          0, time, date and BCDs must have a signed BCD 0 value, and finally
          string arrays must be filled with the ASCII 0 digit.</li>

          <li>Automatic insertion of a newly generated key was done whenever
          the view had been defined with BATCH_VIEW. In order to properly
          support the batch/header/detail protocol as documented, this has been
          changed so that the new record is only inserted on the additional
          constraint that DETAIL_VIEW is not defined.</li>
        </ol>
      </li>

      <li>
        Made a number revision list changes:

        <ol type="A">
          <li>Added support for use of alternate keys with revision lists. This
          imposes a number of restrictions on how such views may be accessed
          while an alternate key is in use. Whenever an alternate key is
          selected (via <i>xxxx</i>Order) the existing revision is cancelled
          and recreated. The revision list created for an alternate key is
          always ordered. If the revision list for the primary key is sequenced
          insertions will not be allowed. If the alternate key allows
          duplicates insertions will not be allowed.</li>

          <li>Fixed a bug with revision lists regarding their handling when
          multiple tables are defined for the view. The revision lists for the
          secondary tables were created as the same kind as for the primary
          table. When the primary revision list is sequenced this didn&rsquo;t
          work. It has been changed so that the secondary revision lists are
          ordered. The maintenance details are all handled inside
          <i>zzzz</i>.C</li>
        </ol>
      </li>

      <li>
        There have been two changes to HeaderEtc() which require you to edit
        any existing views which define DO_HEADERETC.

        <ol type="A">
          <li>HeaderEtc takes an additional parameter: the index of the source
          field. This was done because it was observed that there are
          situations where multiple detail fields may need to be accumulated
          into a single header field. See the end of this point for the change
          needed to the function prototype.</li>

          <li>The first parameter to HeaderEtc has been changed to be the
          detail&rsquo;s view handle, rather than the header&rsquo;s view
          handle and roto view handle. This allows HeaderEtc to access all the
          information in the detail view handle, including the header&rsquo;s
          view handle.</li>

          <li>
            To implement these changes, perform the following replacements in
            your <i>zzzz</i>1.C files. Replace the function header:
<pre>
extern ERRNUM FAR PASCAL HeaderEtc (
   LPVIEWDEF header,
   LONG field,
   int op, // VIEW_OP_INSERT, VIEW_OP_UPDATE, VIEW_OP_DELETE
   LPSTR old,
   LPSTR new)
</pre>

            <p>with the following:</p>
<pre>
extern ERRNUM FAR PASCAL HeaderEtc (
   LPV lpv,
   LONG field,
   int op, // VIEW_OP_INSERT, VIEW_OP_UPDATE, VIEW_OP_DELETE
   LONG source,
   LPSTR old,
   LPSTR new)
</pre>

            <p>Additionally, all occurrences of:</p>
<pre>
header-&gt;
</pre>

            <p>must be replaced by:</p>
<pre>
lpv-&gt;cmp[0].
</pre>
          </li>
        </ol>
      </li>
    </ol>
    <!-- ================================================================== -->

    <h2 class="overhead"><a id="94-FEB-25" name="94-FEB-25">Since
    94-FEB-25</a></h2>

    <ol>
      <li>Support allowing masks to be placed in the language resource file has
      been added. In the PRESENTATIONINFO structure declared for a mask use the
      construct MAKERSC(id) in place of the literal string. This allows masks
      to be centrally defined and controlled, and also allows a subclass view
      to transparently modify a base view&rsquo;s mask(s).</li>

      <li>Fields which have masks are now automatically checked using the new
      mskFormat and mskVerify API routines. The checking consists of calling
      mskFormat to normalize the content, rejecting it if invalid characters
      are encountered, otherwise storing the normalized contents in the view
      handle.</li>

      <li>Composing to views of 0 keys is now fully supported. Previously an
      error was reported, forcing the programmer to alter the view to have a
      dummy key.</li>

      <li>Added ability to specify non-0 key numbers for composite views. For
      implicitly opened views this key is now used to set the composed view
      order. For explicitly composed views it is assumed that the caller has
      set the composed view order prior to explicitly composing it. To use this
      feature fill in the new KEYMAP.foreign member in the hierarchyKeyMap
      array of structures. Existing views will function unchanged.</li>

      <li>A new conditional feature has been added allowing the programmer to
      specify custom presents information. It is activated by
      DO_FINDPRESENTSINFO, and defines the function FindPresentsInfo in
      <i>zzzz</i>1.C.</li>

      <li>All private helper functions in the <i>zzzz</i>.C file have been made
      available to the <i>zzzz</i>1.C file. Their prototypes are now in
      <i>zzzz</i>2.H.</li>

      <li>Manual compositions have been added. They are specified by defining
      MAN_CMP_COUNT in <i>zzzz</i>1.H to be the number of such composites. They
      are called &ldquo;manual&rdquo; because it is the programmer&rsquo;s
      responsibility entirely to maintain them. That is, they are not
      automatically opened, nor are fields automatically propagated into them.
      The only automatic service supplied is closing them when the view closes.
      They are not included in the CMP_COUNT constant, they are defined after
      implicit views in the cmpNameList array, and they are not listed in the
      hierarchyKeyMap array. They may be opened using the newly available
      OpenOneView.</li>

      <li>Stub view support has been added. When STUB_VIEW is defined the
      standard file<i>XXXX</i> functions in the <i>zzzz</i>.C file are switched
      off. In their place an equivalent empty set of file<i>XXXX</i> functions
      are activated in the <i>zzzz</i>1.C file. By merely adding -DSTUB_VIEW to
      the compiler command line and filling in the file<i>XXXX</i> functions it
      is possible to implement a stub for a specific view.</li>
    </ol>
    <!-- ================================================================== -->
  </body>
</html>


